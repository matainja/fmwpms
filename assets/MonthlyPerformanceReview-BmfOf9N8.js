import{j as e,r as l,a as G,aX as L,a0 as R,u as B,p as K}from"./index-wWf852Ik.js";import"./FormContainer-D1g8rKO9.js";import{C as M,b as V}from"./Tag-CEdhY7rh.js";import{B as y,I}from"./hoist-non-react-statics.cjs-DtiQhq0b.js";import{e as U}from"./Upload-DCiQBwz_.js";import{S as H}from"./Select-D8BtPrxW.js";import{t as w,N as S}from"./toast-C_uKvaxB.js";import{af as W,R as q,ag as J,J as X}from"./Views-Bx7dTT1E.js";import{S as Q,h as Z}from"./html2canvas.esm-Bv1hEIXM.js";import"./index-hq6mG_IV.js";const ee=({department:t})=>{const a=(s,r)=>{const n=s.split(" ");return n.slice(0,r).join(" ")+(n.length>r?"...":"")};return e.jsxs("div",{className:"lg:flex items-center justify-between mb-4 gap-3",children:[e.jsxs("div",{className:"mb-4 lg:mb-0 w-3/4",children:[e.jsx("h3",{children:"Monthly Performance Review"}),e.jsx("p",{children:"This form is used to keep track of appraiseesâ€™ monthly performance and is meant to support them in achieving their agreed targets by helping to identify areas where improvements may be required during the appraisal year."})]}),e.jsxs("div",{children:[e.jsx("h5",{children:t.department_name}),e.jsx("p",{children:a(t.department_description,5)})]})]})},te=()=>{const t=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],[a,s]=l.useState(null),r=G();l.useEffect(()=>{const d=new Date().getMonth()+1,c=t.find(N=>N.value===d)||null,g=(c==null?void 0:c.value)||null;s(g),r(L(d))},[]);const n=d=>{const c=(d==null?void 0:d.value)??null;s(c),c!==null&&r(L(c))};return e.jsx(e.Fragment,{children:e.jsx(M,{bordered:!0,className:"mb-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-6",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("h6",{className:"text-xl font-semibold text-gray-800",children:"Appraisal Period Covered"})}),e.jsx("div",{className:"lg:w-1/3",children:e.jsx(H,{size:"sm",placeholder:"Please Select",options:t,value:t.find(d=>d.value===a),className:"w-full border border-gray-300 rounded-lg shadow-sm",onChange:n})})]})})})},ae=({supervisor:t})=>{const a=[{key:"Surname:",value:t.L_Name||"N/A"},{key:"Firstname:",value:t.F_Name||"N/A"},{key:"Othername:",value:t.M_Name||"N/A"},{key:"IPPIS No:",value:t.ippis_no||"N/A"},{key:"Phone No:",value:t.phone||"N/A"},{key:"Designation:",value:t.role||"N/A"},{key:"email",value:t.email||"N/A"}];return e.jsxs(M,{bordered:!0,className:"mb-4",children:[e.jsx("div",{className:"mb-4 flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{children:"Supervisor Information"})})})})}),e.jsx("div",{className:"columns-3xs",children:a.map((s,r)=>e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-full text-black font-bold mb-2",children:s.key}),e.jsx("div",{className:"text-left w-full",children:s.value?s.value:"N/A"})]},r))})]})},se=({staff:t})=>{const a=[{key:"Surname:",value:t.L_Name||"N/A"},{key:"Firstname:",value:t.F_Name||"N/A"},{key:"Othername:",value:t.M_Name||"N/A"},{key:"IPPIS No:",value:t.ippis_no||"N/A"},{key:"Phone No:",value:t.phone||"N/A"},{key:"Designation:",value:t.role||"N/A"},{key:"email",value:t.email||"N/A"}];return e.jsxs(M,{bordered:!0,className:"mb-4",children:[e.jsx("div",{className:"mb-4 flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{children:"Employee Information"})})})})}),e.jsx("div",{className:"columns-3xs",children:a.map((s,r)=>e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-full text-black font-bold mb-2",children:s.key}),e.jsx("div",{className:"text-left w-full",children:s.value?s.value:"N/A"})]},r))})]})},re=()=>{const t=[{key:"Surname:",value:"test"},{key:"Firstname:",value:"Officer"},{key:"Othername:",value:""},{key:"IPPIS No:",value:"00001"},{key:"Designation:",value:"officer"}];return e.jsxs(M,{bordered:!0,className:"mb-4",children:[e.jsx("div",{className:"mb-4 flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{children:"Counter-Signing Officer's Information "})})})})}),e.jsx("div",{className:"md:grid grid-rows-2 grid-flow-col",children:t.map((a,s)=>e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-full text-black font-bold mb-2",children:a.key}),e.jsx("div",{className:"text-left w-full",children:a.value?a.value:"N/A"})]},s))})]})},le=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 3 : CURRENT RESPONSIBILITIES"})})})}),ne=async(t,a,s,r)=>{try{return await R({url:`/monthly_peroformance_review?department_id=${t}&team_id=${a}&year=${s}&month=${r}`,method:"get"})}catch(n){throw console.error("Error fetching information data:",n),n}},ie=async t=>{try{return await R({url:"extra_mpr",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})}catch(a){throw console.error("Error fetching information data:",a),a}},ce=async t=>{try{return await R({url:"monthly_peroformance_review",method:"post",data:t})}catch(a){throw console.error("Error fetching information data:",a),a}},oe=async(t,a,s)=>{try{return await R({url:`/form_mpr_comments?department_id=${t}&team_id=${a}&year=${s}`,method:"get"})}catch(r){throw console.error("Error fetching information data:",r),r}},de=async t=>{try{return await R({url:"/form_mpr_comments",method:"post",data:t})}catch(a){throw console.error("Error fetching information data:",a),a}},{Tr:Y,Th:O,Td:D,THead:me,TBody:ue}=V,xe=t=>t?new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t):"-",z=t=>{if(t==="-"||!t)return null;const[a,s,r]=t.split("/");if(!a||!s||!r)return null;const n=new Date(parseInt(r,10),parseInt(s,10)-1,parseInt(a,10));return isNaN(n.getTime())?null:n},he=({kpi:t,existing_data:a})=>{const s=B(m=>m.mprf.selectedMonth),r=l.useMemo(()=>t.kra||{},[t]),n=l.useMemo(()=>t.target||{},[t]),[d,c]=l.useState([]);l.useEffect(()=>{if(a.length>0)c(a);else{const m=Object.keys(r).map(o=>({kra_id:parseInt(o,10),kpi:r[o]||"No KPI",performance_expectation:n[o]??"-",start_date:"-",end_date:"-",output_status:"N/A",issues:"N/A"}));c(m)}},[a,r,n]);const g=(m,o,p)=>{c(f=>f.map(j=>j.kra_id===m?{...j,[o]:p?xe(p):"-"}:j))},N=async()=>{const m={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),month:s,current_resposibilities:d.map(o=>({kra_id:o.kra_id,start_date:o.start_date,end_date:o.end_date,output_status:o.output_status==="N/A"?null:o.output_status,issues:o.issues==="N/A"?null:o.issues}))};try{(await ce(m)).status===200&&w.push(e.jsx(S,{title:"Success",type:"success",children:"Data added successfully!"}),{placement:"top-center"})}catch{w.push(e.jsx(S,{title:"Error",type:"danger",children:"Something went wrong. Please try again."}),{placement:"top-center"})}console.log("Saved Data:",m)};return e.jsxs("div",{className:"mt-2",children:[e.jsxs(V,{compact:!0,className:"border border-gray-300",children:[e.jsx(me,{className:"bg-gray-100",children:e.jsxs(Y,{children:[e.jsx(O,{className:"border border-gray-300",children:"KPI"}),e.jsx(O,{className:"border border-gray-300",children:"Performance Expectations"}),e.jsx(O,{className:"border border-gray-300",children:"Start Date"}),e.jsx(O,{className:"border border-gray-300",children:"Due Date"}),e.jsx(O,{className:"border border-gray-300",children:"Output Status"}),e.jsx(O,{className:"border border-gray-300",children:"Remarks"})]})}),e.jsx(ue,{children:d.length===0?e.jsx(Y,{children:e.jsx(D,{colSpan:6,className:"text-center",children:"No data found !!"})}):d.map(m=>e.jsxs(Y,{children:[e.jsx(D,{className:"border border-gray-300",children:m.kpi}),e.jsx(D,{className:"border border-gray-300 text-center",children:m.performance_expectation}),e.jsx(D,{className:"border border-gray-300",children:e.jsx(U,{placeholder:"dd.mm.yy",value:z(m.start_date),onChange:o=>g(m.kra_id,"start_date",o)})}),e.jsx(D,{className:"border border-gray-300",children:e.jsx(U,{placeholder:"dd.mm.yy",value:z(m.end_date),onChange:o=>g(m.kra_id,"end_date",o)})}),e.jsx(D,{className:"border border-gray-300",children:m.output_status||"-"}),e.jsx(D,{className:"border border-gray-300",children:m.issues||"-"})]},m.kra_id))})]}),e.jsx("div",{className:"text-right mt-4",children:e.jsx(y,{variant:"solid",color:"green-700",onClick:N,children:"Save"})})]})},ge=({outstanding_performance:t})=>e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4: OUTSTANDING PERFORMANCE IDENTIFIED WITHIN THE REVIEW PERIOD"})})}),e.jsx(I,{disabled:!0,textArea:!0,readOnly:!0,value:t,className:"input-textarea mt-2"})]}),fe=({areas_of_improvement:t})=>e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : AREAS OF IMPROVEMENTS REQUIRED"})})}),e.jsx(I,{disabled:!0,textArea:!0,readOnly:!0,value:t,className:"input-textarea mt-2"})]}),pe=({training_needs:t,onChange:a})=>{const[s,r]=l.useState(t),n=d=>{const c=d.target.value;r(c),a(c)};return e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 6: TRAINING NEEDS"})}),e.jsx(I,{textArea:!0,value:s,placeholder:"Enter Training Need",className:"input-textarea mt-2",onChange:n})]})},je=({future_goals:t})=>e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 7 : FUTURE GOALS AND SET EXPECTATIONS"})})}),e.jsx(I,{disabled:!0,textArea:!0,readOnly:!0,value:t,className:"input-textarea mt-2"})]}),Ne=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 6 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),ve=({comments:t,onAppraiseeCommentChange:a,showValidationError:s})=>{const[r,n]=l.useState("");l.useEffect(()=>{const c=t.staff.comment||"";n(c),a(c)},[t.staff.comment]);const d=c=>{const g=c.target.value;n(g),a(g)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(I,{textArea:!0,placeholder:"Enter your comments here",className:`input-textarea mt-2 ${s&&!r?"border-red-500":""}`,value:r,onChange:d,required:!0}),s&&!r&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(W,{className:"mr-1"}),"This field is required."]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(I,{disabled:!0,textArea:!0,value:t.supervisor.comment||"",className:"input-textarea mt-2"})]})]})},$=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],be=({Staff:t,onChange:a})=>{const[s,r]=l.useState(null),[n,d]=l.useState(null),[c,g]=l.useState(null),[N,m]=l.useState(null),[o,p]=l.useState(!1),[f,j]=l.useState(0),k=l.useRef(null),v=l.useRef(null),b=l.useRef(null);l.useEffect(()=>{t&&(r(t.declaration),g(t.signature),d(t.date?new Date(t.date):null),j((t.signature,0)))},[t]);const A=i=>{var x;const u=(x=i.target.files)==null?void 0:x[0];if(u){if(u.size>70*1024){alert("File size exceeds 70Kb . Please upload a smaller file.");return}if(!u.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const h=new FileReader;h.onloadend=()=>{const P=h.result;g(P),m(u.name),j(1)},h.readAsDataURL(u)}},E=()=>{p(!0)},C=async()=>{if(v.current&&!v.current.isEmpty()){if(b.current){const u=(await Z(b.current)).toDataURL("image/png");g(u),j(1),p(!1)}}else alert("Please draw a signature before saving.")},T=()=>{var i;(i=v.current)==null||i.clear()};return l.useEffect(()=>{const i=n!==null?new Date(n.getFullYear(),n.getMonth(),n.getDate()+1):null,u={declaration:s,date:i,flag:f};f===1&&(u.signature=c),a(u)},[s,n,c,f]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Declaration:"}),e.jsx(H,{placeholder:"Please Select",options:$,className:"mt-2",value:$.find(i=>i.value===s),onChange:i=>r((i==null?void 0:i.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(U,{className:"mt-2",value:n,onChange:i=>d(i)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(y,{variant:"solid",size:"xs",icon:e.jsx(q,{}),className:"cursor-pointer",onClick:E,children:"Add Signature"}),e.jsx(y,{variant:"solid",size:"xs",icon:e.jsx(J,{}),className:"cursor-pointer ",onClick:()=>{var i;return(i=k.current)==null?void 0:i.click()},children:"Upload"}),e.jsx("input",{ref:k,type:"file",accept:"image/*",className:"hidden",onChange:A})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),c&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:c,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>p(!1),children:e.jsx(X,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:b,className:" rounded-md mt-4 bg-white",children:e.jsx(Q,{ref:v,canvasProps:{width:330,height:150,className:"sigCanvas"}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(y,{size:"sm",variant:"default",onClick:T,children:"Clear"}),e.jsx(y,{size:"sm",variant:"solid",onClick:C,children:"Save"})]})]})})]})},ye=({Supervisor:t})=>{const a=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],s=a.find(r=>r.value===(t==null?void 0:t.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(H,{isDisabled:!0,id:"declaration",value:s,options:a,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(I,{disabled:!0,id:"date",value:(t==null?void 0:t.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraiser's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraiser"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:t!=null&&t.signature?e.jsx("img",{src:t.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},we=()=>{var b,A,E,C,T;const t=K(),[a,s]=l.useState(),[r,n]=l.useState(!0),[d,c]=l.useState(null),[g,N]=l.useState(""),[m,o]=l.useState(!1),p=async()=>{try{const i=localStorage.getItem("selectedDepartmentID")||"",u=localStorage.getItem("selectedTeamID"),x=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),h=await oe(i,u?Number(u):null,x);if(h&&h.data)s(h.data);else throw new Error("Invalid response data")}catch(i){console.error("Error fetching data:",i),c("Failed to load data. Please try again.")}finally{n(!1)}};l.useEffect(()=>{p()},[]);const[f,j]=l.useState({declaration:null,date:null,signature:null,flag:0}),k=async()=>{var i,u;if(!g.trim()){o(!0),w.push(e.jsx(S,{title:"Error",type:"danger",children:"Appraisee 's Comments is reuired"}),{placement:"top-center"});return}o(!1);try{const x=f.date instanceof Date?f.date.toISOString().split("T")[0]:null,h={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),comment:g,date:x,signature:f.signature,declaration:f.declaration,flag:f.flag};(await de(h)).status===200?w.push(e.jsx(S,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):w.push(e.jsx(S,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(x){const h=((u=(i=x.response)==null?void 0:i.data)==null?void 0:u.error)||x.message||"An unexpected error occurred.";w.push(e.jsx(S,{title:"Error",type:"danger",children:h}),{placement:"top-center"}),console.error("Error submitting data:",x)}},v=()=>{t(-1)};return r?e.jsx("div",{children:"Loading..."}):d?e.jsx("div",{className:"text-red-500",children:d}):e.jsxs("div",{className:"mt-4  mx-auto w-full ",children:[e.jsx(Ne,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(ve,{comments:{staff:((b=a==null?void 0:a.comments)==null?void 0:b.staff)||{comment:""},supervisor:((A=a==null?void 0:a.comments)==null?void 0:A.supervisor)||{comment:""},officer:((E=a==null?void 0:a.comments)==null?void 0:E.officer)||{comment:""}},showValidationError:m,onAppraiseeCommentChange:N})}),e.jsx("div",{className:"mt-4",children:e.jsx(be,{Staff:(C=a==null?void 0:a.comments)==null?void 0:C.staff,onChange:i=>{j(i)}})}),e.jsx("div",{className:"mt-4",children:e.jsx(ye,{Supervisor:(T=a==null?void 0:a.comments)==null?void 0:T.supervisor})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4 mt-10",children:[e.jsx(y,{variant:"solid",className:"w-full sm:w-auto",onClick:v,children:"Back"}),e.jsx(y,{variant:"solid",className:"w-full sm:w-auto",onClick:k,children:"Save"})]})]})},Fe=()=>{const t=B(x=>x.mprf.selectedMonth),[a,s]=l.useState(null),[r,n]=l.useState(null),[d,c]=l.useState([]),[g,N]=l.useState({outstanding_performance:"",areas_of_improvement:"",training_needs:"",future_goals:""}),[m,o]=l.useState(!0),[p,f]=l.useState(null),j=async()=>{try{const x=localStorage.getItem("selectedDepartmentID")||"",h=localStorage.getItem("selectedTeamID"),P=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),F=await ne(x,h?Number(h):null,P,t);if(F!=null&&F.data){const _=F.data;s(_.initial_data),n(_.kpis),c(_.existing_data),typeof _.extra_details=="string"?N({outstanding_performance:"",areas_of_improvement:"",training_needs:"",future_goals:""}):N(_.extra_details)}else throw new Error("Invalid response")}catch(x){console.error("Error fetching data:",x),f("Failed to load data. Please try again.")}finally{o(!1)}};l.useEffect(()=>{j()},[t]);const k=x=>{N(h=>({...h,training_needs:x}))},v=async()=>{const x=localStorage.getItem("selectedDepartmentID")||"",h=localStorage.getItem("selectedTeamID"),P=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),F={department_id:x,team_id:h?Number(h):null,year:P,month:t,...g};try{(await ie(F)).status===200&&w.push(e.jsx(S,{title:"Success",type:"success",children:"Data added successfully!"}),{placement:"top-center"})}catch{w.push(e.jsx(S,{title:"Error",type:"danger",children:"Something went wrong. Please try again."}),{placement:"top-center"})}};if(m)return e.jsx("div",{children:"Loading..."});if(p)return e.jsx("div",{className:"text-red-500",children:p});if(!a)return null;const{department:b,supervisor:A,staff:E}=a,{outstanding_performance:C,areas_of_improvement:T,training_needs:i,future_goals:u}=g;return e.jsxs("div",{children:[e.jsx(ee,{department:b}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-4",children:[e.jsx(te,{}),e.jsx(ae,{supervisor:A})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-4",children:[e.jsx(se,{staff:E}),e.jsx(re,{})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(le,{}),e.jsx(he,{kpi:r,existing_data:d})]}),e.jsx(ge,{outstanding_performance:C||""}),e.jsx(fe,{areas_of_improvement:T||""}),e.jsx(pe,{training_needs:i||"",onChange:k}),e.jsx(je,{future_goals:u||""}),e.jsx("div",{className:"text-right mt-4",children:(u==null?void 0:u.trim())&&e.jsx(y,{variant:"solid",color:"green-700",onClick:v,children:"Save"})}),e.jsx(we,{})]})};export{Fe as default};

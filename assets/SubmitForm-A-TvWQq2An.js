import{aQ as ne,aM as ce,j as e,aR as de,r as i,u as H,a2 as se,a0 as z,$ as ae,p as ie}from"./index-XEIncrLJ.js";import{T as te,b as W,e as oe}from"./Upload-Dovppv8_.js";import{C as me,b as j}from"./Tag-MScPo-d6.js";/* empty css               */import{B as A,I as $}from"./hoist-non-react-statics.cjs-vrUR2keZ.js";import{ae as Y,af as xe,R as ge,ag as ue,J as he}from"./Views-DInV39d3.js";import"./FormContainer-BcWWCs1J.js";import{S as U}from"./Select-BAk-N8U6.js";import{t as R,N as P}from"./toast-BA_WAYTR.js";import{S as be,h as pe}from"./html2canvas.esm-Bcn9ISoe.js";import{g as fe}from"./Evidence-BKqYKwwu.js";import{F as je,H as Ne,I as ye}from"./FooterButtonpart-BZjvO-eC.js";import"./index-NXSOsk8k.js";import"./index-vJ2wM1ft.js";const{TabNav:q,TabList:we}=te,ve=()=>{const r=ne(),t=ce(c=>c.quaterTab.selectedQuarter),a=c=>{r(de(c))};return e.jsx("div",{children:e.jsx(me,{className:"bg-gray-50 card-body-padding mt-8",children:e.jsx(te,{value:t,variant:"pill",onChange:a,children:e.jsxs(we,{children:[e.jsx(q,{value:"1",className:`${t==="1"?"bg-green-700 text-white":""}`,children:"First Quarter"}),e.jsx(q,{value:"2",className:`${t==="2"?"bg-green-700 text-white":""}`,children:"Second Quarter"}),e.jsx(q,{value:"3",className:`${t==="3"?"bg-green-700 text-white":""}`,children:"Third Quarter"}),e.jsx(q,{value:"4",className:`${t==="4"?"bg-green-700 text-white":""}`,children:"Fourth Quarter"})]})})})})},{Tr:Q,Th:Se,Td:u,THead:Te,TBody:De}=j,Ee=({employee_task:r})=>{const[t,a]=i.useState([]),[c,o]=i.useState({weightSum:0,gradeWeightSum:0,quarterMarksSum:0}),d=H(s=>s.quaterTab.selectedQuarter);return i.useEffect(()=>{const s=(r[d]||[]).map(n=>({selectedKRA:n.kra_name,weight:n.kra_weight,rows:n.objectives.map(l=>({selectedObjective:l.objective_name,gradeWeight:l.gradeed_weight,selectedKPI:l.kpi,unitOfMeasurement:l.unit,targetSet:l.target,targetAchieved:l.target_achieved,raw:l.raw,weighted:l.weighted,score:l.quater_markes}))}));a(s)},[d,r]),i.useEffect(()=>{const s=(r[d]||[]).reduce((m,h)=>m+(h.kra_weight||0),0),n=(r[d]||[]).reduce((m,h)=>m+h.objectives.reduce((f,b)=>f+(b.gradeed_weight||0),0),0),l=(r[d]||[]).reduce((m,h)=>m+h.objectives.reduce((f,b)=>f+(b.quater_markes||0),0),0);o({weightSum:s,gradeWeightSum:n,quarterMarksSum:l})},[d,r]),e.jsx("div",{className:"mt-2",children:e.jsxs(j,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Te,{children:e.jsx(Q,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Grade Weight","KPIs","Unit of Measurement","Target Set","Target Achieved","Quater Markes","Raw","Weighted"].map((s,n)=>e.jsx(Se,{className:"border border-gray-400 p-2",children:s},n))})}),e.jsxs(De,{children:[t.map((s,n)=>s.rows.map((l,m)=>e.jsxs(Q,{children:[m===0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"border border-gray-400 text-center",rowSpan:s.rows.length,children:n+1}),e.jsx(u,{className:"border border-gray-400",rowSpan:s.rows.length,children:s.selectedKRA}),e.jsx(u,{className:"border border-gray-400 text-center",rowSpan:s.rows.length,children:s.weight})]}),e.jsx(u,{className:"border border-gray-400",children:l.selectedObjective}),e.jsx(u,{className:"border border-gray-400 text-center",children:l.gradeWeight}),e.jsx(u,{className:"border border-gray-400",children:l.selectedKPI}),e.jsx(u,{className:"border border-gray-400 text-center",children:l.unitOfMeasurement}),e.jsx(u,{className:"border border-gray-400 text-center",children:l.targetSet}),e.jsx(u,{className:"border border-gray-400 text-center",children:l.targetAchieved}),e.jsx(u,{className:"border border-gray-400 text-center",children:l.score}),e.jsx(u,{className:"border border-gray-400 text-center",children:l.raw}),e.jsx(u,{className:"border border-gray-400 text-center",children:l.weighted})]},`${n}-${m}`))),e.jsxs(Q,{className:"font-semibold bg-gray-100",children:[e.jsx(u,{className:"border border-gray-400 text-center",colSpan:2,children:"Total"}),e.jsx(u,{className:"border border-gray-400 text-center",children:c.weightSum}),e.jsx(u,{colSpan:1,className:"border border-gray-400 text-center"}),e.jsx(u,{className:"border border-gray-400 text-center",children:c.gradeWeightSum}),e.jsx(u,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(u,{colSpan:3,className:"border border-gray-400 text-center",children:c.quarterMarksSum})]})]})]})})},{Tr:G,Th:K,Td:V,THead:Ce,TBody:Oe}=j,Ie=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],ke=()=>{const[r,t]=i.useState(!1),[a,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const s=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const o=()=>t(!0),d=()=>t(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),"aria-label":"View Scoring Criteria Values",onClick:o,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(W,{title:"Scoring Criteria",isOpen:r,placement:"right",width:a?"100%":800,onClose:d,onRequestClose:d,children:e.jsxs(j,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx(Ce,{children:e.jsxs(G,{className:"bg-gray-100",children:[e.jsx(K,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(K,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(Oe,{children:Ie.map((s,n)=>e.jsxs(G,{children:[e.jsx(V,{className:"border border-gray-300 p-2",children:s.grade}),e.jsx(V,{className:"border border-gray-300 p-2",children:s.description})]},n))})]})})]})},{Tr:J,Th:X,Td:Z,THead:_e,TBody:$e}=j,Ae=({isOpen:r,setIsOpen:t})=>{const[a,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const d=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const o=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."}];return e.jsx(W,{isOpen:r,title:"Performance Rating Scale",width:a?"100%":750,onClose:()=>t(!1),children:e.jsxs(j,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(_e,{children:e.jsxs(J,{className:"bg-gray-100",children:[e.jsx(X,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(X,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx($e,{children:o.map(d=>e.jsxs(J,{children:[e.jsx(Z,{className:"border border-gray-300 p-2",children:d.title}),e.jsx(Z,{className:"border border-gray-300 p-2",children:d.desc})]},d.id))})]})})},Me=()=>{const[r,t]=i.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),onClick:()=>t(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(Ae,{isOpen:r,setIsOpen:t})]})},{Tr:L,Th:C,Td:v,THead:Fe,TBody:Re}=j,Pe=({competencies:r})=>{const t=H(s=>s.quaterTab.selectedQuarter),a=r[t],c=a.reduce((s,n)=>s+n.competencies_details.reduce((l,m)=>l+m.max_score,0),0),o=a.reduce((s,n)=>s+n.competencies_details.reduce((l,m)=>l+m.quarter_marks,0),0),d=c>0?o/c*20:0;return e.jsx("div",{className:"border overflow-hidden shadow-sm",children:e.jsxs(j,{compact:!0,className:"w-full bg-white",children:[e.jsx(Fe,{children:e.jsxs(L,{className:"bg-gray-200",children:[e.jsx(C,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(C,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(C,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(C,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(C,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(C,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(C,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Quater Marks"})]})}),e.jsxs(Re,{className:"divide-y divide-gray-200",children:[a.map(s=>e.jsx(se.Fragment,{children:s.competencies_details.map((n,l)=>e.jsxs(L,{children:[l===0&&e.jsx(v,{className:"px-4 py-3 align-top font-semibold border border-gray-400",rowSpan:s.competencies_details.length,children:s.competencies}),e.jsx(v,{className:"px-4 py-3 border border-gray-400",children:n.cluster}),e.jsx(v,{className:"px-4 py-3 border border-gray-400",children:n.sub_cluster}),e.jsx(v,{className:"px-4 py-3 border border-gray-400",children:n.describe_expectations}),e.jsx(v,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:n.max_score}),e.jsx(v,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:n.min_score}),e.jsx(v,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:n.quarter_marks})]},l))},s.id)),e.jsxs(L,{className:"font-semibold bg-gray-100",children:[e.jsx(v,{className:"border border-gray-400 text-center",colSpan:4}),e.jsx(v,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(v,{colSpan:2,className:"border border-gray-400 text-center",children:d.toFixed(2)})]})]})]})})},{Tr:k,Th:ee,Td:T,THead:qe,TBody:He}=j,Qe=()=>{const[r,t]=i.useState(!1),[a,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const s=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const o=()=>{t(!0)},d=s=>{console.log("onDrawerClose",s),t(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),onClick:()=>o(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(W,{title:"Performance Rating Scale  ",isOpen:r,width:a?"100%":750,onClose:d,onRequestClose:d,children:e.jsxs(j,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(qe,{children:e.jsxs(k,{className:"bg-gray-100",children:[e.jsx(ee,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(ee,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs(He,{children:[e.jsxs(k,{children:[e.jsx(T,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(T,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(k,{children:[e.jsx(T,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(T,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(k,{children:[e.jsx(T,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(T,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(k,{children:[e.jsx(T,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(T,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:B,Th:_,Td:D,THead:Le,TBody:Be}=j,ze=({operation_and_process:r})=>{const t=H(s=>s.quaterTab.selectedQuarter),a=r[t]||[],c=a.reduce((s,n)=>s+n.details.reduce((l,m)=>l+m.max_score,0),0),o=a.reduce((s,n)=>s+n.details.reduce((l,m)=>l+m.quarter_marks,0),0),d=c>0?o/c*10:0;return e.jsxs(j,{compact:!0,className:"table-auto border-collapse border border-gray-400 w-full bg-white",children:[e.jsx(Le,{children:e.jsxs(B,{className:"bg-gray-200",children:[e.jsx(_,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx(_,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx(_,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx(_,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx(_,{className:"border border-gray-400 p-2 text-center",children:"Quarter Marks"})]})}),e.jsxs(Be,{children:[a.map((s,n)=>e.jsx(se.Fragment,{children:s.details.map((l,m)=>e.jsxs(B,{children:[m===0&&e.jsx(D,{className:"border border-gray-400 p-2 font-bold",rowSpan:s.details.length,children:s.operations_and_process}),e.jsx(D,{className:"border border-gray-400 p-2",children:l.describe_expectations}),e.jsx(D,{className:"border border-gray-400 p-2 text-center",children:l.min_score}),e.jsx(D,{className:"border border-gray-400 p-2 text-center",children:l.max_score}),e.jsx(D,{className:"border border-gray-400 p-2 text-center",children:l.quarter_marks})]},m))},n)),e.jsxs(B,{className:"font-semibold bg-gray-100",children:[e.jsx(D,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(D,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(D,{colSpan:2,className:"border border-gray-400 text-center",children:d.toFixed(2)})]})]})]})},We=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 7 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),Ye=({comments:r,onOfficerCommentChange:t,showValidationError:a,commentInputRef:c})=>{var n,l;const[o,d]=i.useState("");i.useEffect(()=>{var h;const m=((h=r.officer)==null?void 0:h.comment)||"";d(m),t(m)},[(n=r.officer)==null?void 0:n.comment,t]);const s=m=>{const h=m.target.value;d(h),t(h)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx($,{disabled:!0,textArea:!0,value:((l=r.supervisor)==null?void 0:l.comment)||"",className:"input-textarea mt-2"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx($,{disabled:!0,textArea:!0,value:r.supervisor.comment||"",className:"input-textarea mt-2"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx($,{required:!0,ref:c,textArea:!0,value:o,placeholder:"Enter your comments here",className:`textarea mt-2 w-full rounded-md border px-3 py-2 focus:outline-none ${a&&!o?"border-red-500":"border-gray-300"}`,onChange:s}),a&&!o&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(xe,{className:"mr-1"}),"This field is required."]})]})]})},Ue=({Supervisor:r})=>{const t=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],a=t.find(c=>c.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraisee's Declaration :"}),e.jsx(U,{isDisabled:!0,id:"declaration",value:a,options:t,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx($,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraisee's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},Ge=({staff:r})=>{const t=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],a=t.find(c=>c.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(U,{isDisabled:!0,id:"declaration",value:a,options:t,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx($,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraiser's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraiser"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},re=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],Ke=({officer:r,onChange:t})=>{const[a,c]=i.useState(null),[o,d]=i.useState(null),[s,n]=i.useState(null),[l,m]=i.useState(null),[h,f]=i.useState(!1),[b,S]=i.useState(0),O=i.useRef(null),N=i.useRef(null),E=i.useRef(null);i.useEffect(()=>{r&&(c(r.declaration),n(r.signature),d(r.date?new Date(r.date):null),S((r.signature,0)))},[r]);const I=x=>{var w;const g=(w=x.target.files)==null?void 0:w[0];if(g){if(g.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!g.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const F=new FileReader;F.onloadend=()=>{const le=F.result;n(le),m(g.name),S(1)},F.readAsDataURL(g)}},M=()=>{f(!0)},p=async()=>{if(N.current&&!N.current.isEmpty()){if(E.current){const g=(await pe(E.current)).toDataURL("image/png");n(g),S(1),f(!1)}}else alert("Please draw a signature before saving.")},y=()=>{var x;(x=N.current)==null||x.clear()};return i.useEffect(()=>{const x=o!==null?new Date(o.getFullYear(),o.getMonth(),o.getDate()+1):null,g={declaration:a,date:x,flag:b};b===1&&(g.signature=s),t(g)},[a,o,s,b]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Declaration:"}),e.jsx(U,{placeholder:"Please Select",options:re,className:"mt-2",value:re.find(x=>x.value===a),onChange:x=>c((x==null?void 0:x.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(oe,{className:"mt-2",value:o,onChange:x=>d(x)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1",children:"Countersigning Officer's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:M,children:[e.jsx(ge,{className:"w-5 h-5"}),"Add Signature"]}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:()=>{var x;return(x=O.current)==null?void 0:x.click()},children:[e.jsx(ue,{className:"w-5 h-5"}),"Upload"]}),e.jsx("input",{ref:O,type:"file",accept:"image/*",className:"hidden",onChange:I})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),s&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:s,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>f(!1),children:e.jsx(he,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:E,className:" rounded-md mt-4 bg-white",children:e.jsx(be,{ref:N,canvasProps:{width:330,height:150,className:"sigCanvas"}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(A,{size:"sm",variant:"default",onClick:y,children:"Clear"}),e.jsx(A,{size:"sm",variant:"solid",onClick:p,children:"Save"})]})]})})]})},Ve=({submittedEvidence:r})=>{if(!r||r.length===0)return e.jsx("p",{className:"text-gray-500",children:"No submitted evidence available."});const t=async a=>{try{const o=(await fe(a)).data,d=URL.createObjectURL(o);window.open(d,"_blank")}catch(c){console.error("Error fetching evidence data:",c)}};return e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Submitted Evidence:"}),e.jsx("div",{className:"flex flex-col gap-4",children:r.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"text-blue-600 underline max-w-[250px] truncate cursor-pointer",onClick:()=>t(a.evidence_id),children:a.evidence_id}),e.jsx("div",{className:"flex-1 text-right",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:[e.jsx("strong",{children:"Created:"})," ",new Date(a.created_at).toLocaleDateString()]})})]},a.id))})]})},Je=async(r,t,a,c,o)=>{try{return await z({url:`officer/form_a?department_id=${r}&team_id=${t}&year=${a}&staff_id=${o}&quater=${c}`,method:"get"})}catch(d){throw console.error("Error fetching information data:",d),d}},Xe=async(r,t,a,c)=>{try{return await z({url:`officer/form_a_comments?department_id=${r}&team_id=${t}&year=${a}&staff_id=${c}`,method:"get"})}catch(o){throw console.error("Error fetching information data:",o),o}},Ze=async r=>{try{return await z({url:"/officer/form_a_comments",method:"post",data:r})}catch(t){throw console.error("Error fetching information data:",t),t}},er=()=>{const{id:r}=ae(),t=ie(),[a,c]=i.useState(null),[o,d]=i.useState(!0),[s,n]=i.useState(null),[l,m]=i.useState(""),[h,f]=i.useState(!1),[b,S]=i.useState({declaration:null,date:null,signature:null,flag:0}),O=async()=>{try{const p=localStorage.getItem("selectedDepartmentID")||"",y=localStorage.getItem("selectedTeamID"),x=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),g=await Xe(p,y?Number(y):null,x,String(r));if(g&&g.data)c(g.data);else throw new Error("Invalid response data")}catch(p){console.error("Error fetching data:",p),n("Failed to load data. Please try again.")}finally{d(!1)}};i.useEffect(()=>{O()},[]);const N=i.useRef(null),E=async()=>{var p,y,x;if(!l.trim()){f(!0),(p=N.current)==null||p.scrollIntoView({behavior:"smooth",block:"center"}),R.push(e.jsx(P,{title:"Error",type:"danger",children:"Appraisee's Comments is required"}),{placement:"top-center"});return}f(!1);try{const g=b.date instanceof Date?b.date.toISOString().split("T")[0]:null,w={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),staff_id:r,comment:l,date:g,signature:b.signature,declaration:b.declaration,flag:b.flag};(await Ze(w)).status===200?R.push(e.jsx(P,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):R.push(e.jsx(P,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(g){const w=((x=(y=g.response)==null?void 0:y.data)==null?void 0:x.error)||g.message||"An unexpected error occurred.";R.push(e.jsx(P,{title:"Error",type:"danger",children:w}),{placement:"top-center"}),console.error("Error submitting data:",g)}},I=()=>{t(-1)},M=()=>{t(`/form/officer/review/${r}`)};return o?e.jsx("div",{children:"Loading..."}):s?e.jsx("div",{className:"text-red-500",children:s}):a?e.jsxs("div",{className:"mt-4 mx-auto w-full",children:[e.jsx(We,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(Ve,{submittedEvidence:a.comments.staff.evidence||[]})}),e.jsx("div",{className:"mt-4",children:e.jsx(Ye,{commentInputRef:N,comments:{staff:a.comments.staff||{comment:""},supervisor:a.comments.supervisor||{comment:""},officer:a.comments.officer||{comment:""}},showValidationError:h,onOfficerCommentChange:m})}),e.jsx("div",{className:"mt-4",children:e.jsx(Ue,{Supervisor:a.comments.supervisor})}),e.jsx("div",{className:"mt-4",children:e.jsx(Ge,{staff:a.comments.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(Ke,{officer:a.comments.officer,onChange:p=>S(p)})})]}),e.jsx(je,{back:"Back",handleBack:I,save:"Save",handleSave:E,next:"Next",handleNext:M})]}):e.jsx("div",{children:"No data available."})},hr=()=>{const{id:r}=ae(),t=H(p=>p.quaterTab.selectedQuarter),[a,c]=i.useState(null),[o,d]=i.useState(!0),[s,n]=i.useState(null),l=async()=>{try{const p=localStorage.getItem("selectedDepartmentID")||"",y=localStorage.getItem("selectedTeamID"),x=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),g=r,w=await Je(p,y?Number(y):null,x,t,String(g));if(w&&w.data)c(w.data);else throw new Error("Invalid response data")}catch(p){console.error("Error fetching data:",p),n("Failed to load data. Please try again.")}finally{d(!1)}};if(i.useEffect(()=>{l()},[]),o)return e.jsx("div",{children:"Loading..."});if(s)return e.jsx("div",{className:"text-red-500",children:s});const{department:m,team:h,supervisor:f,officer:b,staff:S,progress:O,employee_task:N,competencies:E,operation_and_process:I,others:M}=a||{};return e.jsxs("div",{children:[e.jsx(Ne,{department:m,team:h,progress:O,title:"EMPLOYEE PERFORMANCE CONTRACT",downloadButton:!1,staffID:r}),S&&f&&b&&e.jsx(ye,{staff:S,supervisor:f,officer:b}),e.jsx(ve,{}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ke,{}),N&&e.jsx(Ee,{employee_task:N})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Me,{}),e.jsx(Pe,{competencies:E})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Qe,{}),e.jsx(ze,{operation_and_process:I})]}),e.jsx(er,{})]})};export{hr as default};

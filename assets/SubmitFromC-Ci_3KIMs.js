import{r as o,j as e,a2 as ue,a0 as J,$ as ge,p as he,u as pe}from"./index-wWf852Ik.js";import{F as be,H as je,I as fe}from"./FooterButtonpart-L1ZXnaOI.js";import{B as I,I as O}from"./hoist-non-react-statics.cjs-DtiQhq0b.js";import{b as Y,e as ye}from"./Upload-DCiQBwz_.js";import{ae as U,af as Ne,R as ve,ag as we,J as Se}from"./Views-Bx7dTT1E.js";import{b as u,E as Te,q as Ee,x as De}from"./Tag-CEdhY7rh.js";import"./FormContainer-D1g8rKO9.js";import{S as q}from"./Select-D8BtPrxW.js";import{t as L,N as z}from"./toast-C_uKvaxB.js";import{S as Ce,h as Ie}from"./html2canvas.esm-Bv1hEIXM.js";import{g as ke}from"./Evidence-CjlXIat9.js";import"./index-ZwnG87dO.js";import"./index-hq6mG_IV.js";const{Tr:se,Th:ae,Td:te,THead:_e,TBody:Oe}=u,$e=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],Ae=()=>{const[r,a]=o.useState(!1),[s,c]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const t=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const n=()=>a(!0),l=()=>a(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(I,{variant:"twoTone",size:"xs",icon:e.jsx(U,{}),"aria-label":"View Scoring Criteria Values",onClick:n,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(Y,{title:"Scoring Criteria",isOpen:r,placement:"right",width:s?"100%":800,onClose:l,onRequestClose:l,children:e.jsxs(u,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx(_e,{children:e.jsxs(se,{className:"bg-gray-100",children:[e.jsx(ae,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(ae,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(Oe,{children:$e.map((t,d)=>e.jsxs(se,{children:[e.jsx(te,{className:"border border-gray-300 p-2",children:t.grade}),e.jsx(te,{className:"border border-gray-300 p-2",children:t.description})]},d))})]})})]})},{Tr:Q,Th:Fe,Td:g,THead:Me,TBody:Re}=u,Pe=r=>{const a=r.reduce((n,l)=>n+l.kra_weight,0),s=r.reduce((n,l)=>n+l.objectives.reduce((t,d)=>t+d.gradeed_weight,0),0),c=r.reduce((n,l)=>n+l.objectives.reduce((t,d)=>t+d.quater_markes,0),0);return{totalWeight:a,totalGradeWeight:s,totalScore:c}},He=({employee_task:r})=>e.jsx("div",{className:"mt-2",children:Object.entries(r).map(([a,s])=>{const{totalWeight:c,totalGradeWeight:n,totalScore:l}=Pe(s);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(I,{className:"mr-2",variant:"solid",children:["Quarter ",a]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Me,{children:e.jsx(Q,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Graded Weight","KPIs","Unit of Measurement","Target Set","Target Achieved","Score","Raw","Weighted"].map((t,d)=>e.jsx(Fe,{className:"border border-gray-400",children:t},d))})}),e.jsxs(Re,{children:[s.map((t,d)=>e.jsx(ue.Fragment,{children:t.objectives.map((i,m)=>e.jsxs(Q,{children:[m===0&&e.jsxs(e.Fragment,{children:[e.jsx(g,{rowSpan:t.objectives.length,className:"border border-gray-400 p-2 text-center",children:d+1}),e.jsx(g,{rowSpan:t.objectives.length,className:"border border-gray-400 p-2",children:t.kra_name}),e.jsx(g,{rowSpan:t.objectives.length,className:"border border-gray-400 p-2 text-center",children:t.kra_weight})]}),e.jsx(g,{className:"border border-gray-400 p-2 break-all",children:i.objective_name}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:i.gradeed_weight}),e.jsx(g,{className:"border border-gray-400 p-2",children:i.kpi}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:i.unit}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:i.target}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:i.target_achieved}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:i.quater_markes}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:i.raw}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:i.weighted})]},i.id))},t.kra_id)),e.jsxs(Q,{className:"font-semibold bg-gray-100",children:[e.jsx(g,{colSpan:2,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(g,{className:"border border-gray-400 text-center",children:Math.round(c)}),e.jsx(g,{colSpan:1,className:"border border-gray-400"}),e.jsx(g,{className:"border border-gray-400 text-center",children:Math.round(n)}),e.jsx(g,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(g,{colSpan:3,className:"border border-gray-400 text-center",children:l})]})]})]})]},a)})}),{Tr:le,Th:ne,Td:ce,THead:Be,TBody:We}=u,Le=({isOpen:r,setIsOpen:a})=>{const[s,c]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const l=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]);const n=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."}];return e.jsx(Y,{isOpen:r,title:"Performance Rating Scale",width:s?"100%":750,onClose:()=>a(!1),children:e.jsxs(u,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(Be,{children:e.jsxs(le,{className:"bg-gray-100",children:[e.jsx(ne,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(ne,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(We,{children:n.map(l=>e.jsxs(le,{children:[e.jsx(ce,{className:"border border-gray-300 p-2",children:l.title}),e.jsx(ce,{className:"border border-gray-300 p-2",children:l.desc})]},l.id))})]})})},ze=()=>{const[r,a]=o.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(I,{variant:"twoTone",size:"xs",icon:e.jsx(U,{}),onClick:()=>a(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(Le,{isOpen:r,setIsOpen:a})]})},{Tr:V,Th:_,Td:N,THead:Ye,TBody:Ue}=u,qe=({competencies:r})=>e.jsx("div",{className:"mt-2",children:Object.entries(r).map(([a,s])=>{const c=s.reduce((t,d)=>t+d.competencies_details.reduce((i,m)=>i+m.max_score,0),0),n=s.reduce((t,d)=>t+d.competencies_details.reduce((i,m)=>i+m.quarter_marks,0),0),l=c>0?n/c*20:0;return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(I,{className:"mr-2",variant:"solid",children:["Quarter ",a]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Ye,{children:e.jsxs(V,{className:"bg-gray-200",children:[e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Quarter Marks"})]})}),e.jsxs(Ue,{children:[s.map(t=>t.competencies_details.map((d,i)=>e.jsxs(V,{children:[e.jsx(N,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:t.competencies}),e.jsx(N,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.cluster}),e.jsx(N,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.sub_cluster}),e.jsx(N,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.describe_expectations}),e.jsx(N,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.max_score}),e.jsx(N,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.min_score}),e.jsx(N,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.quarter_marks})]},`${t.id}-${i}`))),e.jsxs(V,{className:"bg-gray-100 font-bold",children:[e.jsx(N,{colSpan:5,className:"border border-gray-400 p-2 text-right",children:"Total"}),e.jsx(N,{colSpan:2,className:"border border-gray-400 p-2 text-center",children:l.toFixed(2)})]})]})]})]},a)})}),{Tr:P,Th:de,Td:D,THead:Ge,TBody:Qe}=u,Ve=()=>{const[r,a]=o.useState(!1),[s,c]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const t=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const n=()=>{a(!0)},l=t=>{console.log("onDrawerClose",t),a(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(I,{variant:"twoTone",size:"xs",icon:e.jsx(U,{}),onClick:()=>n(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(Y,{title:"Performance Rating Scale  ",isOpen:r,width:s?"100%":750,onClose:l,onRequestClose:l,children:e.jsxs(u,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(Ge,{children:e.jsxs(P,{className:"bg-gray-100",children:[e.jsx(de,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(de,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs(Qe,{children:[e.jsxs(P,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(P,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(P,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(P,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:K,Th:H,Td:C,THead:Ke,TBody:Je}=u,Xe=({operation_and_process:r})=>{const a=s=>{const c=s.reduce((t,d)=>t+d.details.reduce((i,m)=>i+m.max_score,0),0),n=s.reduce((t,d)=>t+d.details.reduce((i,m)=>i+m.quarter_marks,0),0),l=c>0?parseFloat((n/c*10).toFixed(2)):0;return{totalMaxScore:c,totalQuarterMarks:n,competencyMarks:l}};return e.jsx("div",{className:"mt-2",children:Object.keys(r).map(s=>{const c=r[s],{competencyMarks:n}=a(c);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(I,{className:"mr-2",variant:"solid",children:["Quarter ",s]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Ke,{children:e.jsxs(K,{className:"bg-gray-200",children:[e.jsx(H,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx(H,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx(H,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx(H,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx(H,{className:"border border-gray-400 p-2 text-center",children:"Quarter Marks"})]})}),e.jsxs(Je,{children:[c.map((l,t)=>l.details.map(d=>e.jsxs(K,{children:[e.jsx(C,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:l.operations_and_process}),e.jsx(C,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.describe_expectations}),e.jsx(C,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:d.min_score}),e.jsx(C,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:d.max_score}),e.jsx(C,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:d.quarter_marks})]},`${t}-${d.id}`))),e.jsxs(K,{className:"font-semibold bg-gray-100",children:[e.jsx(C,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(C,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(C,{colSpan:2,className:"border border-gray-400 text-center",children:n})]})]})]})]},s)})})},{Tr:oe,Th:ie,Td:me,THead:Ze,TBody:er}=u,rr=[{label:"sub-total rating of appraisee performance (expectations and goals from section 3)",value:191.425},{label:"sub-total rating of appraisee performance (competencies) in section 4",value:29.3},{label:"sub-total rating of appraisee performance (operations and processes) section 5",value:22.158},{label:"overall rating (section 3 + 4 + 5)",value:242.883},{label:"overall annual score",value:60.72075}],sr=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"section 6 : SUMMARY OF OVERALL ASSESSMENT"})})}),e.jsxs(u,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left bg-white",children:[e.jsx(Ze,{children:e.jsxs(oe,{className:"bg-gray-100",children:[e.jsx(ie,{className:"border border-gray-300 p-2",children:"overall assessment"}),e.jsx(ie,{className:"border border-gray-300 p-2",children:"appraiser rating"})]})}),e.jsx(er,{children:rr.map((r,a)=>e.jsxs(oe,{children:[e.jsx(me,{className:"border border-gray-300 p-2",children:r.label}),e.jsx(me,{className:"border border-gray-300 p-2 text-center",children:r.value})]},a))})]})]}),ar=({assesment:r,improvement:a})=>e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-semibold text-black",children:"What are the employee’s strengths?"}),e.jsx(O,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:r||"What are the employee’s strengths?"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"font-semibold text-black",children:"What are the employee’s areas for improvement?"}),e.jsx(O,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:a||"What are the employee’s areas for improvement?"})]})]}),tr=async(r,a,s,c,n)=>{try{return await J({url:`/supervisor/form_c?department_id=${r}&team_id=${a}&year=${s}&staff_id=${c}&quater=${n}`,method:"get"})}catch(l){throw console.error("Error fetching information data:",l),l}},lr=async(r,a,s,c)=>{try{const n=await J({url:`/supervisor/form_c_comments?department_id=${r}&team_id=${a}&year=${s}&staff_id=${c}`,method:"get"});return console.log(n),n}catch(n){throw console.error("Error fetching information data:",n),n}},nr=async r=>{try{const a=await J({url:"/supervisor/form_c_comments",method:"post",data:r});return console.log(a),a}catch(a){throw console.error("Error fetching information data:",a),a}},cr=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 6 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),dr=({evidenceList:r=[],onChange:a})=>{const[s,c]=o.useState(!1),[n,l]=o.useState([]),t=Array.isArray(r)?r.map(m=>({label:m.name,value:m.evidence_id})):[],d=m=>{n.some(p=>p.value===m.evidence_id)||l(p=>[...p,{label:m.name,value:m.evidence_id}]),c(!1)},i=m=>{var p;const h=((p=m.split(".").pop())==null?void 0:p.toLowerCase())||"";return["jpg","jpeg","png","gif"].includes(h)?e.jsx(Te,{className:"w-8 h-8 text-blue-600"}):h==="pdf"?e.jsx(Ee,{className:"w-8 h-8 text-red-600"}):["xls","xlsx"].includes(h)?e.jsx(De,{className:"w-8 h-8 text-green-600"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"N/A"})};return o.useEffect(()=>{const m=n.map(h=>h.value);a(m)},[n,a]),e.jsxs("div",{className:"w-full sm:w-1/2 mb-4",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Evidence Information:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsx(q,{isMulti:!0,placeholder:"Please Select",className:"w-full flex-1",options:t,value:n,onChange:l}),e.jsx(U,{className:"w-6 h-6 text-gray-500 hover:text-gray-700 cursor-pointer mt-1 sm:mt-0",onClick:()=>c(!0)}),e.jsx(Y,{title:"Evidence Details",isOpen:s,width:500,onClose:()=>c(!1),onRequestClose:()=>c(!1),children:e.jsx("div",{className:"space-y-4 p-4 max-w-full",children:Array.isArray(r)&&r.map(m=>e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-100 border-blue-500 flex flex-col sm:flex-row justify-between items-start sm:items-center cursor-pointer hover:bg-blue-50",onClick:()=>d(m),children:[e.jsxs("div",{className:"space-y-1 w-full sm:w-3/4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:m.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:m.description}),e.jsx("a",{href:m.file_path,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline mt-2 block text-sm font-bold",children:"View File"})]}),e.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-4",children:i(m.file_path)})]},m.id))})})]})]})},or=({comments:r,onAppraisersCommentChange:a,showValidationError:s,commentInputRef:c})=>{var d;const[n,l]=o.useState("");o.useEffect(()=>{const i=r.staff.comment||"";l(i),a(i)},[r.staff.comment]);const t=i=>{const m=i.target.value;l(m),a(m)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(O,{textArea:!0,disabled:!0,className:"input-textarea mt-2",value:r.staff.comment||""})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(O,{required:!0,ref:c,textArea:!0,value:n,placeholder:"Enter your comments here",className:`textarea mt-2 w-full rounded-md border px-3 py-2 focus:outline-none ${s&&!n?"border-red-500":"border-gray-300"}`,onChange:t}),s&&!n&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(Ne,{className:"mr-1"}),"This field is required."]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx(O,{disabled:!0,textArea:!0,value:((d=r.officer)==null?void 0:d.comment)||"",className:"input-textarea mt-2"})]})]})},ir=({Staff:r})=>{const a=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],s=a.find(c=>c.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(q,{isDisabled:!0,id:"declaration",value:s,options:a,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(O,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraiser"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},xe=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],mr=({Supervisor:r,onChange:a,officerDeclaration:s})=>{const[c,n]=o.useState(null),[l,t]=o.useState(null),[d,i]=o.useState(null),[m,h]=o.useState(null),[p,v]=o.useState(!1),[w,k]=o.useState(0),j=o.useRef(null),S=o.useRef(null),T=o.useRef(null);o.useEffect(()=>{r&&(n(r.declaration),i(r.signature),t(r.date?new Date(r.date):null),k((r.signature,0)))},[r]);const f=x=>{var R;const b=(R=x.target.files)==null?void 0:R[0];if(b){if(b.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!b.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const F=new FileReader;F.onloadend=()=>{const B=F.result;i(B),h(b.name),k(1)},F.readAsDataURL(b)}},y=()=>{v(!0)},$=async()=>{if(S.current&&!S.current.isEmpty()){if(T.current){const b=(await Ie(T.current)).toDataURL("image/png");i(b),k(1),v(!1)}}else alert("Please draw a signature before saving.")},A=()=>{var x;(x=S.current)==null||x.clear()};return o.useEffect(()=>{const x=l!==null?new Date(l.getFullYear(),l.getMonth(),l.getDate()+1):null,b={declaration:c,date:x,flag:w};w===1&&(b.signature=d),a(b)},[c,l,d,w]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Declaration:"}),e.jsx(q,{isDisabled:s===1,placeholder:"Please Select",options:xe,className:"mt-2",value:xe.find(x=>x.value===c),onChange:x=>n((x==null?void 0:x.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(ye,{disabled:s===1,className:"mt-2",value:l,onChange:x=>t(x)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1",children:"Appraisee's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",disabled:s===1,className:`flex items-center gap-2 focus:outline-none text-white font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2
                ${s===1?"bg-gray-400 cursor-not-allowed":"bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300"}`,onClick:y,children:[e.jsx(ve,{className:"w-5 h-5"}),"Add Signature"]}),e.jsxs("button",{type:"button",disabled:s===1,className:`flex items-center gap-2 focus:outline-none text-white font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2
                ${s===1?"bg-gray-400 cursor-not-allowed":"bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300"}`,onClick:()=>{var x;return(x=j.current)==null?void 0:x.click()},children:[e.jsx(we,{className:"w-5 h-5"}),"Upload"]}),e.jsx("input",{ref:j,type:"file",accept:"image/*",className:"hidden",onChange:f})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),d&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:d,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>v(!1),children:e.jsx(Se,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:T,className:" rounded-md mt-4 bg-white",children:e.jsx(Ce,{ref:S,canvasProps:{width:330,height:150,className:"sigCanvas "}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(I,{size:"sm",variant:"default",onClick:A,children:"Clear"}),e.jsx(I,{size:"sm",variant:"solid",onClick:$,children:"Save"})]})]})})]})},xr=({officer:r})=>{const a=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],s=a.find(c=>c.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Declaration:"}),e.jsx(q,{isDisabled:!0,id:"declaration",value:s,options:a,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(O,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Countersigning Officer's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},gr=({submittedEvidence:r})=>{if(!r||r.length===0)return e.jsx("p",{className:"text-gray-500",children:"No submitted evidence available."});const a=async s=>{try{const n=(await ke(s)).data,l=URL.createObjectURL(n);window.open(l,"_blank")}catch(c){console.error("Error fetching evidence data:",c)}};return e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Submitted Evidence:"}),e.jsx("div",{className:"flex flex-col gap-4",children:r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"text-blue-600 underline max-w-[250px] truncate cursor-pointer",onClick:()=>a(s.evidence_id),children:s.evidence_id}),e.jsx("div",{className:"flex-1 text-right",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:[e.jsx("strong",{children:"Created:"})," ",new Date(s.created_at).toLocaleDateString()]})})]},s.id))})]})},ur=()=>{var A,x,b,R,F,B,X,Z,ee,re;const{id:r}=ge(),a=he(),[s,c]=o.useState(),[n,l]=o.useState(!0),[t,d]=o.useState(null),[i,m]=o.useState([]),[h,p]=o.useState(""),[v,w]=o.useState(!1),k=async()=>{try{const E=localStorage.getItem("selectedDepartmentID")||"",M=localStorage.getItem("selectedTeamID"),G=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),W=await lr(E,M?Number(M):null,G,String(r));if(W&&W.data)c(W.data);else throw new Error("Invalid response data")}catch(E){console.error("Error fetching data:",E),d("Failed to load data. Please try again.")}finally{l(!1)}};o.useEffect(()=>{k()},[]);const[j,S]=o.useState({declaration:null,date:null,signature:null,flag:0}),T=o.useRef(null),f=async()=>{var E;if(!h.trim()){w(!0),(E=T.current)==null||E.scrollIntoView({behavior:"smooth",block:"center"}),L.push(e.jsx(z,{title:"Error",type:"danger",children:"Appraisers 's Comments is reuired"}),{placement:"top-center"});return}try{const M=j.date instanceof Date?j.date.toISOString().split("T")[0]:null,G={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),evidence_ids:i,comment:h,date:M,signature:j.signature,declaration:j.declaration,flag:j.flag,staff_id:r};(await nr(G)).status===200?L.push(e.jsx(z,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):L.push(e.jsx(z,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(M){console.error("Error submitting data:",M),L.push(e.jsx(z,{title:"Error",type:"danger",children:"Failed to submit data. Please check your connection and try again."}),{placement:"top-center"})}},y=()=>{a(-1)},$=()=>{a("/dashboard")};return n?e.jsx("div",{children:"Loading..."}):t?e.jsx("div",{className:"text-red-500",children:t}):e.jsxs("div",{className:"mt-4  mx-auto w-full ",children:[e.jsx(cr,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(gr,{submittedEvidence:((x=(A=s==null?void 0:s.comments)==null?void 0:A.staff)==null?void 0:x.evidence)||[]})}),e.jsx("div",{className:"mt-4",children:e.jsx(dr,{evidenceList:(s==null?void 0:s.evidence_list)||[],onChange:m})}),e.jsx("div",{className:"mt-4",children:e.jsx(or,{commentInputRef:T,comments:{staff:((b=s==null?void 0:s.comments)==null?void 0:b.staff)||{comment:""},supervisor:((R=s==null?void 0:s.comments)==null?void 0:R.supervisor)||{comment:""},officer:((F=s==null?void 0:s.comments)==null?void 0:F.officer)||{comment:""}},showValidationError:v,onAppraisersCommentChange:p})}),e.jsx("div",{className:"mt-4",children:e.jsx(ir,{Staff:(B=s==null?void 0:s.comments)==null?void 0:B.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{Supervisor:(X=s==null?void 0:s.comments)==null?void 0:X.supervisor,onChange:E=>{S(E)},officerDeclaration:(ee=(Z=s==null?void 0:s.comments)==null?void 0:Z.officer)==null?void 0:ee.declaration})}),e.jsx("div",{className:"mt-4",children:e.jsx(xr,{officer:(re=s==null?void 0:s.comments)==null?void 0:re.officer})})]}),e.jsx(be,{back:"Back",handleBack:y,save:"Save",handleSave:f,next:"Continue to Dashboard",handleNext:$})]})},Cr=()=>{const{id:r}=ge(),a=pe(y=>y.quaterTab.selectedQuarter),[s,c]=o.useState(null),[n,l]=o.useState(!0),[t,d]=o.useState(null),i=async()=>{try{const y=localStorage.getItem("selectedDepartmentID")||"",$=localStorage.getItem("selectedTeamID"),A=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),x=await tr(y,$?Number($):null,A,String(r),a);if(x&&x.data)c(x.data);else throw new Error("Invalid response data")}catch(y){console.error("Error fetching data:",y),d("Failed to load data. Please try again.")}finally{l(!1)}};if(o.useEffect(()=>{i()},[]),n)return e.jsx("div",{children:"Loading..."});if(t)return e.jsx("div",{className:"text-red-500",children:t});const{department:m,team:h,supervisor:p,officer:v,staff:w,progress:k,employee_task:j,competencies:S,operation_and_process:T,others:f}=s||{};return e.jsxs("div",{children:[e.jsx(je,{department:m,team:h,progress:k,title:"Employee Annual Appraisal Document",downloadButton:!0,staffID:r}),w&&p&&v&&e.jsx(fe,{staff:w,supervisor:p,officer:v}),e.jsx(Ae,{}),e.jsx(He,{employee_task:j}),e.jsx(ze,{}),e.jsx(qe,{competencies:S}),e.jsx(Ve,{}),e.jsx(Xe,{operation_and_process:T}),e.jsx(sr,{}),e.jsx(ar,{assesment:f==null?void 0:f.strengths,improvement:f==null?void 0:f.improvement}),e.jsx(ur,{})]})};export{Cr as default};

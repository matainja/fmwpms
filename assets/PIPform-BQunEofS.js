import{j as e,a0 as w,u as M,r as c}from"./index-XEIncrLJ.js";import"./FormContainer-BcWWCs1J.js";import{b as E}from"./Tag-MScPo-d6.js";import{I as F,B as k}from"./hoist-non-react-statics.cjs-vrUR2keZ.js";import{e as B}from"./Upload-Dovppv8_.js";import"./Select-BAk-N8U6.js";import{t as D,N as A}from"./toast-BA_WAYTR.js";import"./Views-DInV39d3.js";const W=()=>e.jsxs("div",{className:"flex justify-between items-start border-2 border-gray-300 rounded-lg p-4",children:[e.jsxs("div",{className:"text-sm gap-5 ",children:[e.jsx("h3",{className:"font-semibold text-lg/7 mb-1",children:"Why we use PIP ?"}),e.jsxs("p",{className:"text-sm text-gray-600 ",children:["The Performance Improvement Paln is used to formally document corrective action aimed at addressing serious or consistent appraisee under-performance.Its key purpose is to help concentrate the focus of the appraiser and the HR Department on ensuring that the appraisee","'s "," ","under-performance imprves significantly within the shortest time possible."]})]}),e.jsx("div",{})]}),G=()=>e.jsxs("div",{className:" border-2 border-gray-300 rounded-lg shadow-sm bg-white w-full max-w-4xl h-full p-2 flex flex-col justify-center items-center",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Appraisal Period Covered"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["1st January 2024"," to ","31st December 2024"]})]}),U=async(s,t,m)=>{try{return await w({url:`/pip?department_id=${s}&team_id=${t}&year=${m}`,method:"get"})}catch(r){throw console.error("Error fetching information data:",r),r}},z=async s=>{try{return await w({url:"improvment_plan_and_goals",method:"Post",data:s})}catch(t){throw console.error("Error fetching information data:",t),t}},$=async(s,t,m)=>{try{return await w({url:`/improvment_plan_and_goals?department_id=${s}&team_id=${t}&year=${m}`,method:"get"})}catch(r){throw console.error("Error fetching information data:",r),r}},q=async(s,t,m)=>{try{return await w({url:`/pip_comments?department_id=${s}&team_id=${t}&year=${m}`,method:"get"})}catch(r){throw console.error("Error fetching information data:",r),r}},J=async s=>{try{return await w({url:"/pip_comments",method:"post",data:s})}catch(t){throw console.error("Error fetching information data:",t),t}},K=({hrInfo:s})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-4",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"FOR USE ONLY BY THE HUMAN RESOURCE DEPARTMENT"})}),e.jsx("div",{className:"p-3 border-2 rounded-lg shadow-sm bg-white w-full mb-4",children:e.jsxs("div",{className:"flex flex-col text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-extrabold",children:["HR's Comment:"," "]}),s.comment||"N/A"]}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-extrabold",children:"Date of Receipt in HR's Dept.:"})," ",s.date?new Date(s.date).toLocaleDateString():"N/A"]}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-extrabold",children:"HR's Name: "}),s.name||"N/A"]}),e.jsxs("p",{className:"mt-1",children:[e.jsxs("span",{className:"font-extrabold",children:["HR's Declaration:"," "]}),s.declaration===0?"Approved":s.declaration===1?"Rejected":"N/A"]})]})})]}),V=()=>{const{userName:s}=M(a=>a.auth.user||{}),[t,m]=c.useState({comment:"",name:"",declaration:"",date:null}),[r,f]=c.useState({comment:"",name:"",declaration:-1,date:null}),[j,y]=c.useState(null),[u,l]=c.useState(!1),[p,b]=c.useState(""),v=async()=>{var a,i,h,g,N,_;l(!0);try{const T=localStorage.getItem("selectedDepartmentID")||"",R=localStorage.getItem("selectedTeamID"),H=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),P=await q(T,R?Number(R):null,H),o=(a=P==null?void 0:P.data)==null?void 0:a.comments;if(o)m({comment:((i=o.staff)==null?void 0:i.comment)||"",name:((h=o.staff)==null?void 0:h.name)||"",declaration:((N=(g=o.staff)==null?void 0:g.declaration)==null?void 0:N.toString())??"",date:(_=o.staff)!=null&&_.date?new Date(o.staff.date):null}),o!=null&&o.supervisor&&Object.keys(o.supervisor).length>0?f({comment:o.supervisor.comment||"",name:o.supervisor.name||"",declaration:o.supervisor.declaration??-1,date:o.supervisor.date||null}):f({comment:"",name:"",declaration:-1,date:null}),o!=null&&o.hr&&Object.keys(o.hr).length>0&&(y({comment:o.hr.comment||"",name:o.hr.name||"",declaration:o.hr.declaration??-1,date:o.hr.date||null}),console.log("HR Info:",o.hr));else throw new Error("No staff comment data found.")}catch(T){console.error("Error fetching data:",T),b("Failed to load data. Please try again.")}finally{l(!1)}};c.useEffect(()=>{v()},[]);const x=a=>{const{name:i,value:h}=a.target;m(g=>({...g,[i]:h}))},n=a=>{m(i=>({...i,date:a}))},d=async()=>{var i,h,g;const a={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),...t,name:s,declaration:Number(t.declaration),date:(i=t.date)==null?void 0:i.toISOString().split("T")[0]};try{(await J(a)).status===200&&D.push(e.jsx(A,{title:"Success",type:"success",children:"Data added successfully!"}),{placement:"top-center"})}catch(N){D.push(e.jsx(A,{title:"Error",type:"danger",children:((g=(h=N==null?void 0:N.response)==null?void 0:h.data)==null?void 0:g.error)||"Failed to submit data."}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-4",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"SECTION 4: CONFIRMATION AND ACKNOWLEDGEMENT"})}),u?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):e.jsxs("div",{className:"bg-white p-4 border-2 border-gray-300 rounded-lg shadow-sm space-y-4",children:[p&&e.jsx("p",{className:"text-red-500 text-sm",children:p}),e.jsx("div",{children:e.jsx(F,{textArea:!0,name:"comment",placeholder:"Write your words",value:t.comment,className:"block w-full text-sm border border-gray-300 rounded-md shadow-sm p-2",onChange:x})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appraisee Name"}),e.jsx(F,{disabled:!0,name:"name",type:"text",placeholder:"Appraisee Name",value:s,size:"sm",className:"w-full border border-gray-300 rounded-md p-2 text-sm shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appraisee Declaration"}),e.jsxs("select",{name:"declaration",value:t.declaration,className:"w-full border border-gray-300 rounded-md p-2 text-sm shadow-sm",onChange:x,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"0",children:"Agree"}),e.jsx("option",{value:"1",children:"Disagree"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx(B,{size:"sm",placeholder:"Pick a date",value:t.date,onChange:n})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(k,{variant:"solid",onClick:d,children:"Submit"})})]}),e.jsx("div",{className:"p-3 border-2 rounded-lg shadow-sm bg-white w-full my-4",children:e.jsxs("div",{className:"flex flex-col text-sm text-gray-700 space-y-1",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-extrabold",children:["Appraiser Comment:"," "]}),r.comment||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Appraiser Name: "}),r.name||"N/A"]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-extrabold",children:["Appraiser Declaration:"," "]}),r.declaration===0?"Agree":r.declaration===1?"Disagree":"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Date: "}),r.date?new Date(r.date).toLocaleDateString():"N/A"]})]})}),j&&e.jsx(K,{hrInfo:j})]})},Q=({StaffDetails:s,SupervisorDetails:t})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-2",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"SECTION 1: (PERSONAL INFORMATION)"})}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-3 border-2 rounded-lg shadow-sm bg-white w-full",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Apprisee Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"First Name:"}),s.F_Name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Middle Name:"})," ",s.M_Name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Last Name:"})," ",s.L_Name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Email:"})," ",s.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Role:"})," ",s.role]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Ippis No:"})," ",s.ippis_no]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Phone:"})," ",s.phone]})]})]}),e.jsxs("div",{className:"p-4 border-2 rounded-lg shadow-sm bg-white w-full",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Appraiser Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"First Name:"})," ",t.F_Name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Middle Name:"})," ",t.M_Name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Last Name:"})," ",t.L_Name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"email:"})," ",t.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Role:"})," ",t.role]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Ippis No:"})," ",t.ippis_no]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Phone:"})," ",t.phone]})]})]})]})})]}),{Tr:Y,Th:I,Td:C,THead:X,TBody:Z}=E,ee=()=>{const[s,t]=c.useState([]),[m,r]=c.useState(!1),[f,j]=c.useState(!0),[y,u]=c.useState(null),l={areas_of_needed_improvement:"",activities_planned_to_improve_performance:"",support_resources_to_be_provided:""},p=async()=>{var x,n,d;try{j(!0);const a=localStorage.getItem("selectedDepartmentID")||"",i=localStorage.getItem("selectedTeamID"),h=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),g=await $(a,i?Number(i):null,h);if((n=(x=g==null?void 0:g.data)==null?void 0:x.data)!=null&&n.length){const N=g.data.data,_=Array.from({length:5-N.length},()=>({...l}));t([...N,..._])}else throw new Error("No data found.")}catch(a){((d=a.response)==null?void 0:d.status)===404?t(Array.from({length:5},()=>({...l}))):u("Failed to load data. Please try again.")}finally{j(!1)}};c.useEffect(()=>{p()},[]);const b=(x,n,d)=>{const a=[...s];a[x][n]=d,t(a)},v=async()=>{if(m)return;r(!0);const x=localStorage.getItem("selectedDepartmentID")||"",n=localStorage.getItem("selectedTeamID"),d=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),a=s.filter(h=>h.areas_of_needed_improvement.trim()||h.activities_planned_to_improve_performance.trim()||h.support_resources_to_be_provided.trim()),i={department_id:x,team_id:n,year:d,improvement_plan_goals:a};try{if((await z(i)).status===201){D.push(e.jsx(A,{title:"Success",type:"success",children:"Data added successfully!"}),{placement:"top-center"});const g=Array.from({length:5-a.length},()=>({...l}));t([...a,...g])}}catch{D.push(e.jsx(A,{title:"Error",type:"danger",children:"Something went wrong. Please try again."}),{placement:"top-center"})}finally{setTimeout(()=>{r(!1)},4e3)}};return f?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-2",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"SECTION 3: IMPROVEMENT PLAN AND GOAL(S) List out the specific actions to be taken to address the areas of concerns listed above and the desired results and goals to be attained by the appraisee in each area"})}),e.jsxs(E,{className:"w-full border border-gray-300 text-sm",children:[e.jsx(X,{children:e.jsxs(Y,{className:"bg-gray-300",children:[e.jsx(I,{className:"font-semibold border p-2 w-10",children:"#"}),e.jsx(I,{className:"font-semibold border p-2",children:"Area(s) of Needed Improvement"}),e.jsx(I,{className:"font-semibold border p-2",children:"Activities Planned to Improve Performance"}),e.jsx(I,{className:"font-semibold border p-2",children:"Support/Resources to be Provided"})]})}),e.jsx(Z,{children:s.map((x,n)=>e.jsxs(Y,{children:[e.jsx(C,{className:"border text-center",children:n+1}),["areas_of_needed_improvement","activities_planned_to_improve_performance","support_resources_to_be_provided"].map(d=>e.jsx(C,{className:"border",children:e.jsx("input",{type:"text",value:x[d],className:"w-full border-none outline-none p-1",onChange:a=>b(n,d,a.target.value)})},d))]},n))})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(k,{variant:"solid",disabled:m||s.length===0,onClick:v,children:m?"Submitting...":"Submit Data"})})]})},{Tr:O,Th:S,Td:L,THead:te,TBody:se}=E,ae=()=>{const[s,t]=c.useState([]),[m,r]=c.useState(!0),[f,j]=c.useState(null),y=async()=>{var u,l,p;try{r(!0),j(null);const b=localStorage.getItem("selectedDepartmentID")||"",v=localStorage.getItem("selectedTeamID"),x=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),n=await $(b,v?Number(v):null,x);if((l=(u=n==null?void 0:n.data)==null?void 0:u.data)!=null&&l.length)t(n.data.data);else throw new Error("No data found.")}catch(b){((p=b.response)==null?void 0:p.status)===404?t(Array.from({length:5},()=>({areas_of_needed_improvement:"",activities_planned_to_improve_performance:"",support_resources_to_be_provided:""}))):j("Failed to load data. Please try again.")}finally{r(!1)}};return c.useEffect(()=>{y()},[]),m?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-2",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"SECTION 2: AREA (S) OF CONCERN Your performance appraisal results indicate that your performance on agreed targets have been unsatisfactory and far below the required standards set for your job position. Based on this, you have been issued with this Performance Improvement Plan to help you work on the critical areas indicated below"})}),f&&e.jsx("div",{className:"text-red-600 font-semibold mb-4",children:f}),e.jsxs(E,{className:"w-full border border-gray-300 text-sm",children:[e.jsx(te,{children:e.jsxs(O,{className:"bg-gray-300",children:[e.jsx(S,{className:"font-semibold border p-2 w-10",children:"#"}),e.jsx(S,{className:"font-semibold border p-2",children:"Area(s) of Needed Improvement"}),e.jsx(S,{className:"font-semibold border p-2",children:"Activities Planned to Improve Performance"}),e.jsx(S,{className:"font-semibold border p-2",children:"Support/Resources to be Provided"})]})}),e.jsx(se,{children:s.map((u,l)=>e.jsxs(O,{children:[e.jsx(L,{className:"border text-center",children:l+1}),["areas_of_needed_improvement","activities_planned_to_improve_performance","support_resources_to_be_provided"].map(p=>e.jsx(L,{className:"border p-2",children:u[p]},p))]},l))})]})]})},pe=()=>{const[s,t]=c.useState(null),[m,r]=c.useState(!0),[f,j]=c.useState(null),y=async()=>{try{const n=localStorage.getItem("selectedDepartmentID")||"",d=localStorage.getItem("selectedTeamID"),a=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),i=await U(n,d?Number(d):null,a);if(i&&i.data)t(i.data);else throw new Error("Invalid response data")}catch(n){console.error("Error fetching data:",n),j("Failed to load data. Please try again.")}finally{r(!1)}};if(c.useEffect(()=>{y()},[]),m)return e.jsx("div",{children:"Loading..."});if(f)return e.jsx("div",{className:"text-red-500",children:f});const u=(n,d)=>{const a=n.split(" ");return a.slice(0,d).join(" ")+(a.length>d?"...":"")},{department:l,team:p,supervisor:b,staff:v,officer:x}=s||{};return e.jsxs("div",{className:" space-y-5 min-h-screen",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("img",{src:"/img/logo/new-logo education.png",className:"h-16 w-53"}),e.jsx("p",{className:"text-lg font-bold text-black",children:"Performance Improvement Plan"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row items-end lg:items-center gap-4 lg:gap-8 text-right lg:text-left",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-black",children:e.jsx("div",{className:"text-sm font-semibold text-black",children:u((p==null?void 0:p.team_name)||"N/A",5)})}),e.jsx("p",{className:"text-gray-500",children:u((p==null?void 0:p.team_description)||"No description available",5)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-black",children:u((l==null?void 0:l.department_name)||"N/A",5)}),e.jsx("p",{className:"text-gray-500",children:u((l==null?void 0:l.department_description)||"N/A",5)})]})]})]}),e.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx("div",{className:"  p-4",children:e.jsx(W,{})}),e.jsx("div",{className:" p-4",children:e.jsx(G,{})})]}),e.jsx("section",{children:e.jsx(Q,{StaffDetails:v,SupervisorDetails:b})}),e.jsx("section",{children:e.jsx(ae,{})}),e.jsx("section",{children:e.jsx(ee,{})}),e.jsx("section",{children:e.jsx(V,{})})]})};export{pe as default};

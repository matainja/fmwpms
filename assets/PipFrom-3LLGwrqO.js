import{j as e,a0 as S,$ as P,u as B,r as c,J as W}from"./index-CdXcW46_.js";import"./FormContainer-B5i-gxwG.js";import{b as O,c as G,d as L,e as I,f as U,g as D}from"./Tag-BIrPdKNG.js";import{I as k,B as H}from"./hoist-non-react-statics.cjs-BYdDfNAW.js";import{e as z}from"./Upload-CkxX527j.js";import"./Select-epRO6R5x.js";import{t as E,N as A}from"./toast-DnPvOHpm.js";import"./SvgIcon-789oDBY2.js";import"./Views-YlTiOC4j.js";import"./index-8ORoQwk5.js";import"./quill.snow-CicULtXM.js";import"./cloneDeep-DznBgb_t.js";import"./useThemeClass-Cjhy4_sh.js";const J=()=>e.jsxs("div",{className:"flex justify-between items-start border-2 border-gray-300 rounded-lg p-6",children:[e.jsxs("div",{className:"text-sm gap-5 ",children:[e.jsx("h3",{className:"font-semibold text-lg/7",children:"Why we use PIP ?"}),e.jsxs("p",{className:"text-sm text-gray-600 max-w-md",children:["The Performance Improvement Paln is used to formally document corrective action aimed at addressing serious or consistent appraisee under-performance.Its key purpose is to help concentrate the focus of the appraiser and the HR Department on ensuring that the appraisee","'s "," under-performance imprves significantly within the shortest time possible."]})]}),e.jsx("div",{})]}),V=()=>e.jsxs("div",{className:"p-16 border-2 border-gray-300 rounded-lg shadow-sm bg-white w-full max-w-4xl",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Appraisal Period Covered"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["1st January 2024"," to ","31st December 2024"]})]}),q=({hrInfo:t})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-4",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"FOR USE ONLY BY THE HUMAN RESOURCE DEPARTMENT"})}),e.jsx("div",{className:"p-3 border-2 rounded-lg shadow-sm bg-white w-full mb-4",children:e.jsxs("div",{className:"flex flex-col text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-extrabold",children:["HR's Comment:"," "]}),t.comment||"N/A"]}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-extrabold",children:"Date of Receipt in HR's Dept.:"})," ",t.date?new Date(t.date).toLocaleDateString():"N/A"]}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-extrabold",children:"HR's Name: "}),t.name||"N/A"]}),e.jsxs("p",{className:"mt-1",children:[e.jsxs("span",{className:"font-extrabold",children:["HR's Declaration:"," "]}),t.declaration===0?"Approved":t.declaration===1?"Rejected":"N/A"]})]})})]}),K=async(t,s,a,l)=>{try{return await S({url:`supervisor/pip?department_id=${t}&team_id=${s}&year=${a} &staff_id=${l}`,method:"get"})}catch(r){throw console.error("Error fetching information data:",r),r}},Q=async(t,s,a,l)=>{try{return await S({url:`/supervisor/areas_of_concern?department_id=${t}&team_id=${s}&year=${a}&staff_id=${l}`,method:"get"})}catch(r){throw console.error("Error fetching information data:",r),r}},X=async t=>{try{return await S({url:"supervisor/areas_of_concern",method:"Post",data:t})}catch(s){throw console.error("Error fetching information data:",s),s}},Z=async(t,s,a,l)=>{try{return await S({url:`/supervisor/improvment_plan_and_goals?department_id=${t}&team_id=${s}&year=${a}&staff_id=${l}`,method:"get"})}catch(r){throw console.error("Error fetching information data:",r),r}},ee=async(t,s,a,l)=>{try{return await S({url:`/supervisor/pip_comments?department_id=${t}&team_id=${s}&year=${a}&staff_id=${l}`,method:"get"})}catch(r){throw console.error("Error fetching information data:",r),r}},te=async t=>{try{return await S({url:"supervisor/pip_comments",method:"post",data:t})}catch(s){throw console.error("Error fetching information data:",s),s}},se=()=>{const{id:t}=P(),{userName:s}=B(n=>n.auth.user||{}),[a,l]=c.useState({comment:"",name:"",declaration:"",date:null}),[r,N]=c.useState({comment:"",name:"",declaration:-1,date:null}),[b,f]=c.useState(null),[u,m]=c.useState(!1),[v,w]=c.useState(""),j=async()=>{var n,p,x,g,y,_;m(!0);try{const T=localStorage.getItem("selectedDepartmentID")||"",$=localStorage.getItem("selectedTeamID"),M=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),R=await ee(T,$?Number($):null,M,String(t)),o=(n=R==null?void 0:R.data)==null?void 0:n.comments;if(o)l({comment:((p=o.supervisor)==null?void 0:p.comment)||"",name:((x=o.supervisor)==null?void 0:x.name)||"",declaration:((y=(g=o.supervisor)==null?void 0:g.declaration)==null?void 0:y.toString())??"",date:(_=o.supervisor)!=null&&_.date?new Date(o.supervisor.date):null}),o!=null&&o.staff&&Object.keys(o.staff).length>0?N({comment:o.staff.comment||"",name:o.staff.name||"",declaration:o.staff.declaration??-1,date:o.staff.date||null}):N({comment:"",name:"",declaration:-1,date:null}),o!=null&&o.hr&&Object.keys(o.hr).length>0&&(f({comment:o.hr.comment||"",name:o.hr.name||"",declaration:o.hr.declaration??-1,date:o.hr.date||null}),console.log("HR Info:",o.hr));else throw new Error("No staff comment data found.")}catch(T){console.error("Error fetching data:",T),w("Failed to load data. Please try again.")}finally{m(!1)}};c.useEffect(()=>{j()},[]);const d=n=>{const{name:p,value:x}=n.target;l(g=>({...g,[p]:x}))},i=n=>{l(p=>({...p,date:n}))},h=async()=>{var p,x,g;const n={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),staff_id:t,year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),...a,name:s,declaration:parseInt(a.declaration,10),date:(p=a.date)==null?void 0:p.toISOString().split("T")[0]};try{(await te(n)).status===200&&E.push(e.jsx(A,{title:"Success",type:"success",children:"Data added successfully!"}),{placement:"top-center"})}catch(y){E.push(e.jsx(A,{title:"Error",type:"danger",children:((g=(x=y==null?void 0:y.response)==null?void 0:x.data)==null?void 0:g.error)||"Failed to submit data."}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-4",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"SECTION 4: CONFIRMATION AND ACKNOWLEDGEMENT"})}),e.jsx("div",{className:"p-3 border-2 rounded-lg shadow-sm bg-white w-full my-4",children:e.jsxs("div",{className:"flex flex-col text-sm text-gray-700 space-y-1",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-extrabold",children:["Appraisee Comment:"," "]}),r.comment||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Appraisee Name: "}),r.name||"N/A"]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-extrabold",children:["Appraisee Declaration:"," "]}),r.declaration===0?"Agree":r.declaration===1?"Disagree":"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Date: "}),r.date?new Date(r.date).toLocaleDateString():"N/A"]})]})}),u?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):e.jsxs("div",{className:"bg-white p-4 border-2 border-gray-300 rounded-lg shadow-sm space-y-4",children:[v&&e.jsx("p",{className:"text-red-500 text-sm",children:v}),e.jsx("div",{children:e.jsx(k,{textArea:!0,name:"comment",placeholder:"Write your words",value:a.comment,className:"block w-full text-sm border border-gray-300 rounded-md shadow-sm p-2",onChange:d})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appraiser Name"}),e.jsx(k,{disabled:!0,name:"name",type:"text",placeholder:"Appraisee Name",value:s,size:"sm",className:"w-full border border-gray-300 rounded-md p-2 text-sm shadow-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appraiser Declaration"}),e.jsxs("select",{name:"declaration",value:a.declaration,className:"w-full border border-gray-300 rounded-md p-2 text-sm shadow-sm",onChange:d,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"0",children:"Agree"}),e.jsx("option",{value:"1",children:"Disagree"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx(z,{size:"sm",placeholder:"Pick a date",value:a.date,onChange:i})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(H,{variant:"solid",onClick:h,children:"Submit"})})]}),b&&e.jsx(q,{hrInfo:b})]})},ae=({apprisee:t,appraiser:s})=>{const a=l=>l||"-";return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-3 bg-green-600 rounded-lg shadow-md mb-2",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"SECTION 1: (PERSONAL INFORMATION)"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-3 border-2 rounded-lg shadow-sm bg-white w-full",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Apprisee Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"First Name:"})," ",a(t.F_Name)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Middle Name:"})," ",a(t.M_Name)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Last Name:"})," ",a(t.L_Name)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Role:"})," ",a(t.role)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"IPPIS No.:"})," ",a(t.ippis_no)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Email:"})," ",a(t.email)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Phone:"})," ",a(t.phone)]})]})]}),e.jsxs("div",{className:"p-4 border-2 rounded-lg shadow-sm bg-white w-full",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Appraiser Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"First Name:"})," ",a(s.F_Name)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Middle Name:"})," ",a(s.M_Name)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Last Name:"})," ",a(s.L_Name)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Role:"})," ",a(s.role)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"IPPIS No.:"})," ",a(s.ippis_no)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Email:"})," ",a(s.email)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-extrabold",children:"Phone:"})," ",a(s.phone)]})]})]})]})]})},re=()=>{const{id:t}=P(),[s,a]=c.useState(null),[l,r]=c.useState(!0),[N,b]=c.useState(null),f=c.useCallback(async()=>{var u;try{r(!0),b(null);const m=localStorage.getItem("selectedDepartmentID")||"",v=localStorage.getItem("selectedTeamID"),w=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),j=await Z(m,v?Number(v):null,w,String(t));if((u=j==null?void 0:j.data)!=null&&u.data)a(j.data.data);else throw new Error("Invalid response data")}catch(m){console.error("Error fetching data:",m),b("Failed to load data. Please try again.")}finally{r(!1)}},[t]);return c.useEffect(()=>{f()},[f]),l?e.jsx("div",{children:"Loading..."}):N?e.jsxs("div",{className:"text-red-500",children:[N," ",e.jsx("button",{className:"ml-2 text-blue-500 underline",onClick:f,children:"Retry"})]}):!s||s.length===0?e.jsx("div",{children:"No data available."}):e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-2",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"SECTION 3: IMPROVEMENT PLAN AND GOAL(S) List out the specific actions to be taken to address the areas of concerns listed above and the desired results and goals to be attained by the appraisee in each area"})}),e.jsxs(O,{className:"w-full border border-gray-300 text-sm",children:[e.jsx(G,{children:e.jsxs(L,{className:"bg-gray-300",children:[e.jsx(I,{className:"border p-2 w-10",children:"#"}),e.jsx(I,{className:"border p-2",children:"Area(s) of Needed Improvement"}),e.jsx(I,{className:"border p-2",children:"Activities Planned to Improve Performance"}),e.jsx(I,{className:"border p-2",children:"Support/Resources to be Provided"})]})}),e.jsx(U,{children:s.map((u,m)=>e.jsxs(L,{children:[e.jsx(D,{className:"border p-2 text-center",children:m+1}),e.jsx(D,{className:"border p-2",children:u.areas_of_needed_improvement}),e.jsx(D,{className:"border p-2",children:u.activities_planned_to_improve_performance}),e.jsx(D,{className:"border p-2",children:u.support_resources_to_be_provided})]},m))})]})]})},{Tr:C,Th:F,Td:Y,THead:ne,TBody:oe}=O,le=()=>{const{id:t}=P(),[s,a]=c.useState([]),[l,r]=c.useState(!1),[N,b]=c.useState(!0),[f,u]=c.useState(null),m={areas_of_needed_improvement:"",activities_planned_to_improve_performance:"",support_resources_to_be_provided:""},v=async()=>{var d,i,h;try{b(!0);const n=localStorage.getItem("selectedDepartmentID")||"",p=localStorage.getItem("selectedTeamID"),x=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),g=await Q(n,p?Number(p):null,x,String(t));if((i=(d=g==null?void 0:g.data)==null?void 0:d.data)!=null&&i.length){const y=g.data.data,_=Array.from({length:5-y.length},()=>({...m}));a([...y,..._])}else throw new Error("No data found.")}catch(n){((h=n.response)==null?void 0:h.status)===404?a(Array.from({length:5},()=>({...m}))):u("Failed to load data. Please try again.")}finally{b(!1)}};c.useEffect(()=>{v()},[]);const w=(d,i,h)=>{const n=[...s];n[d][i]=h,a(n)},j=async()=>{if(l)return;r(!0);const d=localStorage.getItem("selectedDepartmentID")||"",i=localStorage.getItem("selectedTeamID"),h=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),n=s.filter(x=>x.areas_of_needed_improvement.trim()||x.activities_planned_to_improve_performance.trim()),p={department_id:d,team_id:i,year:h,staff_id:t,improvement_plan_goals:n};try{if((await X(p)).status===201){E.push(e.jsx(A,{title:"Success",type:"success",children:"Data added successfully!"}),{placement:"top-center"});const g=Array.from({length:5-n.length},()=>({...m}));a([...n,...g])}}catch{E.push(e.jsx(A,{title:"Error",type:"danger",children:"Something went wrong. Please try again."}),{placement:"top-center"})}finally{setTimeout(()=>{r(!1)},4e3)}};return N?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3 bg-green-700 rounded-lg shadow-md mb-2",children:e.jsx("h4",{className:"text-white font-semibold text-sm",children:"SECTION 2: AREA (S) OF CONCERN Your performance appraisal results indicate that your performance on agreed targets have been unsatisfactory and far below the required standards set for your job position. Based on this, you have been issued with this Performance Improvement Plan to help you work on the critical areas indicated below"})}),e.jsxs(O,{className:"w-full border border-gray-300 text-sm",children:[e.jsx(ne,{children:e.jsxs(C,{className:"bg-gray-300",children:[e.jsx(F,{className:"font-semibold border p-2 w-10",children:"#"}),e.jsx(F,{className:"font-semibold border p-2",children:"Area(s) of Needed Improvement"}),e.jsx(F,{className:"font-semibold border p-2",children:"Activities Planned to Improve Performance"})]})}),e.jsx(oe,{children:f?e.jsx(C,{children:e.jsx(Y,{colSpan:2,children:f})}):s.map((d,i)=>e.jsxs(C,{children:[e.jsx(Y,{className:"border text-center",children:i+1}),["areas_of_needed_improvement","activities_planned_to_improve_performance"].map(h=>e.jsx(Y,{className:"border",children:e.jsx("input",{type:"text",value:d[h],className:"w-full border-none outline-none p-1",onChange:n=>w(i,h,n.target.value)})},h))]},i))})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(H,{variant:"solid",disabled:l||s.length===0,onClick:j,children:l?"Submitting...":"Submit Data"})})]})},ye=()=>{const{id:t}=P(),[s,a]=c.useState(null),[l,r]=c.useState(!0),[N,b]=c.useState(null);if(c.useEffect(()=>{(async()=>{try{const d=localStorage.getItem("selectedDepartmentID")||"",i=localStorage.getItem("selectedTeamID"),h=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),n=await K(d,i?Number(i):null,h,String(t));if(n&&n.data)a(n.data);else throw new Error("Invalid response data")}catch(d){console.error("Error fetching data:",d),b("Failed to load data. Please try again.")}finally{r(!1)}})()},[t]),l)return e.jsx("div",{children:e.jsx(W,{loading:!0})});if(N)return e.jsx("div",{className:"text-red-500",children:N});if(!s)return e.jsx("div",{children:"No data available"});const{department:f,team:u,supervisor:m,staff:v}=s,w=(j,d)=>{const i=j.split(" ");return i.slice(0,d).join(" ")+(i.length>d?"...":"")};return e.jsxs("div",{className:"space-y-5 min-h-screen",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("img",{src:"/img/logo/new-logo education.png",className:"h-16 w-48"}),e.jsx("p",{className:"text-lg text-black font-bold",children:"(Performance Improvement Plan)"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row items-end lg:items-center gap-4 lg:gap-8 text-right lg:text-left",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-black",children:u.team_name}),e.jsx("p",{className:"text-grey-600",children:w(u.team_description,5)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-black",children:f.department_name}),e.jsx("p",{className:"text-grey-600",children:w(f.department_description,5)})]})]})]}),e.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"p-4",children:e.jsx(J,{})}),e.jsx("div",{className:"p-4",children:e.jsx(V,{})})]}),e.jsx("section",{children:e.jsx(ae,{apprisee:v,appraiser:m})}),e.jsx("section",{children:e.jsx(le,{})}),e.jsx("section",{children:e.jsx(re,{})}),e.jsx("section",{children:e.jsx(se,{})})]})};export{ye as default};

import{r as i,j as e,p as P,W as C,$ as E,v as I,a as L,u as T,q as A}from"./index-Cmv4Hw-4.js";import"./FormContainer-HIBjkHQl.js";import{C as u}from"./Tag-DkH2MdpA.js";import"./hoist-non-react-statics.cjs-BTbAOH4E.js";import{P as w,b as M}from"./Upload-Bjo3S9Ma.js";import"./Select-C1b3zJA4.js";import"./toast-BR7ZoxZ1.js";import{K as U}from"./Views-D5a-j2rV.js";import"./SvgIcon-YlnLBm2p.js";import{U as k}from"./UsersAvatarGroup-Dd8350s6.js";import{d as F}from"./Department-BVOBRPHm.js";import"./index-Ddnay0b-.js";import"./quill.snow-Do1d7lnz.js";import"./cloneDeep-DznBgb_t.js";import"./useThemeClass-Bdyjo5Qx.js";import"./acronym-BqE2GpXs.js";const O=({progression:a,departmentData:n})=>{const[o,t]=i.useState(new Date),[c,m]=i.useState(!1);i.useEffect(()=>{t(new Date)},[]);const s=n.description.split(" "),x=s.length>65,h=c?n.description:s.slice(0,65).join(" ")+(x?"...":""),l=()=>{m(!c)};return e.jsx("div",{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs(u,{className:"md:col-span-2 bg-[#018752]",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h4",{className:"mb-4 lg:mb-0 text-white",children:n.name})}),e.jsxs("div",{className:"mt-2 text-white",children:[h,x&&e.jsx("button",{className:"text-blue-500 underline ml-2",onClick:l,children:c?"See less":"See more"})]})]}),e.jsxs("div",{className:"flex justify-end mt-2 text-sm text-gray-600",children:[e.jsx("div",{className:"mr-2 font-semibold text-gray-200 italic",children:"Last Update:"}),e.jsx("div",{className:"text-white",children:o.toLocaleDateString()})]})]}),e.jsx(u,{className:"bg-[#018752] ",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-white",children:"Progression"}),e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(w,{variant:"circle",percent:a,width:90,strokeWidth:4})})]})})]})})},f=({progression:a})=>{const[n,o]=i.useState(!1),t=i.useMemo(()=>a>70?{color:"green-500"}:a<40?{color:"red-500"}:{},[a]);return e.jsxs("div",{className:"relative w-full",children:[n&&e.jsxs("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 px-2 py-1 text-xs text-white bg-gray-800 rounded-lg shadow-lg whitespace-nowrap",role:"tooltip",children:["Overall Progress",e.jsx("div",{className:"absolute bottom-[-4px] left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-800 rotate-45"})]}),e.jsx("div",{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:e.jsx(w,{size:"sm",percent:a,...t})})]})},z=({members:a})=>e.jsx(k,{users:a}),W=({departmentData:a=[],loading:n=!1})=>{var p;const o=P(),[t,c]=i.useState(null),[m,s]=i.useState(window.innerWidth<=1024);if(i.useEffect(()=>{const r=()=>{s(window.innerWidth<=1024)};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),n)return e.jsx("p",{children:"Loading teams..."});if(a.length===0)return e.jsx("p",{children:"No teams assigned to this department."});const x=(r,d)=>{localStorage.setItem("selectedTeamID",r.toString()),o(`/officer/memberlist/${d}`)},h=r=>{c(r)},l=()=>{c(null)};return e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-xl font-semibold mb-4",children:"Associate with Teams"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:a.map(r=>{const{team_id:d,name:g,description:j,progresive:v,user_count:N,team_assign_users:b}=r,y=C(d.toString()),S=g.split(" ").slice(0,5).join(" "),D=j.split(" ").slice(0,15).join(" ");return e.jsx(u,{className:"shadow-sm h-full bg-[#018752] hover:bg-green-900 hover:-translate-y-1 transition-all duration-300 cursor-pointer",onClick:()=>x(d,y),children:e.jsxs("div",{className:"flex flex-col justify-between h-full",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx("div",{className:"text-lg font-bold text-white",children:S})}),e.jsxs("p",{className:"mt-2 text-white",children:[D,j.split(" ").length>15&&e.jsxs(e.Fragment,{children:["...",e.jsx("button",{className:"ml-2 text-blue-500 underline",onClick:_=>{_.stopPropagation(),h(r)},children:"View All"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(f,{progression:v}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx(z,{members:b}),e.jsxs("div",{className:"flex items-center px-2 py-1 border border-gray-300 rounded-full cursor-pointer bg-white",children:[e.jsx(U,{className:"text-base"}),e.jsx("span",{children:N})]})]})]})]})},d)})}),t&&e.jsx(M,{title:"Team Details",isOpen:!!t,placement:"right",width:m?"100%":600,onClose:l,children:e.jsxs("div",{className:"p-6 bg-gray-300 rounded-md shadow-md",children:[e.jsx("h6",{className:"text-xl font-bold text-gray-800",children:t.name}),e.jsx("p",{className:"mt-3 text-gray-600 leading-relaxed",children:t.description}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h6",{className:"text-lg font-medium text-gray-700",children:"Progress"}),e.jsx(f,{progression:t.progresive})]}),((p=t.team_assign_users)==null?void 0:p.length)>0?e.jsxs("div",{className:"mt-6",children:[e.jsx("h6",{className:"text-lg font-medium text-gray-700",children:"Assigned Users"}),e.jsx("ul",{className:"mt-3 space-y-2",children:t.team_assign_users.map(r=>e.jsxs("li",{className:"flex items-center space-x-3 bg-white p-3 rounded-md shadow-sm border border-gray-200 hover:shadow-md transition-all",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-500 flex items-center justify-center text-white font-semibold",children:r.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"text-gray-800 font-medium",children:r.name})]},r.name))})]}):e.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"No users assigned to this team."})]})})]})},re=()=>{var h;const{encryptedID:a}=E(),n=I(a||""),o=L(),t=T(l=>l.department.departments),[c,m]=i.useState(!0),[s,x]=i.useState(null);return i.useEffect(()=>{const l=async()=>{var r;const p=localStorage.getItem("selectedYear")||new Date().getFullYear().toString();try{m(!0);const g=((r=(await F(p)).data)==null?void 0:r.department_details)||[];o(A(g))}catch(d){console.error("Failed to fetch departments:",d)}finally{m(!1)}};t.length===0?l():m(!1)},[t.length,o]),i.useEffect(()=>{if(t.length>0){const l=t.find(p=>p.department_id===n);l?x(l):console.warn(`No department found for depID: ${n}`)}},[t,n]),e.jsxs("div",{children:[e.jsx(O,{progression:(s==null?void 0:s.progresive)||0,departmentData:{name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||""}}),c?e.jsx("p",{children:"Loading..."}):(h=s==null?void 0:s.teams_assigned)!=null&&h.length?e.jsx(W,{departmentData:s.teams_assigned,loading:!1}):e.jsx("p",{children:"No teams available"})]})};export{re as default};

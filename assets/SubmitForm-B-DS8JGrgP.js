import{aQ as ie,aM as me,j as e,aR as xe,a as z,r as i,u as M,aU as ge,aV as ue,a2 as ce,aW as he,a0 as B,$ as Y,p as pe}from"./index-CdXcW46_.js";import{T as de,b as U,e as be}from"./Upload-CkxX527j.js";import{C as fe,b as f}from"./Tag-BIrPdKNG.js";/* empty css               */import{B as $,I as k}from"./hoist-non-react-statics.cjs-BYdDfNAW.js";import{ae as G,af as je,R as Ne,ag as ye,J as ve}from"./Views-YlTiOC4j.js";import"./FormContainer-B5i-gxwG.js";import{S as K}from"./Select-epRO6R5x.js";import{t as I,N as O}from"./toast-DnPvOHpm.js";import{S as we,h as Se}from"./html2canvas.esm-G4AsU0nj.js";import{g as Te}from"./Evidence-DfVwVGI_.js";import{F as De,H as Ee,I as Ce}from"./FooterButtonpart-BY3ZRglS.js";import"./index-8ORoQwk5.js";import"./index-GRSH0cfX.js";const{TabNav:Q,TabList:_e}=de,Ie=()=>{const r=ie(),s=me(c=>c.quaterTab.selectedQuarter),a=c=>{r(xe(c))};return e.jsx("div",{children:e.jsx(fe,{className:"bg-gray-50 card-body-padding mt-8",children:e.jsx(de,{value:s,variant:"pill",onChange:a,children:e.jsxs(_e,{children:[e.jsx(Q,{value:"1",className:`${s==="1"?"bg-green-700 text-white":""}`,children:"First Quarter"}),e.jsx(Q,{value:"2",className:`${s==="2"?"bg-green-700 text-white":""}`,children:"Second Quarter"}),e.jsx(Q,{value:"3",className:`${s==="3"?"bg-green-700 text-white":""}`,children:"Third Quarter"}),e.jsx(Q,{value:"4",className:`${s==="4"?"bg-green-700 text-white":""}`,children:"Fourth Quarter"})]})})})})},{Tr:H,Th:Oe,Td:b,THead:ke,TBody:Ae}=f,Me=({employee_task:r})=>{const s=z(),[a,c]=i.useState([]),[d,m]=i.useState({weightSum:0,gradeWeightSum:0,quarterMarksSum:0}),o=M(n=>n.quaterTab.selectedQuarter);return i.useEffect(()=>{const n=(r[o]||[]).map(l=>({selectedKRA:l.kra_name,weight:l.kra_weight,rows:l.objectives.map(t=>({selectedObjective:t.objective_name,gradeWeight:t.gradeed_weight,selectedKPI:t.kpi,unitOfMeasurement:t.unit,targetSet:t.target,targetAchieved:t.target_achieved,raw:t.raw,weighted:t.weighted,score:t.quater_markes}))}));c(n)},[o,r]),i.useEffect(()=>{const n=(r[o]||[]).reduce((x,h)=>x+(h.kra_weight||0),0),l=(r[o]||[]).reduce((x,h)=>x+h.objectives.reduce((p,y)=>p+(y.gradeed_weight||0),0),0),t=(r[o]||[]).reduce((x,h)=>x+h.objectives.reduce((p,y)=>p+(y.quater_markes||0),0),0);m({weightSum:n,gradeWeightSum:l,quarterMarksSum:t}),s(ge(t))},[o,r]),e.jsx("div",{className:"mt-2",children:e.jsxs(f,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(ke,{children:e.jsx(H,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Grade Weight","KPIs","Unit of Measurement","Target Set","Target Achieved","Quater Markes","Raw","Weighted"].map((n,l)=>e.jsx(Oe,{className:"border border-gray-400 p-2",children:n},l))})}),e.jsxs(Ae,{children:[a.map((n,l)=>n.rows.map((t,x)=>e.jsxs(H,{children:[x===0&&e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"border border-gray-400 text-center",rowSpan:n.rows.length,children:l+1}),e.jsx(b,{className:"border border-gray-400",rowSpan:n.rows.length,children:n.selectedKRA}),e.jsx(b,{className:"border border-gray-400 text-center",rowSpan:n.rows.length,children:n.weight})]}),e.jsx(b,{className:"border border-gray-400 break-all",children:t.selectedObjective}),e.jsx(b,{className:"border border-gray-400 text-center",children:t.gradeWeight}),e.jsx(b,{className:"border border-gray-400",children:t.selectedKPI}),e.jsx(b,{className:"border border-gray-400 text-center",children:t.unitOfMeasurement}),e.jsx(b,{className:"border border-gray-400 text-center",children:t.targetSet}),e.jsx(b,{className:"border border-gray-400 text-center",children:t.targetAchieved}),e.jsx(b,{className:"border border-gray-400 text-center",children:t.score}),e.jsx(b,{className:"border border-gray-400 text-center",children:t.raw}),e.jsx(b,{className:"border border-gray-400 text-center",children:t.weighted})]},`${l}-${x}`))),e.jsxs(H,{className:"font-semibold bg-gray-100",children:[e.jsx(b,{className:"border border-gray-400 text-center",colSpan:2,children:"Total"}),e.jsx(b,{className:"border border-gray-400 text-center",children:Math.round(d.weightSum)}),e.jsx(b,{colSpan:1,className:"border border-gray-400 text-center"}),e.jsx(b,{className:"border border-gray-400 text-center",children:Math.round(d.gradeWeightSum)}),e.jsx(b,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(b,{colSpan:3,className:"border border-gray-400 text-center",children:d.quarterMarksSum.toFixed(2)})]})]})]})})},{Tr:V,Th:J,Td:X,THead:$e,TBody:Fe}=f,Pe=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],Re=()=>{const[r,s]=i.useState(!1),[a,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const o=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const d=()=>s(!0),m=()=>s(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx($,{variant:"twoTone",size:"xs",icon:e.jsx(G,{}),"aria-label":"View Scoring Criteria Values",onClick:d,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(U,{title:"Scoring Criteria",isOpen:r,placement:"right",width:a?"100%":800,onClose:m,onRequestClose:m,children:e.jsxs(f,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx($e,{children:e.jsxs(V,{className:"bg-gray-100",children:[e.jsx(J,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(J,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(Fe,{children:Pe.map((o,n)=>e.jsxs(V,{children:[e.jsx(X,{className:"border border-gray-300 p-2",children:o.grade}),e.jsx(X,{className:"border border-gray-300 p-2",children:o.description})]},n))})]})})]})},{Tr:Z,Th:ee,Td:re,THead:qe,TBody:Qe}=f,Be=({isOpen:r,setIsOpen:s})=>{const[a,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const m=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const d=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."},{id:5,title:"Unsatisfactory (1)",desc:"Performance failed to meet expectations on agreed target(s) and on most critical parameters; definite and significant corrective action needs to be taken immediately."},{id:6,title:"Not Applicable (N/A):",desc:"The activity(s) is not being carried out within the Assessment Quarter."}];return e.jsx(U,{isOpen:r,title:"Performance Rating Scale",width:a?"100%":750,onClose:()=>s(!1),children:e.jsxs(f,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(qe,{children:e.jsxs(Z,{className:"bg-gray-100",children:[e.jsx(ee,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(ee,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(Qe,{children:d.map(m=>e.jsxs(Z,{children:[e.jsx(re,{className:"border border-gray-300 p-2",children:m.title}),e.jsx(re,{className:"border border-gray-300 p-2",children:m.desc})]},m.id))})]})})},He=()=>{const[r,s]=i.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx($,{variant:"twoTone",size:"xs",icon:e.jsx(G,{}),onClick:()=>s(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(Be,{isOpen:r,setIsOpen:s})]})},{Tr:L,Th:_,Td:w,THead:Le,TBody:We}=f,ze=({competencies:r})=>{const s=z(),a=M(n=>n.quaterTab.selectedQuarter),c=r[a],d=c.reduce((n,l)=>n+l.competencies_details.reduce((t,x)=>t+x.max_score,0),0),m=c.reduce((n,l)=>n+l.competencies_details.reduce((t,x)=>t+x.quarter_marks,0),0),o=d>0?m/d*20:0;return s(ue(o)),e.jsx("div",{className:"border overflow-hidden shadow-sm",children:e.jsxs(f,{compact:!0,className:"w-full bg-white",children:[e.jsx(Le,{children:e.jsxs(L,{className:"bg-gray-200",children:[e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(_,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Quater Marks"})]})}),e.jsxs(We,{className:"divide-y divide-gray-200",children:[c.map(n=>e.jsx(ce.Fragment,{children:n.competencies_details.map((l,t)=>e.jsxs(L,{children:[t===0&&e.jsx(w,{className:"px-4 py-3 align-top font-semibold border border-gray-400",rowSpan:n.competencies_details.length,children:n.competencies}),e.jsx(w,{className:"px-4 py-3 border border-gray-400",children:l.cluster}),e.jsx(w,{className:"px-4 py-3 border border-gray-400",children:l.sub_cluster}),e.jsx(w,{className:"px-4 py-3 border border-gray-400",children:l.describe_expectations}),e.jsx(w,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:l.max_score}),e.jsx(w,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:l.min_score}),e.jsx(w,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:l.quarter_marks})]},t))},n.id)),e.jsxs(L,{className:"font-semibold bg-gray-100",children:[e.jsx(w,{className:"border border-gray-400 text-center",colSpan:4}),e.jsx(w,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(w,{colSpan:2,className:"border border-gray-400 text-center",children:o.toFixed(2)})]})]})]})})},{Tr:P,Th:se,Td:D,THead:Ye,TBody:Ue}=f,Ge=()=>{const[r,s]=i.useState(!1),[a,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const o=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const d=()=>{s(!0)},m=o=>{console.log("onDrawerClose",o),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx($,{variant:"twoTone",size:"xs",icon:e.jsx(G,{}),onClick:()=>d(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(U,{title:"Performance Rating Scale  ",isOpen:r,width:a?"100%":750,onClose:m,onRequestClose:m,children:e.jsxs(f,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(Ye,{children:e.jsxs(P,{className:"bg-gray-100",children:[e.jsx(se,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(se,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs(Ue,{children:[e.jsxs(P,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(P,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(P,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(P,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:W,Th:R,Td:E,THead:Ke,TBody:Ve}=f,Je=({operation_and_process:r})=>{const s=z(),a=M(n=>n.quaterTab.selectedQuarter),c=r[a]||[],d=c.reduce((n,l)=>n+l.details.reduce((t,x)=>t+x.max_score,0),0),m=c.reduce((n,l)=>n+l.details.reduce((t,x)=>t+x.quarter_marks,0),0),o=d>0?m/d*10:0;return s(he(o)),e.jsxs(f,{compact:!0,className:"table-auto border-collapse border border-gray-400 w-full bg-white",children:[e.jsx(Ke,{children:e.jsxs(W,{className:"bg-gray-200",children:[e.jsx(R,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx(R,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx(R,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx(R,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx(R,{className:"border border-gray-400 p-2 text-center",children:"Quarter Marks"})]})}),e.jsxs(Ve,{children:[c.map((n,l)=>e.jsx(ce.Fragment,{children:n.details.map((t,x)=>e.jsxs(W,{children:[x===0&&e.jsx(E,{className:"border border-gray-400 p-2 font-bold",rowSpan:n.details.length,children:n.operations_and_process}),e.jsx(E,{className:"border border-gray-400 p-2",children:t.describe_expectations}),e.jsx(E,{className:"border border-gray-400 p-2 text-center",children:t.min_score}),e.jsx(E,{className:"border border-gray-400 p-2 text-center",children:t.max_score}),e.jsx(E,{className:"border border-gray-400 p-2 text-center",children:t.quarter_marks})]},x))},l)),e.jsxs(W,{className:"font-semibold bg-gray-100",children:[e.jsx(E,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(E,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(E,{colSpan:2,className:"border border-gray-400 text-center",children:o.toFixed(2)})]})]})]})},Xe=async(r,s,a,c,d)=>{try{return await B({url:`/officer/form_b?department_id=${r}&team_id=${s}&year=${a}&staff_id=${d}&quater=${c}`,method:"get"})}catch(m){throw console.error("Error fetching information data:",m),m}},Ze=async(r,s,a,c)=>{try{return await B({url:`/officer/form_b_comments?department_id=${r}&team_id=${s}&year=${a}&staff_id=${c}`,method:"get"})}catch(d){throw console.error("Error fetching information data:",d),d}},er=async r=>{try{return await B({url:"/officer/form_b_comments",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},rr=async r=>{try{return await B({url:"/officer/submit_of_overall_assesment",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},{Tr:te,Th:ae,Td:ne,THead:sr,TBody:tr}=f,ar=()=>{const{id:r}=Y(),s=M(l=>l.quaterTab.selectedQuarter),{quarterMarksSum:a,competencyMarks:c,oprationMarks:d}=M(l=>l.assesment),m=a+c+d,o=[{label:"Sub-total rating of appraisee performance (Expectations and Goals from Section 3)",value:a.toFixed(3)},{label:"Sub-total rating of appraisee performance (Competencies) in Section 4",value:c.toFixed(3)},{label:"Sub-total rating of appraisee performance (Operations and Processes) in Section 5",value:d.toFixed(3)},{label:"Overall Rating (Section 3 + 4 + 5)",value:m.toFixed(3)}],n=async()=>{var t,x;const l={staff_id:String(r),department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),quater:s,sub_total_rating_expectations:a,sub_total_rating_competencies:c,sub_total_rating_operations:d,overall_rating:m};try{(await rr(l)).status===200?I.push(e.jsx(O,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):I.push(e.jsx(O,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(h){const p=((x=(t=h.response)==null?void 0:t.data)==null?void 0:x.error)||h.message||"An unexpected error occurred.";I.push(e.jsx(O,{title:"Error",type:"danger",children:p}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 6: Summary of Overall Assessment (10%)"})}),e.jsxs(f,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left bg-white",children:[e.jsx(sr,{children:e.jsxs(te,{className:"bg-gray-100",children:[e.jsx(ae,{className:"border border-gray-300 p-2",children:"Overall Assessment"}),e.jsx(ae,{className:"border border-gray-300 p-2 text-center",children:"Appraiser Rating"})]})}),e.jsx(tr,{children:o.map((l,t)=>e.jsxs(te,{children:[e.jsx(ne,{className:"border border-gray-300 p-2",children:l.label}),e.jsx(ne,{className:"border border-gray-300 p-2 text-center",children:l.value??"-"})]},t))})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx($,{variant:"solid",color:"green-700",onClick:n,children:"Submit Assessment Point"})})]})},nr=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 7 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),lr=({comments:r,onOfficerCommentChange:s,showValidationError:a,commentInputRef:c})=>{var n,l;const[d,m]=i.useState("");i.useEffect(()=>{var x;const t=((x=r.officer)==null?void 0:x.comment)||"";m(t),s(t)},[(n=r.officer)==null?void 0:n.comment,s]);const o=t=>{const x=t.target.value;m(x),s(x)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(k,{disabled:!0,textArea:!0,value:((l=r.supervisor)==null?void 0:l.comment)||"",className:"input-textarea mt-2"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(k,{disabled:!0,textArea:!0,value:r.supervisor.comment||"",className:"input-textarea mt-2"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx(k,{required:!0,ref:c,textArea:!0,value:d,placeholder:"Enter your comments here",className:`textarea mt-2 w-full rounded-md border px-3 py-2 focus:outline-none ${a&&!d?"border-red-500":"border-gray-300"}`,onChange:o}),a&&!d&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(je,{className:"mr-1"}),"This field is required."]})]})]})},cr=({Supervisor:r})=>{const s=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],a=s.find(c=>c.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraisee's Declaration :"}),e.jsx(K,{isDisabled:!0,id:"declaration",value:a,options:s,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(k,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraisee's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},dr=({staff:r})=>{const s=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],a=s.find(c=>c.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(K,{isDisabled:!0,id:"declaration",value:a,options:s,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(k,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraiser's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraiser"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},le=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],or=({officer:r,onChange:s})=>{const[a,c]=i.useState(null),[d,m]=i.useState(null),[o,n]=i.useState(null),[l,t]=i.useState(null),[x,h]=i.useState(!1),[p,y]=i.useState(0),A=i.useRef(null),v=i.useRef(null),C=i.useRef(null);i.useEffect(()=>{r&&(c(r.declaration),n(r.signature),m(r.date?new Date(r.date):null),y((r.signature,0)))},[r]);const F=g=>{var S;const u=(S=g.target.files)==null?void 0:S[0];if(u){if(u.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!u.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const T=new FileReader;T.onloadend=()=>{const oe=T.result;n(oe),t(u.name),y(1)},T.readAsDataURL(u)}},q=()=>{h(!0)},j=async()=>{if(v.current&&!v.current.isEmpty()){if(C.current){const u=(await Se(C.current)).toDataURL("image/png");n(u),y(1),h(!1)}}else alert("Please draw a signature before saving.")},N=()=>{var g;(g=v.current)==null||g.clear()};return i.useEffect(()=>{const g=d!==null?new Date(d.getFullYear(),d.getMonth(),d.getDate()+1):null,u={declaration:a,date:g,flag:p};p===1&&(u.signature=o),s(u)},[a,d,o,p]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Declaration:"}),e.jsx(K,{placeholder:"Please Select",options:le,className:"mt-2",value:le.find(g=>g.value===a),onChange:g=>c((g==null?void 0:g.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(be,{className:"mt-2",value:d,onChange:g=>m(g)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:q,children:[e.jsx(Ne,{className:"w-5 h-5"}),"Add Signature"]}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:()=>{var g;return(g=A.current)==null?void 0:g.click()},children:[e.jsx(ye,{className:"w-5 h-5"}),"Upload"]}),e.jsx("input",{ref:A,type:"file",accept:"image/*",className:"hidden",onChange:F})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),o&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:o,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>h(!1),children:e.jsx(ve,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:C,className:" rounded-md mt-4 bg-white",children:e.jsx(we,{ref:v,canvasProps:{width:330,height:150,className:"sigCanvas"}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx($,{size:"sm",variant:"default",onClick:N,children:"Clear"}),e.jsx($,{size:"sm",variant:"solid",onClick:j,children:"Save"})]})]})})]})},ir=({submittedEvidence:r})=>{if(!r||r.length===0)return e.jsx("p",{className:"text-gray-500",children:"No submitted evidence available."});const s=async a=>{try{const d=(await Te(a)).data,m=URL.createObjectURL(d);window.open(m,"_blank")}catch(c){console.error("Error fetching evidence data:",c)}};return e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Submitted Evidence:"}),e.jsx("div",{className:"flex flex-col gap-4",children:r.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"text-blue-600 underline max-w-[250px] truncate cursor-pointer",onClick:()=>s(a.evidence_id),children:a.evidence_id}),e.jsx("div",{className:"flex-1 text-right",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:[e.jsx("strong",{children:"Created:"})," ",new Date(a.created_at).toLocaleDateString()]})})]},a.id))})]})},mr=()=>{const{id:r}=Y(),s=pe(),[a,c]=i.useState(null),[d,m]=i.useState(!0),[o,n]=i.useState(null),[l,t]=i.useState(""),[x,h]=i.useState(!1),[p,y]=i.useState({declaration:null,date:null,signature:null,flag:0}),A=async()=>{try{const j=localStorage.getItem("selectedDepartmentID")||"",N=localStorage.getItem("selectedTeamID"),g=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),u=await Ze(j,N?Number(N):null,g,String(r));if(u&&u.data)c(u.data);else throw new Error("Invalid response data")}catch(j){console.error("Error fetching data:",j),n("Failed to load data. Please try again.")}finally{m(!1)}};i.useEffect(()=>{A()},[]);const v=i.useRef(null),C=async()=>{var j,N,g;if(!l.trim()){h(!0),(j=v.current)==null||j.scrollIntoView({behavior:"smooth",block:"center"}),I.push(e.jsx(O,{title:"Error",type:"danger",children:"Appraisee's Comments is required"}),{placement:"top-center"});return}h(!1);try{const u=p.date instanceof Date?p.date.toISOString().split("T")[0]:null,S={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),staff_id:r,comment:l,date:u,signature:p.signature,declaration:p.declaration,flag:p.flag};(await er(S)).status===200?I.push(e.jsx(O,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):I.push(e.jsx(O,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(u){const S=((g=(N=u.response)==null?void 0:N.data)==null?void 0:g.error)||u.message||"An unexpected error occurred.";I.push(e.jsx(O,{title:"Error",type:"danger",children:S}),{placement:"top-center"}),console.error("Error submitting data:",u)}},F=()=>{s(-1)},q=()=>{s(`/form/officer/annual-review/${r}`)};return d?e.jsx("div",{children:"Loading..."}):o?e.jsx("div",{className:"text-red-500",children:o}):a?e.jsxs("div",{className:"mt-4 mx-auto w-full",children:[e.jsx(nr,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(ir,{submittedEvidence:a.comments.staff.evidence||[]})}),e.jsx("div",{className:"mt-4",children:e.jsx(lr,{commentInputRef:v,comments:{staff:a.comments.staff||{comment:""},supervisor:a.comments.supervisor||{comment:""},officer:a.comments.officer||{comment:""}},showValidationError:x,onOfficerCommentChange:t})}),e.jsx("div",{className:"mt-4",children:e.jsx(cr,{Supervisor:a.comments.supervisor})}),e.jsx("div",{className:"mt-4",children:e.jsx(dr,{staff:a.comments.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(or,{officer:a.comments.officer,onChange:j=>y(j)})})]}),e.jsx(De,{back:"Back",handleBack:F,save:"Save",handleSave:C,next:"Next",handleNext:q})]}):e.jsx("div",{children:"No data available."})},xr=({assesment:r,improvement:s})=>e.jsxs("div",{children:[e.jsx("div",{className:"mt-2",children:e.jsx(k,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:r||"What are the employee’s strengths?"})}),e.jsx("div",{className:"mt-2",children:e.jsx(k,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:s||"What are the employee’s areas for improvement?"})})]}),Er=()=>{const{id:r}=Y(),s=M(N=>N.quaterTab.selectedQuarter),[a,c]=i.useState(null),[d,m]=i.useState(!0),[o,n]=i.useState(null),l=async()=>{try{const N=localStorage.getItem("selectedDepartmentID")||"",g=localStorage.getItem("selectedTeamID"),u=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),S=r,T=await Xe(N,g?Number(g):null,u,s,String(S));if(T&&T.data)c(T.data);else throw new Error("Invalid response data")}catch(N){console.error("Error fetching data:",N),n("Failed to load data. Please try again.")}finally{m(!1)}};if(i.useEffect(()=>{l()},[]),d)return e.jsx("div",{children:"Loading..."});if(o)return e.jsx("div",{className:"text-red-500",children:o});const{department:t,team:x,supervisor:h,officer:p,staff:y,progress:A,employee_task:v,competencies:C,operation_and_process:F,overall_assesment:q,others:j}=a||{};return e.jsxs("div",{children:[e.jsx(Ee,{department:t,team:x,progress:A,title:"PERFORMANCE APPRAISAL",downloadButton:!1,staffID:r}),y&&h&&p&&e.jsx(Ce,{staff:y,supervisor:h,officer:p}),e.jsx(Ie,{}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Re,{}),v&&e.jsx(Me,{employee_task:v})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(He,{}),e.jsx(ze,{competencies:C})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Ge,{}),e.jsx(Je,{operation_and_process:F})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ar,{}),e.jsx(xr,{assesment:j.strengths,improvement:j.improvement})]}),e.jsx(mr,{})]})};export{Er as default};

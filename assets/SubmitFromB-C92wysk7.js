import{r as m,j as e,a0 as Y,a as be,$ as W,u as U,aU as Ne,aQ as fe,aV as ve,a2 as je,aW as we,aM as Se,aR as Te,p as Ee}from"./index-Cmv4Hw-4.js";import{F as De,H as _e,I as Ce}from"./FooterButtonpart-ZWl7nWlS.js";import{B as A,I as O}from"./hoist-non-react-statics.cjs-BTbAOH4E.js";import{b as X,T as ye,e as Ie}from"./Upload-Bjo3S9Ma.js";import{ae as Z,af as le,R as ke,ag as Fe,J as $e}from"./Views-D5a-j2rV.js";import{b as k,C as Oe,E as Ae,q as Me,x as Pe}from"./Tag-DkH2MdpA.js";import"./FormContainer-HIBjkHQl.js";import{S as ee}from"./Select-C1b3zJA4.js";import{t as C,N as I}from"./toast-BR7ZoxZ1.js";import{S as qe,h as Re}from"./html2canvas.esm-Bv-9StfK.js";import{g as Qe}from"./Evidence-YKJxFnNx.js";import"./index-CVbtTUEK.js";import"./index-Ddnay0b-.js";const{Tr:ne,Th:ce,Td:oe,THead:Ye,TBody:He}=k,Be=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],Le=()=>{const[r,s]=m.useState(!1),[t,n]=m.useState(window.innerWidth<=1024);m.useEffect(()=>{const g=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]);const o=()=>s(!0),d=()=>s(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Z,{}),"aria-label":"View Scoring Criteria Values",onClick:o,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(X,{title:"Scoring Criteria",isOpen:r,placement:"right",width:t?"100%":800,onClose:d,onRequestClose:d,children:e.jsxs(k,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx(Ye,{children:e.jsxs(ne,{className:"bg-gray-100",children:[e.jsx(ce,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(ce,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(He,{children:Be.map((g,j)=>e.jsxs(ne,{children:[e.jsx(oe,{className:"border border-gray-300 p-2",children:g.grade}),e.jsx(oe,{className:"border border-gray-300 p-2",children:g.description})]},j))})]})})]})},We=async(r,s,t,n,o)=>{try{return await Y({url:`/supervisor/form_b?department_id=${r}&team_id=${s}&year=${t}&staff_id=${n}&quater=${o}`,method:"get"})}catch(d){throw console.error("Error fetching information data:",d),d}},ze=async r=>{try{return await Y({url:"supervisor/form_b/employee_task",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},Ue=async r=>{try{return await Y({url:"supervisor/form_b/competencies",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},Ve=async r=>{try{return await Y({url:"supervisor/form_b/operation_and_process",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},Ge=async r=>{try{return await Y({url:"supervisor/form_b/strengths_and_improvement",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},Ke=async r=>{try{return await Y({url:"/supervisor/submit_of_overall_assesment",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},{Tr:se,Th:Je,Td:_,THead:Xe,TBody:Ze}=k,er=({employee_task:r,onSubmitSuccess:s})=>{const t=be(),{id:n}=W(),[o,d]=m.useState([]),[g,j]=m.useState({weightSum:0,gradeWeightSum:0,quarterMarksSum:0}),h=U(i=>i.quaterTab.selectedQuarter),x=localStorage.getItem("selectedDepartmentID")||"",f=Number(localStorage.getItem("selectedTeamID"))||0,y=Number(localStorage.getItem("selectedYear"))||new Date().getFullYear(),E=(i,l,a,c)=>{if(c===""||isNaN(Number(c))){d(w=>w.map((N,T)=>T===i?{...N,rows:N.rows.map((u,v)=>v===l?{...u,[a]:""}:u)}:N));return}const p=parseFloat(c);p>999999||c.includes(".")&&c.split(".")[1].length>6||d(w=>w.map((N,T)=>T===i?{...N,rows:N.rows.map((u,v)=>{var P,q,B,F;if(v!==l)return u;const S=p,D=p+(((F=(B=(q=(P=r[h])==null?void 0:P[i])==null?void 0:q.objectives)==null?void 0:B[l])==null?void 0:F.raw)||0),M=+(u.gradeWeight*D).toFixed(2),H=u.targetSet?+(Number(S)/u.targetSet*u.gradeWeight).toFixed(2):0;return{...u,[a]:p,raw:D,weighted:M,score:H}})}:N))};m.useEffect(()=>{const i=(r[h]||[]).map(l=>({selectedKRA:l.kra_name,weight:l.kra_weight,rows:l.objectives.map(a=>({selectedObjective:a.objective_name,gradeWeight:a.gradeed_weight,selectedKPI:a.kpi,unitOfMeasurement:a.unit,targetSet:a.target,targetAchieved:a.target_achieved,raw:a.raw,weighted:a.weighted,score:a.quater_markes}))}));d(i)},[h,r]),m.useEffect(()=>{const i=o.reduce((c,p)=>c+p.weight,0),l=o.reduce((c,p)=>c+p.rows.reduce((w,N)=>w+N.gradeWeight,0),0),a=o.reduce((c,p)=>c+p.rows.reduce((w,N)=>w+N.score,0),0);j({weightSum:i,gradeWeightSum:l,quarterMarksSum:a}),t(Ne(a))},[o]);const b=async()=>{const i=["1","2","3","4"],l=[];i.forEach(c=>{(r[c]||[]).forEach((w,N)=>{w.objectives.forEach((T,u)=>{var M,H,P;const v=c===h,S=(M=o[N])==null?void 0:M.rows[u];let D=T.raw;if(v)D=(S==null?void 0:S.raw)??T.raw;else{const q=(P=(H=o[N])==null?void 0:H.rows)==null?void 0:P.find(B=>B.selectedKPI===T.kpi);q&&(D=q.raw)}l.push({id:T.id,target_achieved:Number(Number(v?S==null?void 0:S.targetAchieved:T.target_achieved).toFixed(6)),quarter_marks:Number((v?(S==null?void 0:S.score)??0:T.quater_markes).toFixed(2)),raw:Number(D.toFixed(2)),weighted:Number((v?(S==null?void 0:S.weighted)??0:T.gradeed_weight*D).toFixed(2))})})})});const a={staff_id:n,department_id:x,team_id:f,year:y,data:l};try{(await ze(a)).status===200&&(C.push(e.jsx(I,{title:"Success",type:"success",children:"Data saved successfully"}),{placement:"top-center"}),s==null||s())}catch(c){console.error("Error saving data:",c),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to save data. Please try again."}),{placement:"top-center"})}};return e.jsxs("div",{className:"mt-2",children:[e.jsxs(k,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Xe,{children:e.jsx(se,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Grade Weight","KPIs","Unit of Measurement","Target Set","Target Achieved",`Quarter Marks (Q${h})`,"Raw","Weighted"].map((i,l)=>e.jsx(Je,{className:"border border-gray-400 p-2",children:i},l))})}),e.jsxs(Ze,{children:[o.map((i,l)=>i.rows.map((a,c)=>e.jsxs(se,{children:[c===0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"border border-gray-400 text-center",rowSpan:i.rows.length,children:l+1}),e.jsx(_,{className:"border border-gray-400",rowSpan:i.rows.length,children:i.selectedKRA}),e.jsx(_,{className:"border border-gray-400 text-center",rowSpan:i.rows.length,children:i.weight})]}),e.jsx(_,{className:"border border-gray-400 break-all",children:a.selectedObjective}),e.jsx(_,{className:"border border-gray-400 text-center",children:a.gradeWeight}),e.jsx(_,{className:"border border-gray-400",children:a.selectedKPI}),e.jsx(_,{className:"border border-gray-400 text-center",children:a.unitOfMeasurement}),e.jsx(_,{className:"border border-gray-400 text-center",children:a.targetSet}),e.jsx(_,{className:"border border-gray-400 text-center",children:e.jsx(O,{type:"number",max:9999,step:1e-6,value:a.targetAchieved===""?"":a.targetAchieved,onChange:p=>E(l,c,"targetAchieved",p.target.value)})}),e.jsx(_,{className:"border border-gray-400 text-center",children:a.score.toFixed(2)}),e.jsx(_,{className:"border border-gray-400 text-center",children:a.raw.toFixed(2)}),e.jsx(_,{className:"border border-gray-400 text-center",children:a.weighted.toFixed(2)})]},`${l}-${c}`))),e.jsxs(se,{className:"font-semibold bg-gray-100",children:[e.jsx(_,{className:"border border-gray-400 text-center",colSpan:2,children:"Total"}),e.jsx(_,{className:"border border-gray-400 text-center",children:Math.round(g.weightSum)}),e.jsx(_,{colSpan:1,className:"border border-gray-400 text-center"}),e.jsx(_,{className:"border border-gray-400 text-center",children:Math.round(g.gradeWeightSum)}),e.jsx(_,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(_,{colSpan:3,className:"border border-gray-400 text-center",children:g.quarterMarksSum})]})]})]}),e.jsx("div",{className:"flex flex-col items-end mt-4",children:e.jsx(A,{variant:"solid",color:"green-700",className:"mb-2",onClick:b,children:"Save"})})]})},{Tr:ie,Th:de,Td:me,THead:rr,TBody:sr}=k,tr=({isOpen:r,setIsOpen:s})=>{const[t,n]=m.useState(window.innerWidth<=1024);m.useEffect(()=>{const d=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const o=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."}];return e.jsx(X,{isOpen:r,title:"Performance Rating Scale",width:t?"100%":750,onClose:()=>s(!1),children:e.jsxs(k,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(rr,{children:e.jsxs(ie,{className:"bg-gray-100",children:[e.jsx(de,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(de,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(sr,{children:o.map(d=>e.jsxs(ie,{children:[e.jsx(me,{className:"border border-gray-300 p-2",children:d.title}),e.jsx(me,{className:"border border-gray-300 p-2",children:d.desc})]},d.id))})]})})},ar=()=>{const[r,s]=m.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Z,{}),onClick:()=>s(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(tr,{isOpen:r,setIsOpen:s})]})},{Tr:te,Th:L,Td:$,THead:lr,TBody:nr}=k,cr=({competencies:r})=>{const{id:s}=W(),t=fe(),n=U(b=>b.quaterTab.selectedQuarter),[o,d]=m.useState(r[n]),[g,j]=m.useState({});m.useEffect(()=>{d(r[n])},[n,r]);const h=(b,i,l)=>{l<0||l>5?j(a=>({...a,[`${b}-${i}`]:"Value must be between 0 and 5."})):(j(a=>{const c={...a};return delete c[`${b}-${i}`],c}),d(a=>a.map(c=>c.id===b?{...c,competencies_details:c.competencies_details.map((p,w)=>w===i?{...p,quarter_marks:l}:p)}:c)))},x=o.reduce((b,i)=>b+i.competencies_details.reduce((l,a)=>l+a.max_score,0),0),f=o.reduce((b,i)=>b+i.competencies_details.reduce((l,a)=>l+a.quarter_marks,0),0),y=x>0?f/x*20:0;t(ve(y));const E=async()=>{const b={staff_id:s,department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),quater:parseInt(n,10),competencies_details:o.flatMap(i=>i.competencies_details.map(l=>({id:l.id,quarter_marks:l.quarter_marks})))};try{(await Ue(b)).status===200&&C.push(e.jsx(I,{title:"Success",type:"success",children:"Data saves Successfully"}),{placement:"top-center"})}catch(i){console.error("Error saving data:",i),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to save data. Please try again."}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border overflow-hidden shadow-sm",children:e.jsxs(k,{compact:!0,className:"w-full bg-white",children:[e.jsx(lr,{children:e.jsxs(te,{className:"bg-gray-200",children:[e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:`Quarter Marks (Q${n})`})]})}),e.jsxs(nr,{className:"divide-y divide-gray-200",children:[o.map(b=>e.jsx(je.Fragment,{children:b.competencies_details.map((i,l)=>e.jsxs(te,{children:[l===0&&e.jsx($,{className:"px-4 py-3 align-top font-semibold border border-gray-400",rowSpan:b.competencies_details.length,children:b.competencies}),e.jsx($,{className:"px-4 py-3 border border-gray-400",children:i.cluster}),e.jsx($,{className:"px-4 py-3 border border-gray-400",children:i.sub_cluster}),e.jsx($,{className:"px-4 py-3 border border-gray-400",children:i.describe_expectations}),e.jsx($,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:i.min_score}),e.jsx($,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:i.max_score}),e.jsxs($,{className:"px-4 py-3 border border-gray-400 w-[12%]",children:[e.jsx(O,{size:"sm",value:i.quarter_marks,onChange:a=>h(b.id,l,Number(a.target.value))}),g[`${b.id}-${l}`]&&e.jsx("span",{className:"text-red-500 text-sm",children:g[`${b.id}-${l}`]})]})]},l))},b.id)),e.jsxs(te,{className:"font-semibold bg-gray-100",children:[e.jsx($,{className:"border border-gray-400 text-center",colSpan:4}),e.jsx($,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx($,{colSpan:2,className:"border border-gray-400 text-center",children:y.toFixed(2)})]})]})]})}),e.jsx("div",{className:"text-right mt-4",children:e.jsx(A,{variant:"solid",color:"green-700",onClick:E,children:"Save"})})]})},{Tr:V,Th:ue,Td:R,THead:or,TBody:ir}=k,dr=()=>{const[r,s]=m.useState(!1),[t,n]=m.useState(window.innerWidth<=1024);m.useEffect(()=>{const g=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]);const o=()=>{s(!0)},d=g=>{console.log("onDrawerClose",g),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Z,{}),onClick:()=>o(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(X,{title:"Performance Rating Scale  ",isOpen:r,width:t?"100%":750,onClose:d,onRequestClose:d,children:e.jsxs(k,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(or,{children:e.jsxs(V,{className:"bg-gray-100",children:[e.jsx(ue,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(ue,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs(ir,{children:[e.jsxs(V,{children:[e.jsx(R,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(R,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(V,{children:[e.jsx(R,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(R,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(V,{children:[e.jsx(R,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(R,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(V,{children:[e.jsx(R,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(R,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:ae,Th:G,Td:Q,THead:mr,TBody:ur}=k,gr=({operation_and_process:r})=>{const{id:s}=W(),t=be(),n=U(l=>l.quaterTab.selectedQuarter),[o,d]=m.useState(r[n]||[]);m.useEffect(()=>{d(r[n]||[])},[n,r]);const[g,j]=m.useState({}),h=()=>o.reduce((l,a)=>l+a.details.reduce((c,p)=>c+p.max_score,0),0),x=()=>o.reduce((l,a)=>l+a.details.reduce((c,p)=>c+p.quarter_marks,0),0),f=h(),y=x(),E=f>0?y/f*10:0;t(we(E));const b=(l,a,c)=>{const p=`${l}-${a}`;if(c<0||c>5){j(N=>({...N,[p]:"value must be between 0 and 5."}));return}j(N=>{const{[p]:T,...u}=N;return u});const w=[...o];w[l].details[a].quarter_marks=c,d(w)},i=async()=>{const l={staff_id:s,department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),quater:parseInt(n,10),operations_and_process:o.flatMap(a=>a.details.map(c=>({id:c.id,quarter_marks:c.quarter_marks})))};try{(await Ve(l)).status===200&&C.push(e.jsx(I,{title:"Success",type:"success",children:"Data saves Successfully"}),{placement:"top-center"})}catch(a){console.error("Error saving data:",a),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to save data. Please try again."}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(k,{compact:!0,className:"table-auto border-collapse border border-gray-400 w-full bg-white",children:[e.jsx(mr,{children:e.jsxs(ae,{className:"bg-gray-200",children:[e.jsx(G,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx(G,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx(G,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx(G,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx(G,{className:"border border-gray-400 p-2 text-center",children:`Quarter Marks (Q${n})`})]})}),e.jsxs(ur,{children:[o.map((l,a)=>e.jsx(je.Fragment,{children:l.details.map((c,p)=>{const w=`${a}-${p}`;return e.jsxs(ae,{children:[p===0&&e.jsx(Q,{className:"border border-gray-400 p-2 font-bold",rowSpan:l.details.length,children:l.operations_and_process}),e.jsx(Q,{className:"border border-gray-400 p-2",children:c.describe_expectations}),e.jsx(Q,{className:"border border-gray-400 p-2 text-center",children:c.min_score}),e.jsx(Q,{className:"border border-gray-400 p-2 text-center",children:c.max_score}),e.jsxs(Q,{className:"border border-gray-400 p-2 text-center w-[12%]",children:[e.jsx(O,{size:"sm",value:c.quarter_marks,onChange:N=>b(a,p,Number(N.target.value))}),g[w]&&e.jsx("span",{className:"text-red-500 text-sm",children:g[w]})]})]},p)})},a)),e.jsxs(ae,{className:"font-semibold bg-gray-100",children:[e.jsx(Q,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(Q,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(Q,{colSpan:2,className:"border border-gray-400 text-center",children:E.toFixed(2)})]})]})]}),e.jsx("div",{className:"text-right mt-4",children:e.jsx(A,{variant:"solid",color:"green-700",onClick:i,children:"Save"})})]})},{Tr:ge,Th:xe,Td:he,THead:xr,TBody:hr}=k,pr=()=>{const{id:r}=W(),s=U(h=>h.quaterTab.selectedQuarter),{quarterMarksSum:t,competencyMarks:n,oprationMarks:o}=U(h=>h.assesment),d=t+n+o,g=[{label:"Sub-total rating of appraisee performance (Expectations and Goals from Section 3)",value:t.toFixed(3)},{label:"Sub-total rating of appraisee performance (Competencies) in Section 4",value:n.toFixed(3)},{label:"Sub-total rating of appraisee performance (Operations and Processes) in Section 5",value:o.toFixed(3)},{label:"Overall Rating (Section 3 + 4 + 5)",value:d.toFixed(3)}],j=async()=>{var x,f;const h={staff_id:String(r),department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),quater:s,sub_total_rating_expectations:t,sub_total_rating_competencies:n,sub_total_rating_operations:o,overall_rating:d};try{(await Ke(h)).status===200?C.push(e.jsx(I,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):C.push(e.jsx(I,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(y){const E=((f=(x=y.response)==null?void 0:x.data)==null?void 0:f.error)||y.message||"An unexpected error occurred.";C.push(e.jsx(I,{title:"Error",type:"danger",children:E}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 6: Summary of Overall Assessment (10%)"})}),e.jsxs(k,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left bg-white",children:[e.jsx(xr,{children:e.jsxs(ge,{className:"bg-gray-100",children:[e.jsx(xe,{className:"border border-gray-300 p-2",children:"Overall Assessment"}),e.jsx(xe,{className:"border border-gray-300 p-2 text-center",children:"Appraiser Rating"})]})}),e.jsx(hr,{children:g.map((h,x)=>e.jsxs(ge,{children:[e.jsx(he,{className:"border border-gray-300 p-2",children:h.label}),e.jsx(he,{className:"border border-gray-300 p-2 text-center",children:h.value??"-"})]},x))})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(A,{variant:"solid",color:"green-700",onClick:j,children:"Submit Assessment Point"})})]})},br=()=>{const{id:r}=W(),[s,t]=m.useState(""),[n,o]=m.useState(""),[d,g]=m.useState(null),[j,h]=m.useState(null),x=async()=>{var E,b,i,l;let f=!1;if(s.trim()?g(null):(g("The strengths field is required."),f=!0),n.trim()?h(null):(h("The improvement field is required."),f=!0),f)return;const y={staff_id:r,department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),strengths:s,improvement:n};try{(await Ge(y)).status===200&&C.push(e.jsx(I,{title:"Success",type:"success",children:"Data saved successfully"}),{placement:"top-center"})}catch(a){const c=(b=(E=a.response)==null?void 0:E.data)==null?void 0:b.errors,p=c?Object.values(c).flat().join(`
`):((l=(i=a.response)==null?void 0:i.data)==null?void 0:l.error)||a.message||"An unexpected error occurred.";C.push(e.jsx(I,{title:"Error",type:"danger",children:p}),{placement:"top-center"}),console.error("Error submitting data:",a)}};return e.jsxs("div",{className:"mt-4 mx-auto bg-white shadow-lg rounded-lg p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"Employee Strengths and Improvement Areas"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"What are the employee’s strengths?"}),e.jsx(O,{textArea:!0,className:`input-textarea w-full px-4 py-2 border rounded-md ${d?"border-red-500":"border-gray-300"}`,value:s,placeholder:"Describe the employee’s strengths...",onChange:f=>{t(f.target.value),d&&f.target.value.trim()&&g(null)}}),d&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(le,{className:"mr-2"}),d]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"What are the employee’s areas for improvement?"}),e.jsx(O,{textArea:!0,className:`input-textarea w-full px-4 py-2 border rounded-md ${j?"border-red-500":"border-gray-300"}`,value:n,placeholder:"Describe the employee’s areas for improvement...",onChange:f=>{o(f.target.value),j&&f.target.value.trim()&&h(null)}}),j&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(le,{className:"mr-2"}),j]})]}),e.jsx("div",{className:"text-right mt-6",children:e.jsx(A,{variant:"solid",color:"green-700",className:"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 transition duration-200",onClick:x,children:"Confirm & Save"})})]})},{TabNav:J,TabList:fr}=ye,jr=()=>{const r=fe(),s=Se(n=>n.quaterTab.selectedQuarter),t=n=>{r(Te(n))};return e.jsx("div",{children:e.jsx(Oe,{className:"bg-gray-50 card-body-padding mt-8",children:e.jsx(ye,{value:s,variant:"pill",onChange:t,children:e.jsxs(fr,{children:[e.jsx(J,{value:"1",className:`${s==="1"?"bg-green-700 text-white":""}`,children:"First Quarter"}),e.jsx(J,{value:"2",className:`${s==="2"?"bg-green-700 text-white":""}`,children:"Second Quarter"}),e.jsx(J,{value:"3",className:`${s==="3"?"bg-green-700 text-white":""}`,children:"Third Quarter"}),e.jsx(J,{value:"4",className:`${s==="4"?"bg-green-700 text-white":""}`,children:"Fourth Quarter"})]})})})})},yr=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 7 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),Nr=({evidenceList:r=[],onChange:s})=>{const[t,n]=m.useState(!1),[o,d]=m.useState([]),g=Array.isArray(r)?r.map(x=>({label:x.name,value:x.evidence_id})):[],j=x=>{o.some(y=>y.value===x.evidence_id)||d(y=>[...y,{label:x.name,value:x.evidence_id}]),n(!1)},h=x=>{var y;const f=((y=x.split(".").pop())==null?void 0:y.toLowerCase())||"";return["jpg","jpeg","png","gif"].includes(f)?e.jsx(Ae,{className:"w-8 h-8 text-blue-600"}):f==="pdf"?e.jsx(Me,{className:"w-8 h-8 text-red-600"}):["xls","xlsx"].includes(f)?e.jsx(Pe,{className:"w-8 h-8 text-green-600"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"N/A"})};return m.useEffect(()=>{const x=o.map(f=>f.value);s(x)},[o,s]),e.jsxs("div",{className:"w-full sm:w-1/2 mb-4",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Evidence Information:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsx(ee,{isMulti:!0,placeholder:"Please Select",className:"w-full flex-1",options:g,value:o,onChange:d}),e.jsx(Z,{className:"w-6 h-6 text-gray-500 hover:text-gray-700 cursor-pointer mt-1 sm:mt-0",onClick:()=>n(!0)}),e.jsx(X,{title:"Evidence Details",isOpen:t,width:500,onClose:()=>n(!1),onRequestClose:()=>n(!1),children:e.jsx("div",{className:"space-y-4 p-4 max-w-full",children:Array.isArray(r)&&r.map(x=>e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-100 border-blue-500 flex flex-col sm:flex-row justify-between items-start sm:items-center cursor-pointer hover:bg-blue-50",onClick:()=>j(x),children:[e.jsxs("div",{className:"space-y-1 w-full sm:w-3/4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:x.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:x.description}),e.jsx("a",{href:x.file_path,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline mt-2 block text-sm font-bold",children:"View File"})]}),e.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-4",children:h(x.file_path)})]},x.id))})})]})]})},vr=({comments:r,onAppraisersCommentChange:s,showValidationError:t,commentInputRef:n})=>{var j;const[o,d]=m.useState("");m.useEffect(()=>{const h=r.staff.comment||"";d(h),s(h)},[r.staff.comment]);const g=h=>{const x=h.target.value;d(x),s(x)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(O,{textArea:!0,disabled:!0,className:"input-textarea mt-2",value:r.staff.comment||""})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(O,{required:!0,ref:n,textArea:!0,value:o,placeholder:"Enter your comments here",className:`textarea mt-2 w-full rounded-md border px-3 py-2 focus:outline-none ${t&&!o?"border-red-500":"border-gray-300"}`,onChange:g}),t&&!o&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(le,{className:"mr-1"}),"This field is required."]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx(O,{disabled:!0,textArea:!0,value:((j=r.officer)==null?void 0:j.comment)||"",className:"input-textarea mt-2"})]})]})},wr=({Staff:r})=>{const s=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],t=s.find(n=>n.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraisee's Declaration:"}),e.jsx(ee,{isDisabled:!0,id:"declaration",value:t,options:s,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(O,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraisee"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},pe=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],Sr=({Supervisor:r,onChange:s,officerDeclaration:t})=>{const[n,o]=m.useState(null),[d,g]=m.useState(null),[j,h]=m.useState(null),[x,f]=m.useState(null),[y,E]=m.useState(!1),[b,i]=m.useState(0),l=m.useRef(null),a=m.useRef(null),c=m.useRef(null);m.useEffect(()=>{r&&(o(r.declaration),h(r.signature),g(r.date?new Date(r.date):null),i((r.signature,0)))},[r]);const p=u=>{var S;const v=(S=u.target.files)==null?void 0:S[0];if(v){if(v.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!v.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const D=new FileReader;D.onloadend=()=>{const M=D.result;h(M),f(v.name),i(1)},D.readAsDataURL(v)}},w=()=>{E(!0)},N=async()=>{if(a.current&&!a.current.isEmpty()){if(c.current){const v=(await Re(c.current)).toDataURL("image/png");h(v),i(1),E(!1)}}else alert("Please draw a signature before saving.")},T=()=>{var u;(u=a.current)==null||u.clear()};return m.useEffect(()=>{const u=d!==null?new Date(d.getFullYear(),d.getMonth(),d.getDate()+1):null,v={declaration:n,date:u,flag:b};b===1&&(v.signature=j),s(v)},[n,d,j,b]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(ee,{isDisabled:t===1,placeholder:"Please Select",options:pe,className:"mt-2",value:pe.find(u=>u.value===n),onChange:u=>o((u==null?void 0:u.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(Ie,{disabled:t===1,className:"mt-2",value:d,onChange:u=>g(u)})]}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1",children:"Appraiser's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",disabled:t===1,className:`flex items-center gap-2 focus:outline-none text-white font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2
                ${t===1?"bg-gray-400 cursor-not-allowed":"bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300"}`,onClick:w,children:[e.jsx(ke,{className:"w-5 h-5"}),"Add Signature"]}),e.jsxs("button",{type:"button",disabled:t===1,className:`flex items-center gap-2 focus:outline-none text-white font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2
                ${t===1?"bg-gray-400 cursor-not-allowed":"bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300"}`,onClick:()=>{var u;return(u=l.current)==null?void 0:u.click()},children:[e.jsx(Fe,{className:"w-5 h-5"}),"Upload"]}),e.jsx("input",{ref:l,type:"file",accept:"image/*",className:"hidden",onChange:p})]})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),j&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:j,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>E(!1),children:e.jsx($e,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:c,className:" rounded-md mt-4 bg-white",children:e.jsx(qe,{ref:a,canvasProps:{width:330,height:150,className:"sigCanvas "}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(A,{size:"sm",variant:"default",onClick:T,children:"Clear"}),e.jsx(A,{size:"sm",variant:"solid",onClick:N,children:"Save"})]})]})})]})},Tr=({officer:r})=>{const s=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],t=s.find(n=>n.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Declaration:"}),e.jsx(ee,{isDisabled:!0,id:"declaration",value:t,options:s,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(O,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Countersigning Officer's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},Er=async(r,s,t,n)=>{try{return await Y({url:`/supervisor/form_b_comments?department_id=${r}&team_id=${s}&year=${t}&staff_id=${n}`,method:"get"})}catch(o){throw console.error("Error fetching information data:",o),o}},Dr=async r=>{try{const s=await Y({url:"/supervisor/form_b_comments",method:"post",data:r});return console.log(s),s}catch(s){throw console.error("Error fetching information data:",s),s}},_r=({submittedEvidence:r})=>{if(!r||r.length===0)return e.jsx("p",{className:"text-gray-500",children:"No submitted evidence available."});const s=async t=>{try{const o=(await Qe(t)).data,d=URL.createObjectURL(o);window.open(d,"_blank")}catch(n){console.error("Error fetching evidence data:",n)}};return e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Submitted Evidence:"}),e.jsx("div",{className:"flex flex-col gap-4",children:r.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"text-blue-600 underline max-w-[250px] truncate cursor-pointer",onClick:()=>s(t.evidence_id),children:t.evidence_id}),e.jsx("div",{className:"flex-1 text-right",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:[e.jsx("strong",{children:"Created:"})," ",new Date(t.created_at).toLocaleDateString()]})})]},t.id))})]})},Cr=()=>{var T,u,v,S,D,M,H,P,q,B;const{id:r}=W(),s=Ee(),[t,n]=m.useState(),[o,d]=m.useState(!0),[g,j]=m.useState(null),[h,x]=m.useState([]),[f,y]=m.useState(""),[E,b]=m.useState(!1),i=async()=>{try{const F=localStorage.getItem("selectedDepartmentID")||"",z=localStorage.getItem("selectedTeamID"),re=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),K=await Er(F,z?Number(z):null,re,String(r));if(K&&K.data)n(K.data);else throw new Error("Invalid response data")}catch(F){console.error("Error fetching data:",F),j("Failed to load data. Please try again.")}finally{d(!1)}};m.useEffect(()=>{i()},[]);const[l,a]=m.useState({declaration:null,date:null,signature:null,flag:0}),c=m.useRef(null),p=async()=>{var F;if(!f.trim()){b(!0),(F=c.current)==null||F.scrollIntoView({behavior:"smooth",block:"center"}),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Appraisers 's Comments is reuired"}),{placement:"top-center"});return}try{const z=l.date instanceof Date?l.date.toISOString().split("T")[0]:null,re={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),evidence_ids:h,comment:f,date:z,signature:l.signature,declaration:l.declaration,flag:l.flag,staff_id:String(r)};(await Dr(re)).status===200?C.push(e.jsx(I,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):C.push(e.jsx(I,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(z){console.error("Error submitting data:",z),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to submit data. Please check your connection and try again."}),{placement:"top-center"})}},w=()=>{s(-1)},N=()=>{s(`/form/supervisor/annual-review/${r}`)};return o?e.jsx("div",{children:"Loading..."}):g?e.jsx("div",{className:"text-red-500",children:g}):e.jsxs("div",{className:"mt-4  mx-auto w-full ",children:[e.jsx(yr,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(_r,{submittedEvidence:((u=(T=t==null?void 0:t.comments)==null?void 0:T.staff)==null?void 0:u.evidence)||[]})}),e.jsx("div",{className:"mt-4",children:e.jsx(Nr,{evidenceList:(t==null?void 0:t.evidence_list)||[],onChange:x})}),e.jsx("div",{className:"mt-4",children:e.jsx(vr,{commentInputRef:c,comments:{staff:((v=t==null?void 0:t.comments)==null?void 0:v.staff)||{comment:""},supervisor:((S=t==null?void 0:t.comments)==null?void 0:S.supervisor)||{comment:""},officer:((D=t==null?void 0:t.comments)==null?void 0:D.officer)||{comment:""}},showValidationError:E,onAppraisersCommentChange:y})}),e.jsx("div",{className:"mt-4",children:e.jsx(wr,{Staff:(M=t==null?void 0:t.comments)==null?void 0:M.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(Sr,{Supervisor:(H=t==null?void 0:t.comments)==null?void 0:H.supervisor,onChange:F=>{a(F)},officerDeclaration:(q=(P=t==null?void 0:t.comments)==null?void 0:P.officer)==null?void 0:q.declaration})}),e.jsx("div",{className:"mt-4",children:e.jsx(Tr,{officer:(B=t==null?void 0:t.comments)==null?void 0:B.officer})})]}),e.jsx(De,{back:"Back",handleBack:w,save:"Save",handleSave:p,next:"Next",handleNext:N})]})},Br=()=>{const{id:r}=W(),s=U(u=>u.quaterTab.selectedQuarter),[t,n]=m.useState(),[o,d]=m.useState(!0),[g,j]=m.useState(null),[h,x]=m.useState(!1),f=()=>{x(!0),y()},y=async()=>{try{const u=localStorage.getItem("selectedDepartmentID")||"",v=localStorage.getItem("selectedTeamID"),S=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),D=await We(u,v?Number(v):null,S,r,s);if(D&&D.data)n(D.data);else throw new Error("Invalid response data")}catch(u){console.error("Error fetching data:",u),j("Failed to load data. Please try again.")}finally{d(!1)}};if(m.useEffect(()=>{y()},[]),o)return e.jsx("div",{children:"Loading..."});if(g)return e.jsx("div",{className:"text-red-500",children:g});const{department:E,team:b,supervisor:i,officer:l,staff:a,progress:c,employee_task:p,competencies:w,operation_and_process:N,others:T}=t||{};return e.jsxs("div",{children:[e.jsx(_e,{department:E,team:b,progress:c,title:"PERFORMANCE APPRAISAL"}),a&&i&&l&&e.jsx(Ce,{staff:a,supervisor:i,officer:l}),e.jsx(jr,{}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Le,{}),e.jsx(er,{employee_task:p,onSubmitSuccess:f})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ar,{}),e.jsx(cr,{competencies:w})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(dr,{}),e.jsx(gr,{operation_and_process:N})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(pr,{}),e.jsx(br,{assesment:T.strengths,improvement:T.improvement})]}),e.jsx(Cr,{})]})};export{Br as default};

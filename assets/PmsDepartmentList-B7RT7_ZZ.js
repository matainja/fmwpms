import{j as e,r as i,p as v,W as y,u as j,a as D,q as S}from"./index-Cmv4Hw-4.js";import"./FormContainer-HIBjkHQl.js";import{C}from"./Tag-DkH2MdpA.js";import{I}from"./hoist-non-react-statics.cjs-BTbAOH4E.js";import{P as L,b as E}from"./Upload-Bjo3S9Ma.js";import"./Select-C1b3zJA4.js";import"./toast-BR7ZoxZ1.js";import"./SvgIcon-YlnLBm2p.js";import{K as P,E as A}from"./Views-D5a-j2rV.js";import{U as O}from"./UsersAvatarGroup-Dd8350s6.js";import{b as F}from"./Department-BVOBRPHm.js";import"./index-Ddnay0b-.js";import"./quill.snow-Do1d7lnz.js";import"./cloneDeep-DznBgb_t.js";import"./useThemeClass-Bdyjo5Qx.js";import"./acronym-BqE2GpXs.js";const M=({members:t})=>e.jsx(O,{users:t}),f=({progression:t})=>{const[r,n]=i.useState(!1),a=i.useMemo(()=>t>70?{color:"green-500"}:t<40?{color:"red-500"}:{},[t]);return e.jsxs("div",{className:"relative w-full",children:[r&&e.jsxs("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 px-2 py-1 text-xs text-white bg-gray-800 rounded-lg shadow-lg whitespace-nowrap",role:"tooltip",children:["Overall Progress",e.jsx("div",{className:"absolute bottom-[-4px] left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-800 rotate-45"})]}),e.jsx("div",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:e.jsx(L,{size:"sm",percent:t,...a})})]})},k=({data:t})=>{const{department_id:r,name:n,description:a,progresive:c,teams_assigned:o}=t,[p,m]=i.useState(!1),[l,h]=i.useState(window.innerWidth<=1024),x=v(),d=y(r);i.useEffect(()=>{const s=()=>{h(window.innerWidth<=1024)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const g=()=>{if(!d){console.error("Failed to encrypt department ID");return}localStorage.setItem("selectedDepartmentID",r);const s=`/officer/departmentlist/${d}`;x(s)},w=n.split(" ").slice(0,7).join(" "),b=a.split(" ").slice(0,15).join(" "),N=a.split(" ").length>15,u=()=>m(s=>!s);return e.jsxs(e.Fragment,{children:[e.jsx(C,{bodyClass:"h-full",className:"bg-[#018752] hover:bg-green-800 hover:-translate-y-1 transition-all duration-300 cursor-pointer",onClick:g,children:e.jsxs("div",{className:"flex flex-col justify-between h-full",children:[e.jsx("h6",{className:"text-white",children:w}),e.jsxs("p",{className:"mt-4 break-all text-white",children:[b,N&&e.jsxs(e.Fragment,{children:["..."," ",e.jsx("button",{className:"text-blue-400 hover:underline ml-1",onClick:s=>{s.stopPropagation(),u()},children:"View All"})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx(f,{progression:c}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx(M,{members:o.map(s=>({name:s.name,image:""}))}),e.jsxs("div",{className:"flex items-center px-2 py-1 border border-gray-300 rounded-full bg-white",children:[e.jsx(P,{className:"text-base"}),e.jsx("span",{className:"ml-1 rtl:mr-1 whitespace-nowrap",children:o.length})]})]})]})]})}),e.jsx(E,{title:"Department Details",isOpen:p,placement:"right",width:l?"100%":600,onClose:u,children:e.jsxs("div",{className:"p-6 bg-gray-100 rounded-md shadow-md",children:[e.jsx("h6",{className:"text-xl font-bold text-gray-800",children:n}),e.jsx("p",{className:"mt-3 text-gray-600 leading-relaxed",children:a}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h6",{className:"text-lg font-medium text-gray-700",children:"Progress"}),e.jsx(f,{progression:c,className:"mt-3"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h6",{className:"text-lg font-medium text-gray-700",children:"Teams Assigned"}),o.length>0?e.jsx("ul",{className:"mt-3 space-y-2",children:o.map(s=>e.jsxs("li",{className:"flex items-center space-x-3 bg-white p-3 rounded-md shadow-sm border border-gray-200 hover:shadow-md transition-all",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-500 flex items-center justify-center text-white font-semibold",children:s.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"text-gray-800 font-medium",children:s.name})]},s.team_id))}):e.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"No teams assigned."})]})]})})]})},z=({departmentData:t})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:t.map(r=>e.jsx(k,{data:r},r.department_id))})}),U=({search:t,onChangeSearch:r})=>{const{userName:n}=j(a=>a.auth.user);return e.jsxs("div",{className:"flex flex-col gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col items-center text-center gap-2",children:[e.jsx("h1",{className:"text-[#020048] font-extrabold text-4xl italic tracking-tight",children:"Welcome"}),e.jsx("h2",{className:"text-[#242424] text-2xl font-semibold",children:n}),e.jsx("div",{className:"w-2/4 h-[2px] bg-gray-300 rounded-full"}),e.jsx("p",{className:"text-base text-[#3c3b3b] max-w-xl  leading-relaxed",children:"Click on your department to access your Performance Appraisal Forms."})]}),e.jsxs("div",{className:"w-full mt-10 flex flex-col lg:flex-row items-center justify-between gap-4",children:[e.jsx("div",{className:"text-xl font-bold text-green-800 border-b-2 border-yellow-400 pb-1",children:"My Departments"}),e.jsx(I,{size:"sm",placeholder:"Search departments...",value:t,prefix:e.jsx(A,{className:"text-lg text-gray-500"}),className:"w-full max-w-sm border-green-800 focus:border-green-700 focus:ring-2 focus:ring-green-700 transition",onChange:a=>r(a.target.value)})]})]})},ee=()=>{const t=D(),r=j(l=>l.department.departments),[n,a]=i.useState(""),[c,o]=i.useState(!1);i.useEffect(()=>{const l=async()=>{var x;const h=localStorage.getItem("selectedYear")||new Date().getFullYear().toString();try{o(!0);const g=((x=(await F(h)).data)==null?void 0:x.department_details)||[];t(S(g))}catch(d){console.error("Failed to fetch departments:",d)}finally{o(!1)}};r.length===0&&l()},[r,t]);const p=l=>{a(l)},m=r.filter(l=>l.name.toLowerCase().includes(n.toLowerCase()));return e.jsxs("div",{children:[e.jsx(U,{search:n,onChangeSearch:p}),c?e.jsx("p",{className:"text-gray-500 mt-4 text-sm",children:"Loading departments..."}):m.length>0?e.jsx(z,{departmentData:m,loading:c}):e.jsx("p",{className:"text-red-500 mt-4",children:"No departments available"})]})};export{ee as default};

import{r as i,j as e,p as C,W as I,$ as L,v as _,a as E,u as T,q as A}from"./index-XEIncrLJ.js";import"./FormContainer-BcWWCs1J.js";import{C as j}from"./Tag-MScPo-d6.js";import"./hoist-non-react-statics.cjs-vrUR2keZ.js";import{P as w,b as k}from"./Upload-Dovppv8_.js";import"./Select-BAk-N8U6.js";import"./toast-BA_WAYTR.js";import{K as M}from"./Views-DInV39d3.js";import"./SvgIcon-Bt2VMMBE.js";import{U}from"./UsersAvatarGroup-DhINiio_.js";import{d as O}from"./Department-v9VPHgdl.js";import"./index-NXSOsk8k.js";import"./quill.snow-C-9XaWcz.js";import"./cloneDeep-DznBgb_t.js";import"./useThemeClass-puXe36M2.js";import"./acronym-C0RJDqJV.js";const $=({progression:a,departmentData:n})=>{const[o,s]=i.useState(new Date),[d,m]=i.useState(!1);i.useEffect(()=>{s(new Date)},[]);const t=n.description.split(" "),x=t.length>65,h=d?n.description:t.slice(0,65).join(" ")+(x?"...":""),c=()=>{m(!d)};return e.jsx("div",{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs(j,{className:"md:col-span-2 bg-[#018752]",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h4",{className:"mb-4 lg:mb-0 text-white",children:n.name})}),e.jsxs("div",{className:"mt-2 text-white",children:[h,x&&e.jsx("button",{className:"text-blue-500 underline ml-2",onClick:c,children:d?"See less":"See more"})]})]}),e.jsxs("div",{className:"flex justify-end mt-2 text-sm text-gray-600",children:[e.jsx("div",{className:"mr-2 font-semibold text-gray-200 italic",children:"Last Update:"}),e.jsx("div",{className:"text-white",children:o.toLocaleDateString()})]})]}),e.jsx(j,{className:"bg-[#018752] ",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-white",children:"Progression"}),e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(w,{variant:"circle",percent:a,width:90,strokeWidth:4})})]})})]})})},z=({progression:a})=>{const[n,o]=i.useState(!1),s=i.useMemo(()=>a>70?{color:"green-500"}:a<40?{color:"red-500"}:{},[a]);return e.jsxs("div",{className:"relative w-full",children:[n&&e.jsxs("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 px-2 py-1 text-xs text-white bg-gray-800 rounded-lg shadow-lg whitespace-nowrap",role:"tooltip",children:["Overall Progress",e.jsx("div",{className:"absolute bottom-[-4px] left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-800 rotate-45"})]}),e.jsx("div",{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:e.jsx(w,{size:"sm",percent:a,...s})})]})},F=({members:a})=>e.jsx(U,{users:a}),W=({departmentData:a=[],loading:n=!1})=>{var g;const o=C(),[s,d]=i.useState(null),[m,t]=i.useState(window.innerWidth<=1024);if(i.useEffect(()=>{const r=()=>{t(window.innerWidth<=1024)};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),n)return e.jsx("p",{children:"Loading teams..."});if(a.length===0)return e.jsx("p",{children:"No teams assigned to this department."});const x=(r,l,f)=>{f.stopPropagation(),localStorage.setItem("selectedTeamID",r.toString()),o(`/formList/${l}`)},h=r=>{d(r)},c=()=>{d(null)},p=(r,l)=>{r.stopPropagation(),o(`/team/memberList/${l}`),localStorage.setItem("selectedTeamID",l.toString())};return e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-xl font-semibold mb-4",children:"Associate with Teams"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:a.map(r=>{const{team_id:l,name:f,description:v,progresive:N,user_count:b,team_assign_users:y}=r,S=I(l.toString()),D=f.split(" ").slice(0,5).join(" "),P=v.split(" ").slice(0,15).join(" ");return e.jsx(j,{className:"shadow-sm h-full bg-[#018752] hover:bg-green-900 hover:-translate-y-1 transition-all duration-300 cursor-pointer",onClick:u=>x(l,S,u),children:e.jsxs("div",{className:"flex flex-col justify-between h-full",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx("div",{className:"text-lg font-bold text-white",children:D})}),e.jsxs("p",{className:"mt-2 text-white",children:[P,"...",e.jsx("button",{className:"ml-2 text-blue-500 underline",onClick:u=>{u.stopPropagation(),h(r)},children:"View All"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(z,{progression:N}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx(F,{members:y}),e.jsxs("div",{className:"flex items-center px-2 py-1 border border-gray-300 rounded-full cursor-pointer bg-white",onClick:u=>p(u,l),children:[e.jsx(M,{className:"text-base"}),e.jsx("span",{children:b})]})]})]})]})},l)})}),s&&e.jsx(k,{title:"Team Details",isOpen:!!s,placement:"right",width:m?"100%":600,onClose:c,children:e.jsxs("div",{className:"p-6 bg-gray-100 rounded-md shadow-md",children:[e.jsx("h6",{className:"text-xl font-bold text-gray-800",children:s.name}),e.jsx("p",{className:"mt-3 text-gray-600 leading-relaxed",children:s.description}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h6",{className:"text-lg font-medium text-gray-700",children:"Progress"}),e.jsx("div",{className:"w-full bg-gray-400 rounded-full mt-2 ",children:e.jsxs("div",{className:"bg-green-600 text-xs font-medium text-white text-center  leading-none rounded-full",style:{width:`${s.progresive}%`},children:[s.progresive,"%"]})})]}),((g=s.team_assign_users)==null?void 0:g.length)>0?e.jsxs("div",{className:"mt-6",children:[e.jsx("h6",{className:"text-lg font-medium text-gray-700",children:"Assigned Users"}),e.jsx("ul",{className:"mt-3 space-y-2",children:s.team_assign_users.map(r=>e.jsxs("li",{className:"flex items-center space-x-3 bg-white p-3 rounded-md shadow-sm border border-gray-200 hover:shadow-md transition-all",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-500 flex items-center justify-center text-white font-semibold",children:r.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"text-gray-800 font-medium",children:r.name})]},r.name))})]}):e.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"No users assigned to this team."})]})})]})},ae=()=>{var h;const{encryptedID:a}=L(),n=_(a||""),o=E(),s=T(c=>c.department.departments),[d,m]=i.useState(!0),[t,x]=i.useState(null);return i.useEffect(()=>{const c=async()=>{var g;const p=localStorage.getItem("selectedYear")||new Date().getFullYear().toString();try{m(!0);const l=((g=(await O(p)).data)==null?void 0:g.department_details)||[];o(A(l))}catch(r){console.error("Failed to fetch departments:",r)}finally{m(!1)}};s.length===0?c():m(!1)},[s.length,o]),i.useEffect(()=>{if(s.length>0){const c=s.find(p=>p.department_id===n);c?x(c):console.warn(`No department found for depID: ${n}`)}},[s,n]),e.jsxs("div",{children:[e.jsx($,{progression:(t==null?void 0:t.progresive)||0,departmentData:{name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||""}}),d?e.jsx("p",{children:"Loading..."}):(h=t==null?void 0:t.teams_assigned)!=null&&h.length?e.jsx(W,{departmentData:t.teams_assigned,loading:!1}):e.jsx("p",{children:"No teams available"})]})};export{ae as default};

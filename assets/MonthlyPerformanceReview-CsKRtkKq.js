import{j as e,r as n,a as q,aX as H,a0 as F,$ as M,u as U,p as B}from"./index-C0p-RvAv.js";import"./FormContainer-CRCGjzPK.js";import{C as O,b as z}from"./Tag-B0NQn_RJ.js";import{B as w,I as _}from"./hoist-non-react-statics.cjs-cUo1Cl8P.js";import{e as K}from"./Upload-DHAPp7cu.js";import{S as R}from"./Select-CIt2DWNP.js";import{t as D,N as I}from"./toast-DbLB5wf5.js";import{af as V,R as W,ag as G,J}from"./Views-EyuaPkMR.js";import{S as X,h as Q}from"./html2canvas.esm-CGLqisQT.js";import"./index-Cx2beVKs.js";const Z=({department:t})=>{const a=(s,r)=>{const o=s.split(" ");return o.slice(0,r).join(" ")+(o.length>r?"...":"")};return e.jsxs("div",{className:"lg:flex items-center justify-between mb-4 gap-3",children:[e.jsxs("div",{className:"mb-4 lg:mb-0 w-3/4",children:[e.jsx("h3",{children:"Monthly Performance Review"}),e.jsx("p",{children:"This form is used to keep track of appraiseesâ€™ monthly performance and is meant to support them in achieving their agreed targets by helping to identify areas where improvements may be required during the appraisal year."})]}),e.jsxs("div",{children:[e.jsx("h5",{children:t.department_name}),e.jsx("p",{children:a(t.department_description,5)})]})]})},ee=()=>{const t=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],[a,s]=n.useState(null),r=q();n.useEffect(()=>{const l=new Date().getMonth()+1,d=t.find(f=>f.value===l)||null,u=(d==null?void 0:d.value)||null;s(u),r(H(l))},[]);const o=l=>{const d=(l==null?void 0:l.value)??null;s(d),d!==null&&r(H(d))};return e.jsx(e.Fragment,{children:e.jsx(O,{bordered:!0,className:"mb-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-6",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("h6",{className:"text-xl font-semibold text-gray-800",children:"Appraisal Period Covered"})}),e.jsx("div",{className:"lg:w-1/3",children:e.jsx(R,{size:"sm",placeholder:"Please Select",options:t,value:t.find(l=>l.value===a),className:"w-full border border-gray-300 rounded-lg shadow-sm",onChange:o})})]})})})},te=({supervisor:t})=>{const a=[{key:"Surname:",value:t.L_Name||"N/A"},{key:"Firstname:",value:t.F_Name||"N/A"},{key:"Othername:",value:t.M_Name||"N/A"},{key:"IPPIS No:",value:t.ippis_no||"N/A"},{key:"Phone No:",value:t.phone||"N/A"},{key:"Designation:",value:t.role||"N/A"},{key:"email",value:t.email||"N/A"}];return e.jsxs(O,{bordered:!0,className:"mb-4",children:[e.jsx("div",{className:"mb-4 flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{children:"Supervisor Information"})})})})}),e.jsx("div",{className:"columns-3xs",children:a.map((s,r)=>e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-full text-black font-bold mb-2",children:s.key}),e.jsx("div",{className:"text-left w-full",children:s.value?s.value:"N/A"})]},r))})]})},se=({staff:t})=>{const a=[{key:"Surname:",value:t.L_Name||"N/A"},{key:"Firstname:",value:t.F_Name||"N/A"},{key:"Othername:",value:t.M_Name||"N/A"},{key:"IPPIS No:",value:t.ippis_no||"N/A"},{key:"Phone No:",value:t.phone||"N/A"},{key:"Designation:",value:t.role||"N/A"},{key:"email",value:t.email||"N/A"}];return e.jsxs(O,{bordered:!0,className:"mb-4",children:[e.jsx("div",{className:"mb-4 flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{children:"Employee Information"})})})})}),e.jsx("div",{className:"columns-3xs",children:a.map((s,r)=>e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-full text-black font-bold mb-2",children:s.key}),e.jsx("div",{className:"text-left w-full",children:s.value?s.value:"N/A"})]},r))})]})},ae=()=>{const t=[{key:"Surname:",value:"test"},{key:"Firstname:",value:"Officer"},{key:"Othername:",value:""},{key:"IPPIS No:",value:"00001"},{key:"Designation:",value:"officer"}];return e.jsxs(O,{bordered:!0,className:"mb-4",children:[e.jsx("div",{className:"mb-4 flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{children:e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{children:"Counter-Signing Officer's Information "})})})})}),e.jsx("div",{className:"md:grid grid-rows-2 grid-flow-col",children:t.map((a,s)=>e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-full text-black font-bold mb-2",children:a.key}),e.jsx("div",{className:"text-left w-full",children:a.value?a.value:"N/A"})]},s))})]})},re=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 3 : CURRENT RESPONSIBILITIES"})})})}),le=async(t,a,s,r,o)=>{try{return await F({url:`/supervisor/monthly_peroformance_review?department_id=${t}&team_id=${a}&year=${s}&month=${r}&staff_id=${o}`,method:"get"})}catch(l){throw console.error("Error fetching information data:",l),l}},ne=async t=>{try{return await F({url:"/supervisor/extra_mpr",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})}catch(a){throw console.error("Error fetching information data:",a),a}},ie=async t=>{try{return await F({url:"/supervisor/monthly_peroformance_review",method:"post",data:t})}catch(a){throw console.error("Error fetching information data:",a),a}},ce=async(t,a,s,r)=>{try{return await F({url:`/supervisor/form_mpr_comments?department_id=${t}&team_id=${a}&year=${s}&staff_id=${r}`,method:"get"})}catch(o){throw console.error("Error fetching information data:",o),o}},oe=async t=>{try{return await F({url:"/supervisor/form_mpr_comments",method:"post",data:t})}catch(a){throw console.error("Error fetching information data:",a),a}},{Tr:$,Th:T,Td:A,THead:de,TBody:me}=z,ue=({kpi:t,existing_data:a})=>{const{id:s}=M(),r=U(i=>i.mprf.selectedMonth),o=n.useMemo(()=>t.kra||{},[t]),l=n.useMemo(()=>t.target||{},[t]),[d,u]=n.useState([]);n.useEffect(()=>{if(a.length>0)u(a);else{const i=Object.keys(o).map(c=>({kra_id:parseInt(c,10),kpi:o[c]||"No KPI",performance_expectation:l[c]??"-",start_date:"-",end_date:"-",output_status:"",issues:""}));u(i)}},[a,o,l]);const f=(i,c,p)=>{u(x=>x.map(j=>j.kra_id===i?{...j,[c]:p}:j))},g=async()=>{const i={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),staff_id:s,month:r,current_resposibilities:d.map(c=>{var p,x;return{kra_id:c.kra_id,start_date:c.start_date,end_date:c.end_date,output_status:((p=c.output_status)==null?void 0:p.trim())||null,issues:((x=c.issues)==null?void 0:x.trim())||null}})};try{(await ie(i)).status===200&&D.push(e.jsx(I,{title:"Success",type:"success",children:"Data added successfully!"}),{placement:"top-center"})}catch{D.push(e.jsx(I,{title:"Error",type:"danger",children:"Something went wrong. Please try again."}),{placement:"top-center"})}console.log("Saved Data:",i)};return e.jsxs("div",{className:"mt-2",children:[e.jsxs(z,{compact:!0,className:"border border-gray-300",children:[e.jsx(de,{className:"bg-gray-200",children:e.jsxs($,{children:[e.jsx(T,{className:"border border-gray-300",children:"KPI"}),e.jsx(T,{className:"border border-gray-300",children:"Performance Expectations"}),e.jsx(T,{className:"border border-gray-300",children:"Start Date"}),e.jsx(T,{className:"border border-gray-300",children:"Due Date"}),e.jsx(T,{className:"border border-gray-300",children:"Output Status"}),e.jsx(T,{className:"border border-gray-300",children:"Remarks"})]})}),e.jsx(me,{children:d.length===0?e.jsx($,{children:e.jsx(A,{colSpan:6,className:"text-center",children:"No data found !!"})}):d.map(i=>e.jsxs($,{children:[e.jsx(A,{className:"border border-gray-300",children:i.kpi}),e.jsx(A,{className:"border border-gray-300 text-center",children:i.performance_expectation}),e.jsx(A,{className:"border border-gray-300 text-center",children:i.start_date==="-"||!i.start_date?"N/A":i.start_date}),e.jsx(A,{className:"border border-gray-300 text-center",children:i.end_date==="-"||!i.end_date?"N/A":i.end_date}),e.jsx(A,{className:"border border-gray-300",children:e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-md text-sm",value:i.output_status||"",onChange:c=>f(i.kra_id,"output_status",c.target.value)})}),e.jsx(A,{className:"border border-gray-300",children:e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-md text-sm",value:i.issues||"",onChange:c=>f(i.kra_id,"issues",c.target.value)})})]},i.kra_id))})]}),e.jsx("div",{className:"text-right mt-4",children:e.jsx(w,{variant:"solid",color:"green-700",onClick:g,children:"Save"})})]})},ge=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 7 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),xe=({comments:t,onAppraisersCommentChange:a,showValidationError:s})=>{var d;const[r,o]=n.useState("");n.useEffect(()=>{const u=t.staff.comment||"";o(u),a(u)},[t.staff.comment]);const l=u=>{const f=u.target.value;o(f),a(f)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(_,{textArea:!0,disabled:!0,className:"input-textarea mt-2",value:t.staff.comment||""})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(_,{textArea:!0,placeholder:"Text area example",value:r,className:`input-textarea mt-2 ${s&&!r?"border-red-500":""}`,onChange:l}),s&&!r&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(V,{className:"mr-1"}),"This field is required."]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx(_,{disabled:!0,textArea:!0,value:((d=t.officer)==null?void 0:d.comment)||"",className:"input-textarea mt-2"})]})]})},he=({Staff:t})=>{const a=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],s=a.find(r=>r.value===(t==null?void 0:t.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(R,{isDisabled:!0,id:"declaration",value:s,options:a,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(_,{disabled:!0,id:"date",value:(t==null?void 0:t.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraiser"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:t!=null&&t.signature?e.jsx("img",{src:t.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},L=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],pe=({Supervisor:t,onChange:a})=>{const[s,r]=n.useState(null),[o,l]=n.useState(null),[d,u]=n.useState(null),[f,g]=n.useState(null),[i,c]=n.useState(!1),[p,x]=n.useState(0),j=n.useRef(null),b=n.useRef(null),v=n.useRef(null);n.useEffect(()=>{t&&(r(t.declaration),u(t.signature),l(t.date?new Date(t.date):null),x((t.signature,0)))},[t]);const C=m=>{var N;const h=(N=m.target.files)==null?void 0:N[0];if(h){if(h.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!h.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const S=new FileReader;S.onloadend=()=>{const P=S.result;u(P),g(h.name),x(1)},S.readAsDataURL(h)}},y=()=>{c(!0)},E=async()=>{if(b.current&&!b.current.isEmpty()){if(v.current){const h=(await Q(v.current)).toDataURL("image/png");u(h),x(1),c(!1)}}else alert("Please draw a signature before saving.")},k=()=>{var m;(m=b.current)==null||m.clear()};return n.useEffect(()=>{const m=o!==null?new Date(o.getFullYear(),o.getMonth(),o.getDate()+1):null,h={declaration:s,date:m,flag:p};p===1&&(h.signature=d),a(h)},[s,o,d,p]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Declaration:"}),e.jsx(R,{placeholder:"Please Select",options:L,className:"mt-2",value:L.find(m=>m.value===s),onChange:m=>r((m==null?void 0:m.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(K,{className:"mt-2",value:o,onChange:m=>l(m)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(w,{variant:"solid",size:"xs",icon:e.jsx(W,{}),className:"cursor-pointer",onClick:y,children:"Add Signature"}),e.jsx(w,{variant:"solid",size:"xs",icon:e.jsx(G,{}),className:"cursor-pointer ",onClick:()=>{var m;return(m=j.current)==null?void 0:m.click()},children:"Upload"}),e.jsx("input",{ref:j,type:"file",accept:"image/*",className:"hidden",onChange:C})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),d&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:d,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>c(!1),children:e.jsx(J,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:v,className:" rounded-md mt-4 bg-white",children:e.jsx(X,{ref:b,canvasProps:{width:330,height:150,className:"sigCanvas "}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(w,{size:"sm",variant:"default",onClick:k,children:"Clear"}),e.jsx(w,{size:"sm",variant:"solid",onClick:E,children:"Save"})]})]})})]})},fe=({officer:t})=>{const a=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],s=a.find(r=>r.value===(t==null?void 0:t.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(R,{isDisabled:!0,id:"declaration",value:s,options:a,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(_,{disabled:!0,id:"date",value:(t==null?void 0:t.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Countersigning Officer's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:t!=null&&t.signature?e.jsx("img",{src:t.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},je=()=>{var C,y,E,k,m,h;const{id:t}=M(),a=B(),[s,r]=n.useState(),[o,l]=n.useState(!0),[d,u]=n.useState(null),[f,g]=n.useState(""),[i,c]=n.useState(!1),p=async()=>{try{const N=localStorage.getItem("selectedDepartmentID")||"",S=localStorage.getItem("selectedTeamID"),P=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),Y=await ce(N,S?Number(S):null,P,String(t));if(Y&&Y.data)r(Y.data);else throw new Error("Invalid response data")}catch(N){console.error("Error fetching data:",N),u("Failed to load data. Please try again.")}finally{l(!1)}};n.useEffect(()=>{p()},[]);const[x,j]=n.useState({declaration:null,date:null,signature:null,flag:0}),b=async()=>{if(!f.trim()){c(!0),D.push(e.jsx(I,{title:"Error",type:"danger",children:"Appraisers 's Comments is reuired"}),{placement:"top-center"});return}try{const N=x.date instanceof Date?x.date.toISOString().split("T")[0]:null,S={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),comment:f,date:N,signature:x.signature,declaration:x.declaration,flag:x.flag,staff_id:t};(await oe(S)).status===200?D.push(e.jsx(I,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):D.push(e.jsx(I,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(N){console.error("Error submitting data:",N),D.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to submit data. Please check your connection and try again."}),{placement:"top-center"})}},v=()=>{a(-1)};return o?e.jsx("div",{children:"Loading..."}):d?e.jsx("div",{className:"text-red-500",children:d}):e.jsxs("div",{className:"mt-4  mx-auto w-full ",children:[e.jsx(ge,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(xe,{comments:{staff:((C=s==null?void 0:s.comments)==null?void 0:C.staff)||{comment:""},supervisor:((y=s==null?void 0:s.comments)==null?void 0:y.supervisor)||{comment:""},officer:((E=s==null?void 0:s.comments)==null?void 0:E.officer)||{comment:""}},showValidationError:i,onAppraisersCommentChange:g})}),e.jsx("div",{className:"mt-4",children:e.jsx(he,{Staff:(k=s==null?void 0:s.comments)==null?void 0:k.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(pe,{Supervisor:(m=s==null?void 0:s.comments)==null?void 0:m.supervisor,onChange:N=>{j(N)}})}),e.jsx("div",{className:"mt-4",children:e.jsx(fe,{officer:(h=s==null?void 0:s.comments)==null?void 0:h.officer})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4 mt-10",children:[e.jsx(w,{variant:"solid",className:"w-full sm:w-auto",onClick:v,children:"Back"}),e.jsx(w,{variant:"solid",className:"w-full sm:w-auto",onClick:b,children:"Save"})]})]})},Ne=({extra_details:t})=>{const a=U(g=>g.mprf.selectedMonth),{id:s}=M(),[r,o]=n.useState({outstanding_performance:(t==null?void 0:t.outstanding_performance)||"",areas_of_improvement:(t==null?void 0:t.areas_of_improvement)||"",training_needs:(t==null?void 0:t.training_needs)||"",future_goals:(t==null?void 0:t.future_goals)||""}),[l,d]=n.useState({outstanding_performance:"",areas_of_improvement:"",training_needs:"",future_goals:""}),u=(g,i)=>{o(c=>({...c,[g]:i})),d(c=>({...c,[g]:""}))},f=async()=>{const g={outstanding_performance:r.outstanding_performance?"":"This field is required.",areas_of_improvement:r.areas_of_improvement?"":"This field is required.",training_needs:r.training_needs?"":"This field is required.",future_goals:r.future_goals?"":"This field is required."};if(d(g),Object.values(g).some(v=>v))return;const c=localStorage.getItem("selectedDepartmentID")||"",p=localStorage.getItem("selectedTeamID"),x=localStorage.getItem("selectedYear")||new Date().getFullYear().toString(),j=a,b={staff_id:s||"",department_id:c,team_id:p?Number(p):null,year:x,month:j,outstandiing_performance:r.outstanding_performance,areas_of_improvement:r.areas_of_improvement,training_needs:r.training_needs,future_goals:r.future_goals};try{(await ne(b)).status===200&&D.push(e.jsx(I,{title:"Success",type:"success",children:"Data added successfully!"}),{placement:"top-center"})}catch{D.push(e.jsx(I,{title:"Error",type:"danger",children:"Something went wrong. Please try again."}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"rounded-md bg-green-700 text-white p-2 mb-2",children:e.jsx("div",{className:"text-sm font-semibold",children:"Section 4: OUTSTANDING PERFORMANCE IDENTIFIED WITHIN THE REVIEW PERIOD"})}),e.jsx(_,{textArea:!0,className:`input-textarea mt-2 h-24 ${l.outstanding_performance?"border-2 border-red-500":""}`,placeholder:"Enter Text",value:r.outstanding_performance,onChange:g=>u("outstanding_performance",g.target.value)}),l.outstanding_performance&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.outstanding_performance})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"rounded-md bg-green-700 text-white p-2 mb-2",children:e.jsx("div",{className:"text-sm font-semibold",children:"Section 5: AREAS OF IMPROVEMENTS REQUIRED"})}),e.jsx(_,{textArea:!0,className:`input-textarea mt-2 h-24 ${l.areas_of_improvement?"border-2 border-red-500":""}`,placeholder:"Enter Text",value:r.areas_of_improvement,onChange:g=>u("areas_of_improvement",g.target.value)}),l.areas_of_improvement&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.areas_of_improvement})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"rounded-md bg-green-700 text-white p-2 mb-2",children:e.jsx("div",{className:"text-sm font-semibold",children:"Section 6: TRAINING NEEDS"})}),e.jsx(_,{textArea:!0,className:`input-textarea mt-2 h-24 ${l.training_needs?"border-2 border-red-500":""}`,placeholder:"Enter Training Need",value:r.training_needs,onChange:g=>u("training_needs",g.target.value)}),l.training_needs&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.training_needs})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"rounded-md bg-green-700 text-white p-2 mb-2",children:e.jsx("div",{className:"text-sm font-semibold",children:"Section 7: FUTURE GOALS AND SET EXPECTATIONS"})}),e.jsx(_,{textArea:!0,className:`input-textarea mt-2 h-24 ${l.future_goals?"border-2 border-red-500":""}`,placeholder:"Enter Text",value:r.future_goals,onChange:g=>u("future_goals",g.target.value)}),l.future_goals&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.future_goals})]}),e.jsx("div",{className:"text-right mt-4",children:e.jsx(w,{variant:"solid",color:"green-700",onClick:f,children:"Save"})})]})},Ce=()=>{const{id:t}=M(),a=U(y=>y.mprf.selectedMonth),[s,r]=n.useState(null),[o,l]=n.useState(null),[d,u]=n.useState([]),[f,g]=n.useState({}),[i,c]=n.useState(!0),[p,x]=n.useState(null),j=async()=>{try{const y=localStorage.getItem("selectedDepartmentID")||"",E=localStorage.getItem("selectedTeamID"),k=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),m=await le(y,E?Number(E):null,k,a,String(t));if(m!=null&&m.data){const h=m.data;r(h.initial_data),l(h.kpis),u(h.existing_data),g(h.extra_details)}else throw new Error("Invalid response")}catch(y){console.error("Error fetching data:",y),x("Failed to load data. Please try again.")}finally{c(!1)}};if(n.useEffect(()=>{j()},[a]),i)return e.jsx("div",{children:"Loading..."});if(p)return e.jsx("div",{className:"text-red-500",children:p});if(!s)return null;const{department:b,supervisor:v,staff:C}=s;return e.jsxs("div",{children:[e.jsx(Z,{department:b}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-4",children:[e.jsx(ee,{}),e.jsx(te,{supervisor:v})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-4",children:[e.jsx(se,{staff:C}),e.jsx(ae,{})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(re,{}),e.jsx(ue,{kpi:o,existing_data:d})]}),e.jsx(Ne,{extra_details:f}),e.jsx(je,{})]})};export{Ce as default};

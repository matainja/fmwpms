import{r as o,j as e,p as y,W as D,u as b,a as S,q as C}from"./index-wWf852Ik.js";import{d as I}from"./Department-Co7GT1D9.js";import"./FormContainer-D1g8rKO9.js";import{C as L}from"./Tag-CEdhY7rh.js";import{I as E}from"./hoist-non-react-statics.cjs-DtiQhq0b.js";import{P,b as A}from"./Upload-DCiQBwz_.js";import"./Select-D8BtPrxW.js";import"./toast-C_uKvaxB.js";import{K as M,E as O}from"./Views-Bx7dTT1E.js";import"./SvgIcon-M4Lqzcjs.js";import{U as k}from"./UsersAvatarGroup-Bl7zfofE.js";import"./index-hq6mG_IV.js";import"./quill.snow-CcszUxl5.js";import"./cloneDeep-DznBgb_t.js";import"./useThemeClass-PN5gOg17.js";import"./acronym-DZUARodl.js";const w=({progression:t})=>{const[s,n]=o.useState(!1),a=o.useMemo(()=>t>70?{color:"green-500"}:t<40?{color:"red-500"}:{},[t]);return e.jsxs("div",{className:"relative w-full",children:[s&&e.jsxs("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 px-2 py-1 text-xs text-white bg-gray-800 rounded-lg shadow-lg whitespace-nowrap",role:"tooltip",children:["Overall Progress",e.jsx("div",{className:"absolute bottom-[-4px] left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-800 rotate-45"})]}),e.jsx("div",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:e.jsx(P,{size:"sm",percent:t,...a})})]})},F=({members:t})=>e.jsx(k,{users:t}),z=({data:t})=>{const{department_id:s,name:n,description:a,progresive:c,teams_assigned:i}=t,[p,m]=o.useState(!1),[l,h]=o.useState(window.innerWidth<=1024),x=y(),d=D(s);o.useEffect(()=>{const r=()=>{h(window.innerWidth<=1024)};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]);const g=()=>{if(!d){console.error("Failed to encrypt department ID");return}localStorage.setItem("selectedDepartmentID",s),x(`/departmentlist/${d}`)},N=n.split(" ").slice(0,7).join(" "),u=a.split(" "),f=u.length>15,v=u.slice(0,15).join(" "),j=()=>m(r=>!r);return e.jsxs(e.Fragment,{children:[e.jsx(L,{bodyClass:"h-full",className:"bg-[#018752] hover:bg-green-800 hover:-translate-y-1 transition-all duration-300 cursor-pointer",onClick:g,children:e.jsxs("div",{className:"flex flex-col justify-between h-full",children:[e.jsx("h6",{className:"text-white",children:N}),e.jsxs("p",{className:"mt-4 break-all text-white",children:[f?`${v}...`:a,f&&e.jsx("button",{className:"text-blue-400 hover:underline ml-1",onClick:r=>{r.stopPropagation(),j()},children:"View All"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx(w,{progression:c}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx(F,{members:i.map(r=>({name:r.name,image:""}))}),e.jsxs("div",{className:"flex items-center px-2 py-1 border border-gray-300 rounded-full bg-white",children:[e.jsx(M,{className:"text-base"}),e.jsx("span",{className:"ml-1 rtl:mr-1 whitespace-nowrap",children:i.length})]})]})]})]})}),e.jsx(A,{title:"Department Details",isOpen:p,placement:"right",width:l?"100%":600,onClose:j,children:e.jsxs("div",{className:"p-6 bg-gray-200 rounded-md shadow-md",children:[e.jsx("h6",{className:"text-xl font-bold text-gray-800",children:n}),e.jsx("p",{className:"mt-3 text-gray-600 leading-relaxed",children:a}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h6",{className:"text-lg font-medium text-gray-700",children:"Progress"}),e.jsx(w,{progression:c})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h6",{className:"text-lg font-medium text-gray-700",children:"Teams Assigned"}),i.length>0?e.jsx("ul",{className:"mt-3 space-y-2",children:i.map(r=>e.jsxs("li",{className:"flex items-center space-x-3 bg-white p-3 rounded-md shadow-sm border border-gray-200 hover:shadow-md transition-all",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-500 flex items-center justify-center text-white font-semibold",children:r.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"text-gray-800 font-medium",children:r.name})]},r.team_id))}):e.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"No teams assigned."})]})]})})]})},_=({departmentData:t})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:t.map(s=>e.jsx(z,{data:s},s.department_id))})}),T=({search:t,onChangeSearch:s})=>{const{userName:n}=b(a=>a.auth.user);return e.jsxs("div",{className:"flex flex-col gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col items-center text-center gap-2",children:[e.jsx("h1",{className:"text-[#020048] font-extrabold text-4xl  tracking-tight",children:"Welcome"}),e.jsx("h2",{className:"text-[#242424] text-2xl font-semibold",children:n}),e.jsx("div",{className:"w-2/4 h-[2px] bg-gray-300 rounded-full"}),e.jsx("p",{className:"text-base text-[#3c3b3b] max-w-xl  leading-relaxed",children:"Click on your department to access your Performance Appraisal Forms."})]}),e.jsxs("div",{className:"w-full mt-10 flex flex-col lg:flex-row items-center justify-between gap-4",children:[e.jsx("div",{className:"text-xl font-bold text-green-800 border-b-2 border-yellow-400 pb-1",children:"My Departments"}),e.jsx(E,{size:"sm",placeholder:"Search departments...",value:t,prefix:e.jsx(O,{className:"text-lg text-gray-500"}),className:"w-full max-w-sm border-green-800 focus:border-green-700 focus:ring-2 focus:ring-green-700 transition",onChange:a=>s(a.target.value)})]})]})},te=()=>{const t=S(),s=b(l=>l.department.departments),[n,a]=o.useState(""),[c,i]=o.useState(!1);o.useEffect(()=>{const l=async()=>{var x;const h=localStorage.getItem("selectedYear")||new Date().getFullYear().toString();try{i(!0);const g=((x=(await I(h)).data)==null?void 0:x.department_details)||[];t(C(g))}catch(d){console.error("Failed to fetch departments:",d)}finally{i(!1)}};s.length===0&&l()},[s,t]);const p=l=>{a(l)},m=s.filter(l=>l.name.toLowerCase().includes(n.toLowerCase()));return e.jsxs("div",{children:[e.jsx(T,{search:n,onChangeSearch:p}),c?e.jsx("p",{className:"text-gray-500 mt-4 text-sm",children:"Loading departments..."}):m.length>0?e.jsx(_,{departmentData:m,loading:c}):e.jsx("p",{className:"text-red-500 mt-4",children:"No departments available"})]})};export{te as default};

import{j as e,p as h,r as n,J as b,u as j}from"./index-DxYrGPuB.js";import{F as w}from"./FromPreview-B9aP6I_L.js";import"./FormContainer-gQGx1Dsz.js";import{C as v,A as P}from"./Tag-BddxHN8B.js";import{B as S}from"./hoist-non-react-statics.cjs-Ci2CuKH8.js";import{P as N}from"./Upload-Ck9jiP_Q.js";import"./Select-xF-sg4aH.js";import"./toast-DqtlumJS.js";import{L as c}from"./Views-CqBX4VKw.js";import{g as y}from"./FormList-CkjX1Ir5.js";import"./SvgIcon-CxecnIM0.js";import"./index-C5oRzy9o.js";import"./quill.snow-BsEul1hU.js";import"./cloneDeep-DznBgb_t.js";import"./useThemeClass-OagxHL70.js";const F=({title:o,describe:d,showButtom:t,buttonText:s,buttonClick:g})=>e.jsxs("div",{className:"lg:flex items-center justify-between mb-4 gap-3",children:[e.jsxs("div",{className:"mb-4 lg:mb-0",children:[e.jsx("h3",{children:o}),e.jsx("p",{children:d})]}),t&&e.jsx("div",{children:e.jsx(S,{className:"mr-2 mb-2",variant:"solid",color:"green-600",onClick:g,children:s})})]}),k=({staffId:o})=>{const d=h(),[t,s]=n.useState(null),[g,u]=n.useState(!1),[m,f]=n.useState(null);if(n.useEffect(()=>{(async()=>{if(!o){console.warn("No staffId available, skipping fetch.");return}try{u(!0),f(null);const a=localStorage.getItem("selectedDepartmentID")||"",i=localStorage.getItem("selectedTeamID"),r=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),x=await y(a,i?Number(i):null,r,o);if(x&&x.data)s(x.data.data);else throw new Error("Invalid response data")}catch(a){console.error("Error fetching data:",a),f("Failed to load data. Please try again.")}finally{u(!1)}})()},[o]),g)return e.jsx(b,{loading:!0});if(m)return e.jsx("div",{className:"text-red-500",children:m});if(!t)return e.jsx("div",{children:"No data available."});const p=[{icon:"/img/others/qulity.png",title:"FORM - A",label:"Employee Performance Contract",progress:[{title:"STAFF",percentage:t.staff.form_a||0,color:"yellow-500"},{title:"SUPERVISOR",percentage:t.supervisor.form_a||0,color:"yellow-500"}],link:`${c}/planning`,background:"bg-blue-500",textColor:"text-white"},{icon:"/img/others/qulity.png",title:"FORM - B",label:"Employee Quarterly Appraisal",progress:[{title:"STAFF",percentage:t.staff.form_b||0,color:"blue-500"},{title:"SUPERVISOR",percentage:t.supervisor.form_b||0,color:"blue-500"}],link:`${c}/review`,background:"bg-green-500",textColor:"text-white"},{icon:"/img/others/qulity.png",title:"FORM - C",label:"Employee Annual Appraisal",progress:[{title:"STAFF",percentage:t.staff.form_c||0,color:"green-500"},{title:"SUPERVISOR",percentage:t.supervisor.form_c||0,color:"green-500"}],link:`${c}/annual-review`,background:"bg-orange-500",textColor:"text-white"}];return e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map((l,a)=>e.jsx(v,{clickable:!0,className:`hover:shadow-lg transition duration-150 ease-in-out ${l.background}`,onClick:()=>l.link&&d(l.link),children:e.jsxs("div",{className:`flex flex-col lg:flex-row lg:items-center justify-between gap-4 ${l.textColor}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("img",{src:l.icon,alt:"icon",className:"w-12 h-12 object-contain"}),e.jsxs("div",{children:[e.jsx("h6",{className:l.textColor,children:l.title}),e.jsx("span",{children:l.label})]})]}),e.jsx("div",{className:"flex justify-center gap-4",children:l.progress.map((i,r)=>e.jsxs("div",{children:[e.jsx(N,{variant:"circle",percent:i.percentage,color:i.color,width:60}),e.jsx("div",{className:"text-xs",children:i.title})]},r))})]})},a))})},I=()=>{const o=h(),d=[{icon:"/img/others/qulity.png",title:"Performance Appraisal Dispute Form (PADF)",label:"",progress:[],link:`${c}/padf`,background:"bg-blue-500",textColor:"text-white"},{icon:"/img/others/qulity.png",title:"Performance Improvement Plan (PIP)",label:"",progress:[],link:`${c}/Performance-Improvement-Plan`,background:"bg-green-500",textColor:"text-white"},{icon:"/img/others/qulity.png",title:"Individual Development Plans Form (IDPF)",label:"",progress:[],link:`${c}/Individual-Development-Plans`,background:"bg-orange-500",textColor:"text-white"},{icon:"/img/others/qulity.png",title:"Monthly Performance Review Form (MPRF)",label:"",progress:[],link:`${c}/monthlyPerformancereview`,background:"bg-blue-500",textColor:"text-white"},{icon:"/img/others/qulity.png",title:"MPMS FORM",label:"",progress:[],link:`${c}/listmpms`,background:"bg-blue-500",textColor:"text-white"}];return e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map((t,s)=>e.jsx(e.Fragment,{children:e.jsx(v,{clickable:!0,className:`hover:shadow-lg transition duration-150 ease-in-out ${t.background}`,onClick:()=>{t.link&&o(t.link)},children:e.jsx("div",{className:`flex flex-col lg:flex-row lg:items-center justify-between gap-4 ${t.textColor}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{children:e.jsx("img",{src:t.icon,alt:"icon"})}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center",children:e.jsx("h6",{className:`${t.textColor}`,children:t.title})}),e.jsx("div",{children:e.jsx("span",{children:t.label})})]})]})})},s)}))})},U=()=>{const{avatar:o,userName:d}=j(l=>l.auth.user),t=localStorage.getItem("selectedYear")||new Date().getFullYear(),[s,g]=n.useState(null),[u,m]=n.useState(null),[f,p]=n.useState(null);return console.log("staffID:",f),n.useEffect(()=>{g(t)},[t]),n.useEffect(()=>{(async()=>{try{if(s){const a=`formPreview_${s}`,i=localStorage.getItem(a);if(i){const r=JSON.parse(i);m(r),p(r.staff_id),console.log("staff_id:",r.staff_id),console.log("Loaded from localStorage:",r)}else{const r=await w(s);m(r),p(r.staff_id),localStorage.setItem(a,JSON.stringify(r)),console.log("staff_id:",r.staff_id),console.log("Fetched from API:",r)}}else console.log("No year selected")}catch(a){console.error("Failed to fetch form preview:",a)}})()},[s]),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(P,{size:40,shape:"circle",src:o||"/img/avatars/No_user.jpeg"}),e.jsx("div",{className:"ms-4",children:e.jsx("h3",{children:d})})]}),e.jsx("div",{children:e.jsx(k,{staffId:f})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(F,{title:"Other PMS Resources",describe:"",showButtom:!1}),e.jsx(I,{})]})]})};export{U as default};

import{a0 as L,r as i,j as e,a2 as te,p as se,u as ae}from"./index-DxYrGPuB.js";import{F as ce,H as ne,I as oe}from"./FooterButtonpart-D9olLap1.js";import{B as T,I as q}from"./hoist-non-react-statics.cjs-Ci2CuKH8.js";import{b as Y}from"./Upload-Ck9jiP_Q.js";import{ae as z}from"./Views-CqBX4VKw.js";import{b as h}from"./Tag-BddxHN8B.js";import"./FormContainer-gQGx1Dsz.js";import"./Select-xF-sg4aH.js";import{t as M,N as A}from"./toast-DqtlumJS.js";import{A as de}from"./AcknowledgementLayout-C1UuvXcw.js";import"./index-BPz91XzU.js";import"./Evidence-Bn3HDt4s.js";import"./html2canvas.esm-CLIajFEY.js";import"./index-C5oRzy9o.js";const le=async(s,t,o,n)=>{try{return await L({url:`/form_c?department_id=${s}&team_id=${t}&year=${o}&quater=${n}`,method:"get"})}catch(d){throw console.error("Error fetching information data:",d),d}},ie=async(s,t,o)=>{try{const n=await L({url:`/form_c_comments?department_id=${s}&team_id=${t}&year=${o}`,method:"get"});return console.log(n),n}catch(n){throw console.error("Error fetching information data:",n),n}},me=async s=>{try{const t=await L({url:"/form_c_comments",method:"post",data:s});return console.log(t),t}catch(t){throw console.error("Error fetching information data:",t),t}},{Tr:G,Th:Q,Td:V,THead:xe,TBody:he}=h,ge=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],pe=()=>{const[s,t]=i.useState(!1),[o,n]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const r=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]);const d=()=>t(!0),c=()=>t(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(T,{variant:"twoTone",size:"xs",icon:e.jsx(z,{}),"aria-label":"View Scoring Criteria Values",onClick:d,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(Y,{title:"Scoring Criteria",isOpen:s,placement:"right",width:o?"100%":800,onClose:c,onRequestClose:c,children:e.jsxs(h,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx(xe,{children:e.jsxs(G,{className:"bg-gray-100",children:[e.jsx(Q,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(Q,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(he,{children:ge.map((r,a)=>e.jsxs(G,{children:[e.jsx(V,{className:"border border-gray-300 p-2",children:r.grade}),e.jsx(V,{className:"border border-gray-300 p-2",children:r.description})]},a))})]})})]})},{Tr:H,Th:be,Td:m,THead:ue,TBody:je}=h,ye=s=>{const t=s.reduce((d,c)=>d+c.kra_weight,0),o=s.reduce((d,c)=>d+c.objectives.reduce((r,a)=>r+a.gradeed_weight,0),0),n=s.reduce((d,c)=>d+c.objectives.reduce((r,a)=>r+a.quater_markes,0),0);return{totalWeight:t,totalGradeWeight:o,totalScore:n}},fe=({employee_task:s})=>e.jsx("div",{className:"mt-2",children:Object.entries(s).map(([t,o])=>{const{totalWeight:n,totalGradeWeight:d,totalScore:c}=ye(o);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(T,{className:"mr-2",variant:"solid",children:["Quarter ",t]})}),e.jsxs(h,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(ue,{children:e.jsx(H,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Graded Weight","KPIs","Unit of Measurement","Target Set","Target Achieved","Score","Raw","Weighted"].map((r,a)=>e.jsx(be,{className:"border border-gray-400",children:r},a))})}),e.jsxs(je,{children:[o.map((r,a)=>e.jsx(te.Fragment,{children:r.objectives.map((l,x)=>e.jsxs(H,{children:[x===0&&e.jsxs(e.Fragment,{children:[e.jsx(m,{rowSpan:r.objectives.length,className:"border border-gray-400 p-2 text-center",children:a+1}),e.jsx(m,{rowSpan:r.objectives.length,className:"border border-gray-400 p-2",children:r.kra_name}),e.jsx(m,{rowSpan:r.objectives.length,className:"border border-gray-400 p-2 text-center",children:r.kra_weight})]}),e.jsx(m,{className:"border border-gray-400 p-2 break-all",children:l.objective_name}),e.jsx(m,{className:"border border-gray-400 p-2 text-center",children:l.gradeed_weight}),e.jsx(m,{className:"border border-gray-400 p-2",children:l.kpi}),e.jsx(m,{className:"border border-gray-400 p-2 text-center",children:l.unit}),e.jsx(m,{className:"border border-gray-400 p-2 text-center",children:l.target}),e.jsx(m,{className:"border border-gray-400 p-2 text-center",children:l.target_achieved}),e.jsx(m,{className:"border border-gray-400 p-2 text-center",children:l.quater_markes}),e.jsx(m,{className:"border border-gray-400 p-2 text-center",children:l.raw}),e.jsx(m,{className:"border border-gray-400 p-2 text-center",children:l.weighted})]},l.id))},r.kra_id)),e.jsxs(H,{className:"font-semibold bg-gray-100",children:[e.jsx(m,{colSpan:2,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(m,{className:"border border-gray-400 text-center",children:Math.round(n)}),e.jsx(m,{colSpan:1,className:"border border-gray-400"}),e.jsx(m,{className:"border border-gray-400 text-center",children:Math.round(d)}),e.jsx(m,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(m,{colSpan:3,className:"border border-gray-400 text-center",children:c})]})]})]})]},t)})}),{Tr:K,Th:U,Td:J,THead:Ne,TBody:we}=h,Te=({isOpen:s,setIsOpen:t})=>{const[o,n]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const c=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]);const d=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."}];return e.jsx(Y,{isOpen:s,title:"Performance Rating Scale",width:o?"100%":750,onClose:()=>t(!1),children:e.jsxs(h,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(Ne,{children:e.jsxs(K,{className:"bg-gray-100",children:[e.jsx(U,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(U,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(we,{children:d.map(c=>e.jsxs(K,{children:[e.jsx(J,{className:"border border-gray-300 p-2",children:c.title}),e.jsx(J,{className:"border border-gray-300 p-2",children:c.desc})]},c.id))})]})})},Se=()=>{const[s,t]=i.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(T,{variant:"twoTone",size:"xs",icon:e.jsx(z,{}),onClick:()=>t(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(Te,{isOpen:s,setIsOpen:t})]})},{Tr:F,Th:N,Td:p,THead:ve,TBody:Ee}=h,De=({competencies:s})=>e.jsx("div",{className:"mt-2",children:Object.entries(s).map(([t,o])=>{const n=o.reduce((r,a)=>r+a.competencies_details.reduce((l,x)=>l+x.max_score,0),0),d=o.reduce((r,a)=>r+a.competencies_details.reduce((l,x)=>l+x.quarter_marks,0),0),c=n>0?d/n*20:0;return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(T,{className:"mr-2",variant:"solid",children:["Quarter ",t]})}),e.jsxs(h,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(ve,{children:e.jsxs(F,{className:"bg-gray-200",children:[e.jsx(N,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(N,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(N,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(N,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(N,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(N,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(N,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Quarter Marks"})]})}),e.jsxs(Ee,{children:[o.map(r=>r.competencies_details.map((a,l)=>e.jsxs(F,{children:[e.jsx(p,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:r.competencies}),e.jsx(p,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:a.cluster}),e.jsx(p,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:a.sub_cluster}),e.jsx(p,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:a.describe_expectations}),e.jsx(p,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:a.max_score}),e.jsx(p,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:a.min_score}),e.jsx(p,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:a.quarter_marks})]},`${r.id}-${l}`))),e.jsxs(F,{className:"bg-gray-100 font-bold",children:[e.jsx(p,{colSpan:5,className:"border border-gray-400 p-2 text-right",children:"Total"}),e.jsx(p,{colSpan:2,className:"border border-gray-400 p-2 text-center",children:c.toFixed(2)})]})]})]})]},t)})}),{Tr:D,Th:X,Td:u,THead:Ie,TBody:_e}=h,$e=()=>{const[s,t]=i.useState(!1),[o,n]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const r=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]);const d=()=>{t(!0)},c=r=>{console.log("onDrawerClose",r),t(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(T,{variant:"twoTone",size:"xs",icon:e.jsx(z,{}),onClick:()=>d(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(Y,{title:"Performance Rating Scale  ",isOpen:s,width:o?"100%":750,onClose:c,onRequestClose:c,children:e.jsxs(h,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(Ie,{children:e.jsxs(D,{className:"bg-gray-100",children:[e.jsx(X,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(X,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs(_e,{children:[e.jsxs(D,{children:[e.jsx(u,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(u,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(D,{children:[e.jsx(u,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(u,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(D,{children:[e.jsx(u,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(u,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(D,{children:[e.jsx(u,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(u,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:W,Th:I,Td:j,THead:ke,TBody:Oe}=h,Ce=({operation_and_process:s})=>{const t=o=>{const n=o.reduce((r,a)=>r+a.details.reduce((l,x)=>l+x.max_score,0),0),d=o.reduce((r,a)=>r+a.details.reduce((l,x)=>l+x.quarter_marks,0),0),c=n>0?parseFloat((d/n*10).toFixed(2)):0;return{totalMaxScore:n,totalQuarterMarks:d,competencyMarks:c}};return e.jsx("div",{className:"mt-2",children:Object.keys(s).map(o=>{const n=s[o],{competencyMarks:d}=t(n);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(T,{className:"mr-2",variant:"solid",children:["Quarter ",o]})}),e.jsxs(h,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(ke,{children:e.jsxs(W,{className:"bg-gray-200",children:[e.jsx(I,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx(I,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx(I,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx(I,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx(I,{className:"border border-gray-400 p-2 text-center",children:"Quarter Marks"})]})}),e.jsxs(Oe,{children:[n.map((c,r)=>c.details.map(a=>e.jsxs(W,{children:[e.jsx(j,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:c.operations_and_process}),e.jsx(j,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:a.describe_expectations}),e.jsx(j,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:a.min_score}),e.jsx(j,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:a.max_score}),e.jsx(j,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:a.quarter_marks})]},`${r}-${a.id}`))),e.jsxs(W,{className:"font-semibold bg-gray-100",children:[e.jsx(j,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(j,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(j,{colSpan:2,className:"border border-gray-400 text-center",children:d})]})]})]})]},o)})})},{Tr:Z,Th:ee,Td:re,THead:Me,TBody:Ae}=h,Pe=[{label:"sub-total rating of appraisee performance (expectations and goals from section 3)",value:191.425},{label:"sub-total rating of appraisee performance (competencies) in section 4",value:29.3},{label:"sub-total rating of appraisee performance (operations and processes) section 5",value:22.158},{label:"overall rating (section 3 + 4 + 5)",value:242.883},{label:"overall annual score",value:60.72075}],Re=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"section 6 : SUMMARY OF OVERALL ASSESSMENT"})})}),e.jsxs(h,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left bg-white",children:[e.jsx(Me,{children:e.jsxs(Z,{className:"bg-gray-100",children:[e.jsx(ee,{className:"border border-gray-300 p-2",children:"overall assessment"}),e.jsx(ee,{className:"border border-gray-300 p-2",children:"appraiser rating"})]})}),e.jsx(Ae,{children:Pe.map((s,t)=>e.jsxs(Z,{children:[e.jsx(re,{className:"border border-gray-300 p-2",children:s.label}),e.jsx(re,{className:"border border-gray-300 p-2 text-center",children:s.value})]},t))})]})]}),Be=({assesment:s,improvement:t})=>e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-semibold text-black",children:"What are the employee’s strengths?"}),e.jsx(q,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:s||"What are the employee’s strengths?"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"font-semibold text-black",children:"What are the employee’s areas for improvement?"}),e.jsx(q,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:t||"What are the employee’s areas for improvement?"})]})]}),He=()=>{const s=se(),[t,o]=i.useState(null),[n,d]=i.useState(!0),[c,r]=i.useState(null),[a,l]=i.useState([]),[x,_]=i.useState(""),[$,S]=i.useState(!1),P=async()=>{try{const b=localStorage.getItem("selectedDepartmentID")||"",g=localStorage.getItem("selectedTeamID"),C=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),w=await ie(b,g?Number(g):null,C);if(w&&w.data)o(w.data);else throw new Error("Invalid response data")}catch(b){console.error("Error fetching data:",b),r("Failed to load data. Please try again.")}finally{d(!1)}};i.useEffect(()=>{P()},[]);const[y,R]=i.useState({declaration:null,date:null,signature:null,flag:0}),v=i.useRef(null),k=async()=>{var b,g,C,w;if(!x.trim()){S(!0),(b=v.current)==null||b.scrollIntoView({behavior:"smooth",block:"center"}),(g=v.current)==null||g.focus(),M.push(e.jsx(A,{title:"Error",type:"danger",children:"Appraisee's Comments is required"}),{placement:"top-center"});return}S(!1);try{const E=y.date instanceof Date?y.date.toISOString().split("T")[0]:null,B={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),evidence_ids:a,comment:x,date:E,signature:y.signature,declaration:y.declaration,flag:y.flag};(await me(B)).status===200?M.push(e.jsx(A,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):M.push(e.jsx(A,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(E){const B=((w=(C=E.response)==null?void 0:C.data)==null?void 0:w.error)||E.message||"An unexpected error occurred.";M.push(e.jsx(A,{title:"Error",type:"danger",children:B}),{placement:"top-center"}),console.error("Error submitting data:",E)}},f=()=>{s(-1)},O=()=>{s("/dashboard")};return n?e.jsx("div",{children:"Loading..."}):c?e.jsx("div",{className:"text-red-500",children:c}):e.jsxs("div",{className:"mt-4 mx-auto w-full",children:[e.jsx(de,{data:t,commentInputRef:v,setSelectedEvidenceIds:l,setCommentText:_,showValidationError:$,setDeclarationData:R}),e.jsx(ce,{back:"Back",handleBack:f,save:"Save",handleSave:k,next:"Continue to Dashboard",handleNext:O})]})},rr=()=>{const s=ae(f=>f.quaterTab.selectedQuarter),[t,o]=i.useState(),[n,d]=i.useState(!0),[c,r]=i.useState(null),a=async()=>{try{const f=localStorage.getItem("selectedDepartmentID")||"",O=localStorage.getItem("selectedTeamID"),b=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),g=await le(f,O?Number(O):null,b,s);if(g&&g.data)o(g.data);else throw new Error("Invalid response data")}catch(f){console.error("Error fetching data:",f),r("Failed to load data. Please try again.")}finally{d(!1)}};if(i.useEffect(()=>{a()},[]),n)return e.jsx("div",{children:"Loading..."});if(c)return e.jsx("div",{className:"text-red-500",children:c});const{department:l,team:x,supervisor:_,officer:$,staff:S,progress:P,employee_task:y,competencies:R,operation_and_process:v,others:k}=t||{};return e.jsxs("div",{children:[e.jsx(ne,{department:l,team:x,progress:P,title:"Employee Annual Appraisal Document"}),S&&_&&$&&e.jsx(oe,{staff:S,supervisor:_,officer:$}),e.jsxs("div",{className:"mt-4",children:[e.jsx(pe,{}),e.jsx(fe,{employee_task:y})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Se,{}),e.jsx(De,{competencies:R})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx($e,{}),e.jsx(Ce,{operation_and_process:v})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Re,{}),e.jsx(Be,{assesment:k.strengths,improvement:k.improvement})]}),e.jsx(He,{})]})};export{rr as default};

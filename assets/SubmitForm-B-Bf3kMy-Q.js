import{j as e,a2 as te,r as i,$ as se,p as le,u as ne}from"./index-Duop_KdH.js";import{b as u}from"./Tag-DgqJbByg.js";import"./FormContainer-U6Zd3Ijx.js";import{B as S,I as R}from"./hoist-non-react-statics.cjs-DXV21P3t.js";import{b as W,e as ce}from"./Upload-B4cDWJBA.js";import{S as G}from"./Select-BXXsSDja.js";import{t as L,N as B}from"./toast-Dv3A6prH.js";import{ae as Y,af as de,R as ie,ag as oe,J as me}from"./Views-DZpW66OA.js";import{S as xe,h as ge}from"./html2canvas.esm-CUJyVBln.js";import{g as he}from"./Evidence-hp2ttUfE.js";import{F as ue,O as be,a as pe,H as je,I as Ne,b as fe}from"./FooterButtonpart-W5nVOmQy.js";import"./index-MjtOI9DB.js";import"./index-ccVXGkYV.js";const{Tr:H,Th:ye,Td:h,THead:ve,TBody:Se}=u,we=r=>{const l=r.reduce((d,c)=>d+c.kra_weight,0),s=r.reduce((d,c)=>d+c.objectives.reduce((a,n)=>a+n.gradeed_weight,0),0),t=r.reduce((d,c)=>d+c.objectives.reduce((a,n)=>a+n.quater_markes,0),0);return{totalWeight:l,totalGradeWeight:s,totalScore:t}},Te=({employee_task:r})=>e.jsx("div",{className:"mt-2",children:Object.entries(r).map(([l,s])=>{const{totalWeight:t,totalGradeWeight:d,totalScore:c}=we(s);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(S,{className:"mr-2",variant:"solid",children:["Quarter ",l]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(ve,{children:e.jsx(H,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Graded Weight","KPIs","Unit of Measurement","Target Set","Target Achieved","Score","Raw","Weighted"].map((a,n)=>e.jsx(ye,{className:"border border-gray-400",children:a},n))})}),e.jsxs(Se,{children:[s.map((a,n)=>e.jsx(te.Fragment,{children:a.objectives.map((o,g)=>e.jsxs(H,{children:[g===0&&e.jsxs(e.Fragment,{children:[e.jsx(h,{rowSpan:a.objectives.length,className:"border border-gray-400 p-2 text-center",children:n+1}),e.jsx(h,{rowSpan:a.objectives.length,className:"border border-gray-400 p-2",children:a.kra_name}),e.jsx(h,{rowSpan:a.objectives.length,className:"border border-gray-400 p-2 text-center",children:a.kra_weight})]}),e.jsx(h,{className:"border border-gray-400 p-2 break-all",children:o.objective_name}),e.jsx(h,{className:"border border-gray-400 p-2 text-center",children:o.gradeed_weight}),e.jsx(h,{className:"border border-gray-400 p-2",children:o.kpi}),e.jsx(h,{className:"border border-gray-400 p-2 text-center",children:o.unit}),e.jsx(h,{className:"border border-gray-400 p-2 text-center",children:o.target}),e.jsx(h,{className:"border border-gray-400 p-2 text-center",children:o.target_achieved}),e.jsx(h,{className:"border border-gray-400 p-2 text-center",children:o.quater_markes}),e.jsx(h,{className:"border border-gray-400 p-2 text-center",children:o.raw}),e.jsx(h,{className:"border border-gray-400 p-2 text-center",children:o.weighted})]},o.id))},a.kra_id)),e.jsxs(H,{className:"font-semibold bg-gray-100",children:[e.jsx(h,{colSpan:2,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(h,{className:"border border-gray-400 text-center",children:Math.round(t)}),e.jsx(h,{colSpan:1,className:"border border-gray-400"}),e.jsx(h,{className:"border border-gray-400 text-center",children:Math.round(d)}),e.jsx(h,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(h,{colSpan:3,className:"border border-gray-400 text-center",children:c})]})]})]})]},l)})}),{Tr:Q,Th:q,Td:V,THead:Ee,TBody:Ce}=u,De=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],Oe=()=>{const[r,l]=i.useState(!1),[s,t]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const a=()=>{t(window.innerWidth<=1024)};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const d=()=>l(!0),c=()=>l(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(S,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),"aria-label":"View Scoring Criteria Values",onClick:d,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(W,{title:"Scoring Criteria",isOpen:r,placement:"right",width:s?"100%":800,onClose:c,onRequestClose:c,children:e.jsxs(u,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx(Ee,{children:e.jsxs(Q,{className:"bg-gray-100",children:[e.jsx(q,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(q,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(Ce,{children:De.map((a,n)=>e.jsxs(Q,{children:[e.jsx(V,{className:"border border-gray-300 p-2",children:a.grade}),e.jsx(V,{className:"border border-gray-300 p-2",children:a.description})]},n))})]})})]})},{Tr:K,Th:X,Td:J,THead:Ae,TBody:Ie}=u,Re=({isOpen:r,setIsOpen:l})=>{const[s,t]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const c=()=>{t(window.innerWidth<=1024)};return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]);const d=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."}];return e.jsx(W,{isOpen:r,title:"Performance Rating Scale",width:s?"100%":750,onClose:()=>l(!1),children:e.jsxs(u,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(Ae,{children:e.jsxs(K,{className:"bg-gray-100",children:[e.jsx(X,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(X,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(Ie,{children:d.map(c=>e.jsxs(K,{children:[e.jsx(J,{className:"border border-gray-300 p-2",children:c.title}),e.jsx(J,{className:"border border-gray-300 p-2",children:c.desc})]},c.id))})]})})},ke=()=>{const[r,l]=i.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(S,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),onClick:()=>l(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(Re,{isOpen:r,setIsOpen:l})]})},{Tr:z,Th:I,Td:v,THead:_e,TBody:Fe}=u,Pe=({competencies:r})=>e.jsx("div",{className:"mt-2",children:Object.entries(r).map(([l,s])=>{const t=s.reduce((a,n)=>a+n.competencies_details.reduce((o,g)=>o+g.max_score,0),0),d=s.reduce((a,n)=>a+n.competencies_details.reduce((o,g)=>o+g.quarter_marks,0),0),c=t>0?d/t*20:0;return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(S,{className:"mr-2",variant:"solid",children:["Quarter ",l]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(_e,{children:e.jsxs(z,{className:"bg-gray-200",children:[e.jsx(I,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(I,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(I,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(I,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(I,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(I,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(I,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Quarter Marks"})]})}),e.jsxs(Fe,{children:[s.map(a=>a.competencies_details.map((n,o)=>e.jsxs(z,{children:[e.jsx(v,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:a.competencies}),e.jsx(v,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:n.cluster}),e.jsx(v,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:n.sub_cluster}),e.jsx(v,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:n.describe_expectations}),e.jsx(v,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:n.max_score}),e.jsx(v,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:n.min_score}),e.jsx(v,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:n.quarter_marks})]},`${a.id}-${o}`))),e.jsxs(z,{className:"bg-gray-100 font-bold",children:[e.jsx(v,{colSpan:5,className:"border border-gray-400 p-2 text-right",children:"Total"}),e.jsx(v,{colSpan:2,className:"border border-gray-400 p-2 text-center",children:c.toFixed(2)})]})]})]})]},l)})}),{Tr:P,Th:Z,Td:C,THead:Me,TBody:$e}=u,Le=()=>{const[r,l]=i.useState(!1),[s,t]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const a=()=>{t(window.innerWidth<=1024)};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const d=()=>{l(!0)},c=a=>{console.log("onDrawerClose",a),l(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(S,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),onClick:()=>d(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(W,{title:"Performance Rating Scale  ",isOpen:r,width:s?"100%":750,onClose:c,onRequestClose:c,children:e.jsxs(u,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(Me,{children:e.jsxs(P,{className:"bg-gray-100",children:[e.jsx(Z,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(Z,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs($e,{children:[e.jsxs(P,{children:[e.jsx(C,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(C,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(P,{children:[e.jsx(C,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(C,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(P,{children:[e.jsx(C,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(C,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(P,{children:[e.jsx(C,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(C,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:U,Th:M,Td:D,THead:Be,TBody:He}=u,ze=({operation_and_process:r})=>{const l=s=>{const t=s.reduce((a,n)=>a+n.details.reduce((o,g)=>o+g.max_score,0),0),d=s.reduce((a,n)=>a+n.details.reduce((o,g)=>o+g.quarter_marks,0),0),c=t>0?parseFloat((d/t*10).toFixed(2)):0;return{totalMaxScore:t,totalQuarterMarks:d,competencyMarks:c}};return e.jsx("div",{className:"mt-2",children:Object.keys(r).map(s=>{const t=r[s],{competencyMarks:d}=l(t);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(S,{className:"mr-2",variant:"solid",children:["Quarter ",s]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Be,{children:e.jsxs(U,{className:"bg-gray-200",children:[e.jsx(M,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx(M,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx(M,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx(M,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx(M,{className:"border border-gray-400 p-2 text-center",children:"Quarter Marks"})]})}),e.jsxs(He,{children:[t.map((c,a)=>c.details.map(n=>e.jsxs(U,{children:[e.jsx(D,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:c.operations_and_process}),e.jsx(D,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:n.describe_expectations}),e.jsx(D,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:n.min_score}),e.jsx(D,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:n.max_score}),e.jsx(D,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:n.quarter_marks})]},`${a}-${n.id}`))),e.jsxs(U,{className:"font-semibold bg-gray-100",children:[e.jsx(D,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(D,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(D,{colSpan:2,className:"border border-gray-400 text-center",children:d})]})]})]})]},s)})})},{Tr:$,Th:ee,Td:O,THead:Ue,TBody:We}=u,Ge=({overall_assesment:r})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-4 w-full mb-4",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 6: SUMMARY OF OVERALL ASSESSMENT (10%)"})})}),e.jsx("div",{className:"mt-2",children:Object.entries(r).map(([l,s])=>{const t=Array.isArray(s)?s[0]:s;return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx(S,{className:"mr-2",variant:"solid",children:l==="overall_assessment"?"Overall Assessment":`Quarter ${l}`})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Ue,{children:e.jsxs($,{className:"bg-gray-200",children:[e.jsx(ee,{className:"border border-gray-400 p-2",children:"Overall Assessment"}),e.jsx(ee,{className:"border border-gray-400 p-2 text-center",children:"Appraiser Rating"})]})}),e.jsxs(We,{children:[e.jsxs($,{children:[e.jsx(O,{className:"border border-gray-400 p-2",children:"SUB-TOTAL RATING OF APPRAISEE PERFORMANCE (EXPECTATIONS AND GOALS FROM SECTION 3)"}),e.jsx(O,{className:"border border-gray-400 p-2 text-center",children:(t==null?void 0:t.sub_total_rating_expectations)??"-"})]}),e.jsxs($,{children:[e.jsx(O,{className:"border border-gray-400 p-2",children:"SUB-TOTAL RATING OF APPRAISEE PERFORMANCE (COMPETENCIES) IN SECTION 4"}),e.jsx(O,{className:"border border-gray-400 p-2 text-center",children:(t==null?void 0:t.sub_total_rating_competencies)??"-"})]}),e.jsxs($,{children:[e.jsx(O,{className:"border border-gray-400 p-2",children:"SUB-TOTAL RATING OF APPRAISEE PERFORMANCE (OPERATIONS AND PROCESSES) SECTION 5"}),e.jsx(O,{className:"border border-gray-400 p-2 text-center",children:(t==null?void 0:t.sub_total_rating_operations)??"-"})]}),e.jsxs($,{children:[e.jsx(O,{className:"border border-gray-400 p-2",children:"OVERALL RATING (SECTION 3 + 4 + 5)"}),e.jsx(O,{className:"border border-gray-400 p-2 text-center",children:(t==null?void 0:t.overall_rating)??"-"})]})]})]})]},l)})})]}),Ye=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 6 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),Qe=({comments:r,onOfficerCommentChange:l,showValidationError:s,commentInputRef:t})=>{var n,o;const[d,c]=i.useState("");i.useEffect(()=>{var N;const g=((N=r.officer)==null?void 0:N.comment)||"";c(g),l(g)},[(n=r.officer)==null?void 0:n.comment,l]);const a=g=>{const N=g.target.value;c(N),l(N)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(R,{disabled:!0,textArea:!0,value:((o=r.supervisor)==null?void 0:o.comment)||"",className:"input-textarea mt-2"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(R,{disabled:!0,textArea:!0,value:r.supervisor.comment||"",className:"input-textarea mt-2"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx(R,{required:!0,ref:t,textArea:!0,value:d,placeholder:"Enter your comments here",className:`textarea mt-2 w-full rounded-md border px-3 py-2 focus:outline-none ${s&&!d?"border-red-500":"border-gray-300"}`,onChange:a}),s&&!d&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(de,{className:"mr-1"}),"This field is required."]})]})]})},qe=({Supervisor:r})=>{const l=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],s=l.find(t=>t.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraisee's Declaration :"}),e.jsx(G,{isDisabled:!0,id:"declaration",value:s,options:l,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(R,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraisee's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},Ve=({staff:r})=>{const l=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],s=l.find(t=>t.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(G,{isDisabled:!0,id:"declaration",value:s,options:l,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(R,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraiser's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraiser"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},re=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],Ke=({officer:r,onChange:l})=>{const[s,t]=i.useState(null),[d,c]=i.useState(null),[a,n]=i.useState(null),[o,g]=i.useState(null),[N,y]=i.useState(!1),[j,w]=i.useState(0),k=i.useRef(null),f=i.useRef(null),A=i.useRef(null);i.useEffect(()=>{r&&(t(r.declaration),n(r.signature),c(r.date?new Date(r.date):null),w((r.signature,0)))},[r]);const _=m=>{var T;const x=(T=m.target.files)==null?void 0:T[0];if(x){if(x.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!x.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const E=new FileReader;E.onloadend=()=>{const ae=E.result;n(ae),g(x.name),w(1)},E.readAsDataURL(x)}},F=()=>{y(!0)},b=async()=>{if(f.current&&!f.current.isEmpty()){if(A.current){const x=(await ge(A.current)).toDataURL("image/png");n(x),w(1),y(!1)}}else alert("Please draw a signature before saving.")},p=()=>{var m;(m=f.current)==null||m.clear()};return i.useEffect(()=>{const m=d!==null?new Date(d.getFullYear(),d.getMonth(),d.getDate()+1):null,x={declaration:s,date:m,flag:j};j===1&&(x.signature=a),l(x)},[s,d,a,j]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Declaration:"}),e.jsx(G,{placeholder:"Please Select",options:re,className:"mt-2",value:re.find(m=>m.value===s),onChange:m=>t((m==null?void 0:m.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(ce,{className:"mt-2",value:d,onChange:m=>c(m)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:F,children:[e.jsx(ie,{className:"w-5 h-5"}),"Add Signature"]}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:()=>{var m;return(m=k.current)==null?void 0:m.click()},children:[e.jsx(oe,{className:"w-5 h-5"}),"Upload"]}),e.jsx("input",{ref:k,type:"file",accept:"image/*",className:"hidden",onChange:_})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),a&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:a,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>y(!1),children:e.jsx(me,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:A,className:" rounded-md mt-4 bg-white",children:e.jsx(xe,{ref:f,canvasProps:{width:330,height:150,className:"sigCanvas"}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(S,{size:"sm",variant:"default",onClick:p,children:"Clear"}),e.jsx(S,{size:"sm",variant:"solid",onClick:b,children:"Save"})]})]})})]})},Xe=({submittedEvidence:r})=>{if(!r||r.length===0)return e.jsx("p",{className:"text-gray-500",children:"No submitted evidence available."});const l=async s=>{try{const d=(await he(s)).data,c=URL.createObjectURL(d);window.open(c,"_blank")}catch(t){console.error("Error fetching evidence data:",t)}};return e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Submitted Evidence:"}),e.jsx("div",{className:"flex flex-col gap-4",children:r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"text-blue-600 underline max-w-[250px] truncate cursor-pointer",onClick:()=>l(s.evidence_id),children:s.evidence_id}),e.jsx("div",{className:"flex-1 text-right",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:[e.jsx("strong",{children:"Created:"})," ",new Date(s.created_at).toLocaleDateString()]})})]},s.id))})]})},Je=()=>{const{id:r}=se(),l=le(),[s,t]=i.useState(null),[d,c]=i.useState(!0),[a,n]=i.useState(null),[o,g]=i.useState(""),[N,y]=i.useState(!1),[j,w]=i.useState({declaration:null,date:null,signature:null,flag:0}),k=async()=>{try{const b=localStorage.getItem("selectedDepartmentID")||"",p=localStorage.getItem("selectedTeamID"),m=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),x=await be(b,p?Number(p):null,m,String(r));if(x&&x.data)t(x.data);else throw new Error("Invalid response data")}catch(b){console.error("Error fetching data:",b),n("Failed to load data. Please try again.")}finally{c(!1)}};i.useEffect(()=>{k()},[]);const f=i.useRef(null),A=async()=>{var b,p,m;if(!o.trim()){y(!0),(b=f.current)==null||b.scrollIntoView({behavior:"smooth",block:"center"}),L.push(e.jsx(B,{title:"Error",type:"danger",children:"Appraisee's Comments is required"}),{placement:"top-center"});return}y(!1);try{const x=j.date instanceof Date?j.date.toISOString().split("T")[0]:null,T={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),staff_id:r,comment:o,date:x,signature:j.signature,declaration:j.declaration,flag:j.flag};(await pe(T)).status===200?L.push(e.jsx(B,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):L.push(e.jsx(B,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(x){const T=((m=(p=x.response)==null?void 0:p.data)==null?void 0:m.error)||x.message||"An unexpected error occurred.";L.push(e.jsx(B,{title:"Error",type:"danger",children:T}),{placement:"top-center"}),console.error("Error submitting data:",x)}},_=()=>{l(-1)},F=()=>{l("/dashboard")};return d?e.jsx("div",{children:"Loading..."}):a?e.jsx("div",{className:"text-red-500",children:a}):s?e.jsxs("div",{className:"mt-4 mx-auto w-full",children:[e.jsx(Ye,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(Xe,{submittedEvidence:s.comments.staff.evidence||[]})}),e.jsx("div",{className:"mt-4",children:e.jsx(Qe,{commentInputRef:f,comments:{staff:s.comments.staff||{comment:""},supervisor:s.comments.supervisor||{comment:""},officer:s.comments.officer||{comment:""}},showValidationError:N,onOfficerCommentChange:g})}),e.jsx("div",{className:"mt-4",children:e.jsx(qe,{Supervisor:s.comments.supervisor})}),e.jsx("div",{className:"mt-4",children:e.jsx(Ve,{staff:s.comments.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(Ke,{officer:s.comments.officer,onChange:b=>w(b)})})]}),e.jsx(ue,{back:"Back",handleBack:_,save:"Save",handleSave:A,next:"Continue to Dashboard",handleNext:F})]}):e.jsx("div",{children:"No data available."})},Ze=({assesment:r,improvement:l})=>e.jsxs("div",{children:[e.jsx("div",{className:"mt-2",children:e.jsx(R,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:r||"What are the employee’s strengths?"})}),e.jsx("div",{className:"mt-2",children:e.jsx(R,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:l||"What are the employee’s areas for improvement?"})})]}),gr=()=>{const{id:r}=se(),l=ne(p=>p.quaterTab.selectedQuarter),[s,t]=i.useState(null),[d,c]=i.useState(!0),[a,n]=i.useState(null),o=async()=>{try{const p=localStorage.getItem("selectedDepartmentID")||"",m=localStorage.getItem("selectedTeamID"),x=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),T=r,E=await fe(p,m?Number(m):null,x,l,String(T));if(E&&E.data)t(E.data);else throw new Error("Invalid response data")}catch(p){console.error("Error fetching data:",p),n("Failed to load data. Please try again.")}finally{c(!1)}};if(i.useEffect(()=>{o()},[]),d)return e.jsx("div",{children:"Loading..."});if(a)return e.jsx("div",{className:"text-red-500",children:a});const{department:g,team:N,supervisor:y,officer:j,staff:w,progress:k,employee_task:f,competencies:A,operation_and_process:_,overall_assesment:F,others:b}=s||{};return e.jsxs("div",{children:[e.jsx(je,{department:g,team:N,progress:k,title:"PERFORMANCE APPRAISAL",downloadButton:!0,staffID:r}),w&&y&&j&&e.jsx(Ne,{staff:w,supervisor:y,officer:j}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Oe,{}),f&&e.jsx(Te,{employee_task:f})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ke,{}),e.jsx(Pe,{competencies:A})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Le,{}),e.jsx(ze,{operation_and_process:_})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Ge,{overall_assesment:F}),e.jsx(Ze,{assesment:b.strengths,improvement:b.improvement})]}),e.jsx(Je,{})]})};export{gr as default};

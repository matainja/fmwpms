import{G as S,p as k,r as o,j as e}from"./index-BfaARDkR.js";import{R as C}from"./quill.snow-Bx78pTjh.js";import{q as M,t as U,v as P,F as b}from"./Tag-DS9JN-3h.js";import"./FormContainer-DntErVAM.js";import{I as R,B as w}from"./hoist-non-react-statics.cjs-AcStEq0h.js";import"./Upload-D8BOXKwX.js";import"./Select-D0nJFrsW.js";import{t as g,N as v}from"./toast-BBDaWVEO.js";import{p as B}from"./Evidence-viVuMdRW.js";import"./cloneDeep-DznBgb_t.js";import"./Views-DLeq2GbK.js";function I(m){return S({attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M13 10v-10h-13v13h13v-3zM1 1h11v8h-0.755l-2.564-3.319-1.159 1.214-2.248-3.881-3.576 5.986h-0.698v-8zM9.982 9h-7.119l2.398-4.014 2.064 3.564 1.275-1.337 1.382 1.787zM1 12v-2h11v2h-11zM17 3v13h-13v-1.984h1v0.984h11v-11h-2v-1h3z"},child:[]}]})(m)}const J=()=>{const m=k(),[p,x]=o.useState(""),[u,h]=o.useState(""),[a,f]=o.useState(null),[j,d]=o.useState(null),[n,l]=o.useState({name:"",description:"",file:""}),F=s=>{var c;const t=(c=s.target.files)==null?void 0:c[0];if(t){if(t.size>500*1024){alert("File size exceeds 500Kb. Please upload a smaller file.");return}if(f(t),l(i=>({...i,file:""})),t.type.startsWith("image/")){const i=new FileReader;i.onload=r=>{var y;(y=r.target)!=null&&y.result&&d(r.target.result)},i.readAsDataURL(t)}else d(t.name)}},N=s=>{const t=document.createElement("div");return t.innerHTML=s,t.textContent||t.innerText||""},z=()=>{const s={},t=N(u);return p.trim()||(s.name="Name is required."),t.trim()?t.split(/\s+/).filter(Boolean).length>100&&(s.description="Description cannot exceed 100 words."):s.description="Description is required.",l(s),Object.keys(s).length===0},D=async s=>{var c,i;if(s.preventDefault(),!z())return;const t=new FormData;t.append("name",p),t.append("description",N(u)),a&&t.append("file_path",a);try{const r=await B(t);r.status===201?(g.push(e.jsx(v,{title:"Success",type:"success",children:r.data.message}),{placement:"top-center"}),x(""),h(""),f(null),d(null),l({name:"",description:"",file:""}),m("/listofevidence")):(console.error("Error:",r.statusText),g.push(e.jsx(v,{title:"Error",type:"danger",children:"Something went wrong..."}),{placement:"top-center"}))}catch(r){console.error("Error submitting evidence:",r),g.push(e.jsx(v,{title:"Error",type:"danger",children:((i=(c=r==null?void 0:r.response)==null?void 0:c.data)==null?void 0:i.error)||"Failed to submit evidence."}),{placement:"top-center"})}},E=()=>{if(!a)return null;const s=a.type;return s.includes("pdf")?e.jsx(M,{size:50,className:"text-red-500"}):s.includes("word")?e.jsx(U,{size:50,className:"text-blue-500"}):s.includes("csv")?e.jsx(P,{size:50,className:"text-green-600"}):s.includes("text")?e.jsx(b,{size:50,className:"text-gray-500"}):e.jsx(b,{size:50,className:"text-gray-500"})};return e.jsx(e.Fragment,{children:e.jsxs("form",{className:"rounded-md",onSubmit:D,children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:"Add New Evidence"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-1 text-gray-700 dark:text-gray-200",children:"Name"}),e.jsx(R,{type:"text",placeholder:"Name",className:"w-full",value:p,onChange:s=>{x(s.target.value),l(t=>({...t,name:""}))}}),n.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1.5",children:n.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-1 text-gray-700 dark:text-gray-200",children:"Description"}),e.jsx("div",{className:"rich-text-editor",children:e.jsx(C,{theme:"snow",value:u,onChange:s=>{h(s),l(t=>({...t,description:""}))}})}),n.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1.5",children:n.description})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Upload File"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload an image, PDF, Word doc, or any file..."}),e.jsxs("label",{htmlFor:"file-upload",className:"flex items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-md w-full h-48 cursor-pointer text-center bg-gray-50 dark:bg-gray-800 overflow-hidden",children:[a?a.type.startsWith("image/")&&j?e.jsx("img",{src:j,alt:"Preview",className:"w-full h-full"}):e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[E(),e.jsx("p",{className:"mt-2 text-sm",children:a.name})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(I,{size:50})}),e.jsxs("p",{className:"font-bold",children:["Drop your file here, or"," ",e.jsx("span",{className:"text-blue-600",children:"browse"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Supported: jpg, png, pdf, docx, csv, txt"})]}),e.jsx("input",{id:"file-upload",type:"file",accept:"image/*,.pdf,.doc,.docx,.csv,.txt",className:"hidden",onChange:F})]}),n.file&&e.jsx("p",{className:"text-red-500 text-sm mt-1.5",children:n.file})]})]}),e.jsxs("div",{className:"flex justify-end mt-6 gap-3",children:[e.jsx(w,{onClick:()=>{x(""),h(""),f(null),d(null),l({name:"",description:"",file:""})},children:"Discard"}),e.jsx(w,{variant:"solid",type:"submit",children:"Save"})]})]})})};export{J as default};

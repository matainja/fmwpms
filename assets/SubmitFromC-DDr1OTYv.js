import{r as i,j as e,a2 as he,a0 as Z,$ as ge,p as ue,u as pe}from"./index-Duop_KdH.js";import{F as be,H as je,I as Ne}from"./FooterButtonpart-W5nVOmQy.js";import{B as v,I as R}from"./hoist-non-react-statics.cjs-DXV21P3t.js";import{b as Y,e as fe}from"./Upload-B4cDWJBA.js";import{ae as q,af as ye,R as ve,ag as we,J as Se}from"./Views-DZpW66OA.js";import{b as u,E as Te,q as Ee,x as Ce}from"./Tag-DgqJbByg.js";import"./FormContainer-U6Zd3Ijx.js";import{S as Q}from"./Select-BXXsSDja.js";import{t as U,N as G}from"./toast-Dv3A6prH.js";import{S as De,h as Oe}from"./html2canvas.esm-CUJyVBln.js";import{g as Ae}from"./Evidence-hp2ttUfE.js";import"./index-ccVXGkYV.js";import"./index-MjtOI9DB.js";const{Tr:te,Th:le,Td:ne,THead:Ie,TBody:_e}=u,ke=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],Re=()=>{const[s,t]=i.useState(!1),[r,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const l=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]);const a=()=>t(!0),n=()=>t(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(v,{variant:"twoTone",size:"xs",icon:e.jsx(q,{}),"aria-label":"View Scoring Criteria Values",onClick:a,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(Y,{title:"Scoring Criteria",isOpen:s,placement:"right",width:r?"100%":800,onClose:n,onRequestClose:n,children:e.jsxs(u,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx(Ie,{children:e.jsxs(te,{className:"bg-gray-100",children:[e.jsx(le,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(le,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(_e,{children:ke.map((l,d)=>e.jsxs(te,{children:[e.jsx(ne,{className:"border border-gray-300 p-2",children:l.grade}),e.jsx(ne,{className:"border border-gray-300 p-2",children:l.description})]},d))})]})})]})},{Tr:K,Th:Fe,Td:g,THead:$e,TBody:Pe}=u,Me=s=>{const t=s.reduce((a,n)=>a+n.kra_weight,0),r=s.reduce((a,n)=>a+n.objectives.reduce((l,d)=>l+d.gradeed_weight,0),0),c=s.reduce((a,n)=>a+n.objectives.reduce((l,d)=>l+d.quater_markes,0),0);return{totalWeight:t,totalGradeWeight:r,totalScore:c}},He=({employee_task:s})=>e.jsx("div",{className:"mt-2",children:Object.entries(s).map(([t,r])=>{const{totalWeight:c,totalGradeWeight:a,totalScore:n}=Me(r);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(v,{className:"mr-2",variant:"solid",children:["Quarter ",t]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx($e,{children:e.jsx(K,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Graded Weight","KPIs","Unit of Measurement","Target Set","Target Achieved","Score","Raw","Weighted"].map((l,d)=>e.jsx(Fe,{className:"border border-gray-400",children:l},d))})}),e.jsxs(Pe,{children:[r.map((l,d)=>e.jsx(he.Fragment,{children:l.objectives.map((o,m)=>e.jsxs(K,{children:[m===0&&e.jsxs(e.Fragment,{children:[e.jsx(g,{rowSpan:l.objectives.length,className:"border border-gray-400 p-2 text-center",children:d+1}),e.jsx(g,{rowSpan:l.objectives.length,className:"border border-gray-400 p-2",children:l.kra_name}),e.jsx(g,{rowSpan:l.objectives.length,className:"border border-gray-400 p-2 text-center",children:l.kra_weight})]}),e.jsx(g,{className:"border border-gray-400 p-2 break-all",children:o.objective_name}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:o.gradeed_weight}),e.jsx(g,{className:"border border-gray-400 p-2",children:o.kpi}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:o.unit}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:o.target}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:o.target_achieved}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:o.quater_markes}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:o.raw}),e.jsx(g,{className:"border border-gray-400 p-2 text-center",children:o.weighted})]},o.id))},l.kra_id)),e.jsxs(K,{className:"font-semibold bg-gray-100",children:[e.jsx(g,{colSpan:2,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(g,{className:"border border-gray-400 text-center",children:Math.round(c)}),e.jsx(g,{colSpan:1,className:"border border-gray-400"}),e.jsx(g,{className:"border border-gray-400 text-center",children:Math.round(a)}),e.jsx(g,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(g,{colSpan:3,className:"border border-gray-400 text-center",children:n})]})]})]})]},t)})}),{Tr:ce,Th:de,Td:ie,THead:Le,TBody:Be}=u,We=({isOpen:s,setIsOpen:t})=>{const[r,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const n=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const a=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."}];return e.jsx(Y,{isOpen:s,title:"Performance Rating Scale",width:r?"100%":750,onClose:()=>t(!1),children:e.jsxs(u,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(Le,{children:e.jsxs(ce,{className:"bg-gray-100",children:[e.jsx(de,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(de,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(Be,{children:a.map(n=>e.jsxs(ce,{children:[e.jsx(ie,{className:"border border-gray-300 p-2",children:n.title}),e.jsx(ie,{className:"border border-gray-300 p-2",children:n.desc})]},n.id))})]})})},ze=()=>{const[s,t]=i.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(v,{variant:"twoTone",size:"xs",icon:e.jsx(q,{}),onClick:()=>t(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(We,{isOpen:s,setIsOpen:t})]})},{Tr:X,Th:k,Td:y,THead:Ue,TBody:Ge}=u,Ye=({competencies:s})=>e.jsx("div",{className:"mt-2",children:Object.entries(s).map(([t,r])=>{const c=r.reduce((l,d)=>l+d.competencies_details.reduce((o,m)=>o+m.max_score,0),0),a=r.reduce((l,d)=>l+d.competencies_details.reduce((o,m)=>o+m.quarter_marks,0),0),n=c>0?a/c*20:0;return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(v,{className:"mr-2",variant:"solid",children:["Quarter ",t]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Ue,{children:e.jsxs(X,{className:"bg-gray-200",children:[e.jsx(k,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(k,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(k,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(k,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(k,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(k,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(k,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Quarter Marks"})]})}),e.jsxs(Ge,{children:[r.map(l=>l.competencies_details.map((d,o)=>e.jsxs(X,{children:[e.jsx(y,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:l.competencies}),e.jsx(y,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.cluster}),e.jsx(y,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.sub_cluster}),e.jsx(y,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.describe_expectations}),e.jsx(y,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.max_score}),e.jsx(y,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.min_score}),e.jsx(y,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.quarter_marks})]},`${l.id}-${o}`))),e.jsxs(X,{className:"bg-gray-100 font-bold",children:[e.jsx(y,{colSpan:5,className:"border border-gray-400 p-2 text-right",children:"Total"}),e.jsx(y,{colSpan:2,className:"border border-gray-400 p-2 text-center",children:n.toFixed(2)})]})]})]})]},t)})}),{Tr:H,Th:oe,Td:D,THead:qe,TBody:Qe}=u,Ve=()=>{const[s,t]=i.useState(!1),[r,c]=i.useState(window.innerWidth<=1024);i.useEffect(()=>{const l=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]);const a=()=>{t(!0)},n=l=>{console.log("onDrawerClose",l),t(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(v,{variant:"twoTone",size:"xs",icon:e.jsx(q,{}),onClick:()=>a(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(Y,{title:"Performance Rating Scale  ",isOpen:s,width:r?"100%":750,onClose:n,onRequestClose:n,children:e.jsxs(u,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(qe,{children:e.jsxs(H,{className:"bg-gray-100",children:[e.jsx(oe,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(oe,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs(Qe,{children:[e.jsxs(H,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(H,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(H,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(H,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:J,Th:L,Td:O,THead:Ke,TBody:Xe}=u,Je=({operation_and_process:s})=>{const t=r=>{const c=r.reduce((l,d)=>l+d.details.reduce((o,m)=>o+m.max_score,0),0),a=r.reduce((l,d)=>l+d.details.reduce((o,m)=>o+m.quarter_marks,0),0),n=c>0?parseFloat((a/c*10).toFixed(2)):0;return{totalMaxScore:c,totalQuarterMarks:a,competencyMarks:n}};return e.jsx("div",{className:"mt-2",children:Object.keys(s).map(r=>{const c=s[r],{competencyMarks:a}=t(c);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(v,{className:"mr-2",variant:"solid",children:["Quarter ",r]})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Ke,{children:e.jsxs(J,{className:"bg-gray-200",children:[e.jsx(L,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx(L,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx(L,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx(L,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx(L,{className:"border border-gray-400 p-2 text-center",children:"Quarter Marks"})]})}),e.jsxs(Xe,{children:[c.map((n,l)=>n.details.map(d=>e.jsxs(J,{children:[e.jsx(O,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:n.operations_and_process}),e.jsx(O,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400",children:d.describe_expectations}),e.jsx(O,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:d.min_score}),e.jsx(O,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:d.max_score}),e.jsx(O,{className:"px-4 py-2 text-sm text-gray-700 border border-gray-400 text-center",children:d.quarter_marks})]},`${l}-${d.id}`))),e.jsxs(J,{className:"font-semibold bg-gray-100",children:[e.jsx(O,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(O,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(O,{colSpan:2,className:"border border-gray-400 text-center",children:a})]})]})]})]},r)})})},{Tr:B,Th:me,Td:A,THead:Ze,TBody:er}=u,rr=({overall_assesment:s})=>{const t=s??{};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-4 w-full mb-4",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 6: SUMMARY OF OVERALL ASSESSMENT"})})}),e.jsx("div",{className:"mt-2",children:Object.entries(t).map(([r,c])=>{const a=Array.isArray(c)?c[0]:c;return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx(v,{className:"mr-2",variant:"solid",children:r==="overall_assessment"?"Overall Assessment":`Quarter ${r}`})}),e.jsxs(u,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Ze,{children:e.jsxs(B,{className:"bg-gray-200",children:[e.jsx(me,{className:"border border-gray-400 p-2",children:"Overall Assessment"}),e.jsx(me,{className:"border border-gray-400 p-2 text-center",children:"Appraiser Rating"})]})}),e.jsxs(er,{children:[e.jsxs(B,{children:[e.jsx(A,{className:"border border-gray-400 p-2",children:"SUB-TOTAL RATING OF APPRAISEE PERFORMANCE (EXPECTATIONS AND GOALS FROM SECTION 3)"}),e.jsx(A,{className:"border border-gray-400 p-2 text-center",children:(a==null?void 0:a.sub_total_rating_expectations)??"-"})]}),e.jsxs(B,{children:[e.jsx(A,{className:"border border-gray-400 p-2",children:"SUB-TOTAL RATING OF APPRAISEE PERFORMANCE (COMPETENCIES) IN SECTION 4"}),e.jsx(A,{className:"border border-gray-400 p-2 text-center",children:(a==null?void 0:a.sub_total_rating_competencies)??"-"})]}),e.jsxs(B,{children:[e.jsx(A,{className:"border border-gray-400 p-2",children:"SUB-TOTAL RATING OF APPRAISEE PERFORMANCE (OPERATIONS AND PROCESSES) SECTION 5"}),e.jsx(A,{className:"border border-gray-400 p-2 text-center",children:(a==null?void 0:a.sub_total_rating_operations)??"-"})]}),e.jsxs(B,{children:[e.jsx(A,{className:"border border-gray-400 p-2",children:"OVERALL RATING (SECTION 3 + 4 + 5)"}),e.jsx(A,{className:"border border-gray-400 p-2 text-center",children:(a==null?void 0:a.overall_rating)??"-"})]})]})]})]},r)})})]})},sr=({assesment:s,improvement:t})=>e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-semibold text-black",children:"What are the employee’s strengths?"}),e.jsx(R,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:s||"What are the employee’s strengths?"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"font-semibold text-black",children:"What are the employee’s areas for improvement?"}),e.jsx(R,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:t||"What are the employee’s areas for improvement?"})]})]}),ar=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 7 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),tr=({evidenceList:s=[],onChange:t})=>{const[r,c]=i.useState(!1),[a,n]=i.useState([]),l=Array.isArray(s)?s.map(m=>({label:m.name,value:m.evidence_id})):[],d=m=>{a.some(b=>b.value===m.evidence_id)||n(b=>[...b,{label:m.name,value:m.evidence_id}]),c(!1)},o=m=>{var b;const p=((b=m.split(".").pop())==null?void 0:b.toLowerCase())||"";return["jpg","jpeg","png","gif"].includes(p)?e.jsx(Te,{className:"w-8 h-8 text-blue-600"}):p==="pdf"?e.jsx(Ee,{className:"w-8 h-8 text-red-600"}):["xls","xlsx"].includes(p)?e.jsx(Ce,{className:"w-8 h-8 text-green-600"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"N/A"})};return i.useEffect(()=>{const m=a.map(p=>p.value);t(m)},[a,t]),e.jsxs("div",{className:"w-full sm:w-1/2 mb-4",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Evidence Information:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsx(Q,{isMulti:!0,placeholder:"Please Select",className:"w-full flex-1",options:l,value:a,onChange:n}),e.jsx(q,{className:"w-6 h-6 text-gray-500 hover:text-gray-700 cursor-pointer mt-1 sm:mt-0",onClick:()=>c(!0)}),e.jsx(Y,{title:"Evidence Details",isOpen:r,width:500,onClose:()=>c(!1),onRequestClose:()=>c(!1),children:e.jsx("div",{className:"space-y-4 p-4 max-w-full",children:Array.isArray(s)&&s.map(m=>e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-100 border-blue-500 flex flex-col sm:flex-row justify-between items-start sm:items-center cursor-pointer hover:bg-blue-50",onClick:()=>d(m),children:[e.jsxs("div",{className:"space-y-1 w-full sm:w-3/4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:m.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:m.description}),e.jsx("a",{href:m.file_path,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline mt-2 block text-sm font-bold",children:"View File"})]}),e.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-4",children:o(m.file_path)})]},m.id))})})]})]})},lr=({comments:s,onAppraisersCommentChange:t,showValidationError:r,commentInputRef:c})=>{var d;const[a,n]=i.useState("");i.useEffect(()=>{const o=s.staff.comment||"";n(o),t(o)},[s.staff.comment]);const l=o=>{const m=o.target.value;n(m),t(m)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(R,{textArea:!0,disabled:!0,className:"input-textarea mt-2",value:s.staff.comment||""})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(R,{required:!0,ref:c,textArea:!0,value:a,placeholder:"Enter your comments here",className:`textarea mt-2 w-full rounded-md border px-3 py-2 focus:outline-none ${r&&!a?"border-red-500":"border-gray-300"}`,onChange:l}),r&&!a&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(ye,{className:"mr-1"}),"This field is required."]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx(R,{disabled:!0,textArea:!0,value:((d=s.officer)==null?void 0:d.comment)||"",className:"input-textarea mt-2"})]})]})},nr=({Staff:s})=>{const t=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],r=t.find(c=>c.value===(s==null?void 0:s.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraisee's Declaration:"}),e.jsx(Q,{isDisabled:!0,id:"declaration",value:r,options:t,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(R,{disabled:!0,id:"date",value:(s==null?void 0:s.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraisee"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:s!=null&&s.signature?e.jsx("img",{src:s.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},xe=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],cr=({Supervisor:s,onChange:t,officerDeclaration:r})=>{const[c,a]=i.useState(null),[n,l]=i.useState(null),[d,o]=i.useState(null),[m,p]=i.useState(null),[b,w]=i.useState(!1),[S,I]=i.useState(0),N=i.useRef(null),T=i.useRef(null),E=i.useRef(null);i.useEffect(()=>{s&&(a(s.declaration),o(s.signature),l(s.date?new Date(s.date):null),I((s.signature,0)))},[s]);const j=x=>{var M;const h=(M=x.target.files)==null?void 0:M[0];if(h){if(h.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!h.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const $=new FileReader;$.onloadend=()=>{const W=$.result;o(W),p(h.name),I(1)},$.readAsDataURL(h)}},F=()=>{w(!0)},f=async()=>{if(T.current&&!T.current.isEmpty()){if(E.current){const h=(await Oe(E.current)).toDataURL("image/png");o(h),I(1),w(!1)}}else alert("Please draw a signature before saving.")},_=()=>{var x;(x=T.current)==null||x.clear()};return i.useEffect(()=>{const x=n!==null?new Date(n.getFullYear(),n.getMonth(),n.getDate()+1):null,h={declaration:c,date:x,flag:S};S===1&&(h.signature=d),t(h)},[c,n,d,S]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(Q,{isDisabled:r===1,placeholder:"Please Select",options:xe,className:"mt-2",value:xe.find(x=>x.value===c),onChange:x=>a((x==null?void 0:x.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(fe,{disabled:r===1,className:"mt-2",value:n,onChange:x=>l(x)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1",children:"Appraiser's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",disabled:r===1,className:`flex items-center gap-2 focus:outline-none text-white font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2
                ${r===1?"bg-gray-400 cursor-not-allowed":"bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300"}`,onClick:F,children:[e.jsx(ve,{className:"w-5 h-5"}),"Add Signature"]}),e.jsxs("button",{type:"button",disabled:r===1,className:`flex items-center gap-2 focus:outline-none text-white font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2
                ${r===1?"bg-gray-400 cursor-not-allowed":"bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300"}`,onClick:()=>{var x;return(x=N.current)==null?void 0:x.click()},children:[e.jsx(we,{className:"w-5 h-5"}),"Upload"]}),e.jsx("input",{ref:N,type:"file",accept:"image/*",className:"hidden",onChange:j})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),d&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:d,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>w(!1),children:e.jsx(Se,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:E,className:" rounded-md mt-4 bg-white",children:e.jsx(De,{ref:T,canvasProps:{width:330,height:150,className:"sigCanvas "}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(v,{size:"sm",variant:"default",onClick:_,children:"Clear"}),e.jsx(v,{size:"sm",variant:"solid",onClick:f,children:"Save"})]})]})})]})},dr=({officer:s})=>{const t=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],r=t.find(c=>c.value===(s==null?void 0:s.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Declaration:"}),e.jsx(Q,{isDisabled:!0,id:"declaration",value:r,options:t,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(R,{disabled:!0,id:"date",value:(s==null?void 0:s.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Countersigning Officer's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:s!=null&&s.signature?e.jsx("img",{src:s.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},ir=async(s,t,r,c,a)=>{try{return await Z({url:`/supervisor/form_c?department_id=${s}&team_id=${t}&year=${r}&staff_id=${c}&quater=${a}`,method:"get"})}catch(n){throw console.error("Error fetching information data:",n),n}},or=async(s,t,r,c)=>{try{const a=await Z({url:`/supervisor/form_c_comments?department_id=${s}&team_id=${t}&year=${r}&staff_id=${c}`,method:"get"});return console.log(a),a}catch(a){throw console.error("Error fetching information data:",a),a}},mr=async s=>{try{const t=await Z({url:"/supervisor/form_c_comments",method:"post",data:s});return console.log(t),t}catch(t){throw console.error("Error fetching information data:",t),t}},xr=({submittedEvidence:s})=>{if(!s||s.length===0)return e.jsx("p",{className:"text-gray-500",children:"No submitted evidence available."});const t=async r=>{try{const a=(await Ae(r)).data,n=URL.createObjectURL(a);window.open(n,"_blank")}catch(c){console.error("Error fetching evidence data:",c)}};return e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Submitted Evidence:"}),e.jsx("div",{className:"flex flex-col gap-4",children:s.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"text-blue-600 underline max-w-[250px] truncate cursor-pointer",onClick:()=>t(r.evidence_id),children:r.evidence_id}),e.jsx("div",{className:"flex-1 text-right",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:[e.jsx("strong",{children:"Created:"})," ",new Date(r.created_at).toLocaleDateString()]})})]},r.id))})]})},gr=()=>{var _,x,h,M,$,W,ee,re,se,ae;const{id:s}=ge(),t=ue(),[r,c]=i.useState(),[a,n]=i.useState(!0),[l,d]=i.useState(null),[o,m]=i.useState([]),[p,b]=i.useState(""),[w,S]=i.useState(!1),I=async()=>{try{const C=localStorage.getItem("selectedDepartmentID")||"",P=localStorage.getItem("selectedTeamID"),V=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),z=await or(C,P?Number(P):null,V,String(s));if(z&&z.data)c(z.data);else throw new Error("Invalid response data")}catch(C){console.error("Error fetching data:",C),d("Failed to load data. Please try again.")}finally{n(!1)}};i.useEffect(()=>{I()},[]);const[N,T]=i.useState({declaration:null,date:null,signature:null,flag:0}),E=i.useRef(null),j=async()=>{var C;if(!p.trim()){S(!0),(C=E.current)==null||C.scrollIntoView({behavior:"smooth",block:"center"}),U.push(e.jsx(G,{title:"Error",type:"danger",children:"Appraisers 's Comments is reuired"}),{placement:"top-center"});return}try{const P=N.date instanceof Date?N.date.toISOString().split("T")[0]:null,V={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),evidence_ids:o,comment:p,date:P,signature:N.signature,declaration:N.declaration,flag:N.flag,staff_id:s};(await mr(V)).status===200?U.push(e.jsx(G,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):U.push(e.jsx(G,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(P){console.error("Error submitting data:",P),U.push(e.jsx(G,{title:"Error",type:"danger",children:"Failed to submit data. Please check your connection and try again."}),{placement:"top-center"})}},F=()=>{t(-1)},f=()=>{t("/dashboard")};return a?e.jsx("div",{children:"Loading..."}):l?e.jsx("div",{className:"text-red-500",children:l}):e.jsxs("div",{className:"mt-4  mx-auto w-full ",children:[e.jsx(ar,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(xr,{submittedEvidence:((x=(_=r==null?void 0:r.comments)==null?void 0:_.staff)==null?void 0:x.evidence)||[]})}),e.jsx("div",{className:"mt-4",children:e.jsx(tr,{evidenceList:(r==null?void 0:r.evidence_list)||[],onChange:m})}),e.jsx("div",{className:"mt-4",children:e.jsx(lr,{commentInputRef:E,comments:{staff:((h=r==null?void 0:r.comments)==null?void 0:h.staff)||{comment:""},supervisor:((M=r==null?void 0:r.comments)==null?void 0:M.supervisor)||{comment:""},officer:(($=r==null?void 0:r.comments)==null?void 0:$.officer)||{comment:""}},showValidationError:w,onAppraisersCommentChange:b})}),e.jsx("div",{className:"mt-4",children:e.jsx(nr,{Staff:(W=r==null?void 0:r.comments)==null?void 0:W.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(cr,{Supervisor:(ee=r==null?void 0:r.comments)==null?void 0:ee.supervisor,onChange:C=>{T(C)},officerDeclaration:(se=(re=r==null?void 0:r.comments)==null?void 0:re.officer)==null?void 0:se.declaration})}),e.jsx("div",{className:"mt-4",children:e.jsx(dr,{officer:(ae=r==null?void 0:r.comments)==null?void 0:ae.officer})})]}),e.jsx(be,{back:"Back",handleBack:F,save:"Save",handleSave:j,next:"Continue to Dashboard",handleNext:f})]})},Cr=()=>{const{id:s}=ge(),t=pe(f=>f.quaterTab.selectedQuarter),[r,c]=i.useState(null),[a,n]=i.useState(!0),[l,d]=i.useState(null),o=async()=>{try{const f=localStorage.getItem("selectedDepartmentID")||"",_=localStorage.getItem("selectedTeamID"),x=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),h=await ir(f,_?Number(_):null,x,String(s),t);if(h&&h.data)c(h.data);else throw new Error("Invalid response data")}catch(f){console.error("Error fetching data:",f),d("Failed to load data. Please try again.")}finally{n(!1)}};if(i.useEffect(()=>{o()},[]),a)return e.jsx("div",{children:"Loading..."});if(l)return e.jsx("div",{className:"text-red-500",children:l});if(!r)return e.jsx("div",{children:"No data found."});const{department:m,team:p,supervisor:b,officer:w,staff:S,progress:I,employee_task:N,competencies:T,operation_and_process:E,others:j,overall_assesment:F}=r;return e.jsxs("div",{children:[e.jsx(je,{department:m,team:p,progress:I,title:"Employee Annual Appraisal Document",downloadButton:!0,staffID:s}),S&&b&&w&&e.jsx(Ne,{staff:S,supervisor:b,officer:w}),e.jsx(Re,{}),e.jsx(He,{employee_task:N||[]}),e.jsx(ze,{}),e.jsx(Ye,{competencies:T||{}}),e.jsx(Ve,{}),e.jsx(Je,{operation_and_process:E||{}}),F?e.jsx(rr,{overall_assesment:F}):e.jsx("div",{className:"text-center text-gray-500 mt-4",children:"No overall assessment data available."}),j&&e.jsx(sr,{assesment:Array.isArray(j.strengths)?j.strengths.join(", "):String(j.strengths||""),improvement:Array.isArray(j.improvement)?j.improvement.join(", "):String(j.improvement||"")}),e.jsx(gr,{})]})};export{Cr as default};
